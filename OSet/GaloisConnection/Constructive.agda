module OSet.GaloisConnection.Constructive where

open import Prelude
open import OSet.OSet
open import OSet.Fun
open import OSet.Power
open import OSet.Product
open import OSet.ProofMode
open import OSet.Lib

open import OSet.GaloisConnection.Classical
open import OSet.GaloisConnection.Kleisli

infixr 4 _Î·â‡„Î³_
record _Î·â‡„Î³_ {ğ“} (A B : POSet ğ“) : Set (sucË¡ ğ“) where
  field
    Î·[_] : âŸª A â‡’ B âŸ«
    Î³â¸¢Î·â¸£[_] : âŸª B â‡’ ğ’« A âŸ«
    expansiveâ¸¢Î·â¸£[_] : return âŠ‘ Î³â¸¢Î·â¸£[_] âŸ pure â‹… Î·[_]
    contractiveâ¸¢Î·â¸£[_] : pure â‹… Î·[_] âŸ Î³â¸¢Î·â¸£[_] âŠ‘ return
open _Î·â‡„Î³_ public

expansiveâ†”â¸¢pureâ¸£ : âˆ€ {ğ“} {A B : POSet ğ“} {Î· : âŸª A â‡’ B âŸ«} {Î³ : âŸª B â‡’ ğ’« A âŸ«} â†’ return âŠ‘ Î³ âŸ pure â‹… Î· â†” return âŠ‘ Î³ âŠ™ Î·
expansiveâ†”â¸¢pureâ¸£ {A = A} {B} {Î·} {Î³} = LHS , RHS
  where
    LHS : return âŠ‘ Î³ âŸ pure â‹… Î· â†’ return âŠ‘ Î³ âŠ™ Î·
    LHS returnâŠ‘Î³âŸÎ· = xRx[] right-unit[âŸ]â¸¢pureâ¸£ âŒ¾ returnâŠ‘Î³âŸÎ·
    RHS : return âŠ‘ Î³ âŠ™ Î· â†’ return âŠ‘ Î³ âŸ pure â‹… Î·
    RHS returnâŠ‘Î³âŠ™Î· = xRx[] (â—‡ right-unit[âŸ]â¸¢pureâ¸£) âŒ¾ returnâŠ‘Î³âŠ™Î·

expansiveâ†”soundâ¸¢Î·â¸£ : âˆ€ {ğ“} {A B : POSet ğ“} {Î· : âŸª A â‡’ B âŸ«} {Î³ : âŸª B â‡’ ğ’« A âŸ«} â†’ return âŠ‘ Î³ âŸ pure â‹… Î· â†” (âˆ€ {x} â†’ x â‹¿ Î³ â‹… (Î· â‹… x))
expansiveâ†”soundâ¸¢Î·â¸£ {A = A} {B} {Î·} {Î³} = LHS , RHS
  where
    LHS : return âŠ‘ Î³ âŸ pure â‹… Î· â†’ âˆ€ {x} â†’ x â‹¿ Î³ â‹… (Î· â‹… x)
    LHS expansive = Ï€â‚ returnâ†”â‹¿ $ res-f[Î»]â¸¢âŠ‘â¸£ $ Ï€â‚ expansiveâ†”â¸¢pureâ¸£ expansive
    RHS : (âˆ€ {x} â†’ x â‹¿ Î³ â‹… (Î· â‹… x)) â†’ return âŠ‘ Î³ âŸ pure â‹… Î·
    RHS sound = Ï€â‚‚ expansiveâ†”â¸¢pureâ¸£ $ ext[Î»]â¸¢âŠ‘â¸£ $ Ï€â‚‚ returnâ†”â‹¿ sound

contractiveâ†”completeâ¸¢Î·â¸£ : âˆ€ {ğ“} {A B : POSet ğ“} {Î· : âŸª A â‡’ B âŸ«} {Î³ : âŸª B â‡’ ğ’« A âŸ«} â†’ pure â‹… Î· âŸ Î³ âŠ‘ return â†” (âˆ€ {x^ x} â†’ x â‹¿ Î³ â‹… x^ â†’ Î· â‹… x âŠ‘ x^)
contractiveâ†”completeâ¸¢Î·â¸£ {A = A} {B} {Î·} {Î³} = LHS , RHS
  where
    LHS : pure â‹… Î· âŸ Î³ âŠ‘ return â†’ âˆ€ {x^ x} â†’ x â‹¿ Î³ â‹… x^ â†’ Î· â‹… x âŠ‘ x^
    LHS contractive {x^} {x} xâˆˆÎ³[x^] = Ï€â‚ returnâ†”â‹¿ $ res-f[Î»]â¸¢âŠ‘â¸£ contractive âŒ¾ [âŠ‘-proof-mode]
      do [âŠ‘][[ (pure â‹… Î·) â‹… x ]]
      âŠ‘â€£ [âŠ‘-â‰ˆ] (pure â‹… Î·) * â‹… (return â‹… x) âŸ… â—‡ right-unit[*] âŸ†
      âŠ‘â€£ [âŠ‘-focus-right [â‹…] ğ‘œğ‘“ (pure â‹… Î·) * ] [âŠ‘] Î³ â‹… x^ âŸ… Ï€â‚‚ returnâ†”â‹¿ xâˆˆÎ³[x^] âŸ†
      âŠ‘â€£ [âŠ‘][[ (pure â‹… Î·) * â‹… (Î³ â‹… x^) ]]
      â¬œ
    RHS : (âˆ€ {x^ x} â†’ x â‹¿ Î³ â‹… x^ â†’ Î· â‹… x âŠ‘ x^) â†’ pure â‹… Î· âŸ Î³ âŠ‘ return
    RHS complete = ext[Î»]â¸¢âŠ‘â¸£ $ ext[Ï‰]â¸¢âŠ‘â¸£ H
      where
        H : âˆ€ {x^ y^} â†’ y^ â‹¿ (pure â‹… Î·) * â‹… (Î³ â‹… x^) â†’ y^ âŠ‘ x^
        H (âˆƒğ’« x ,, xâˆˆÎ³[x^] ,, y^âŠ‘Î·[x]) = complete xâˆˆÎ³[x^] âŒ¾ y^âŠ‘Î·[x]

soundâ¸¢Î·â¸£[_] : âˆ€ {ğ“} {A B : POSet ğ“} (Aâ‡„B : A Î·â‡„Î³ B) â†’ âˆ€ {x} â†’ x â‹¿ Î³â¸¢Î·â¸£[ Aâ‡„B ] â‹… (Î·[ Aâ‡„B ] â‹… x)
soundâ¸¢Î·â¸£[ Aâ‡„B ] = Ï€â‚ expansiveâ†”soundâ¸¢Î·â¸£ expansiveâ¸¢Î·â¸£[ Aâ‡„B ]

completeâ¸¢Î·â¸£[_] : âˆ€ {ğ“} {A B : POSet ğ“} (Aâ‡„B : A Î·â‡„Î³ B) â†’ âˆ€ {x^ x} â†’ x â‹¿ Î³â¸¢Î·â¸£[ Aâ‡„B ] â‹… x^ â†’ Î·[ Aâ‡„B ] â‹… x âŠ‘ x^
completeâ¸¢Î·â¸£[ Aâ‡„B ] = Ï€â‚ contractiveâ†”completeâ¸¢Î·â¸£ contractiveâ¸¢Î·â¸£[ Aâ‡„B ]

â—‡left-unit[âŸ]â¸¢expansiveâ¸¢Î·â¸£â¸£[_] : âˆ€ {ğ“} {A Bâ‚ Bâ‚‚ : POSet ğ“} (â‡„Aâ‡„ : Bâ‚ Î·â‡„Î³ Bâ‚‚) {f : âŸª A â‡’ ğ’« Bâ‚ âŸ«} â†’ f âŠ‘ Î³â¸¢Î·â¸£[ â‡„Aâ‡„ ] âŸ pure â‹… Î·[ â‡„Aâ‡„ ] âŸ f
â—‡left-unit[âŸ]â¸¢expansiveâ¸¢Î·â¸£â¸£[ â‡„Aâ‡„ ] {f} = [âŠ‘-proof-mode]
  do [âŠ‘][[ f ]]
  âŠ‘â€£ [âŠ‘-â‰ˆ] return âŸ f âŸ… â—‡ left-unit[âŸ] âŸ†
  âŠ‘â€£ [âŠ‘-focus-left [âŸ] ğ‘œğ‘“ f ] [âŠ‘] Î³â¸¢Î·â¸£[ â‡„Aâ‡„ ] âŸ pure â‹… Î·[ â‡„Aâ‡„ ] âŸ… expansiveâ¸¢Î·â¸£[ â‡„Aâ‡„ ] âŸ†
  âŠ‘â€£ [âŠ‘][[ (Î³â¸¢Î·â¸£[ â‡„Aâ‡„ ] âŸ pure â‹… Î·[ â‡„Aâ‡„ ]) âŸ f ]]
  âŠ‘â€£ [âŠ‘-â‰ˆ] Î³â¸¢Î·â¸£[ â‡„Aâ‡„ ] âŸ pure â‹… Î·[ â‡„Aâ‡„ ] âŸ f âŸ… associative[âŸ] âŸ†
  â¬œ

â—‡right-unit[âŸ]â¸¢expansiveâ¸¢Î·â¸£â¸£[_] : âˆ€ {ğ“} {Aâ‚ Aâ‚‚ B : POSet ğ“} (â‡„Aâ‡„ : Aâ‚ Î·â‡„Î³ Aâ‚‚) {f : âŸª Aâ‚ â‡’ ğ’« B âŸ«} â†’ f âŠ‘ f âŸ Î³â¸¢Î·â¸£[ â‡„Aâ‡„ ] âŸ pure â‹… Î·[ â‡„Aâ‡„ ]
â—‡right-unit[âŸ]â¸¢expansiveâ¸¢Î·â¸£â¸£[ â‡„Aâ‡„ ] {f} = [âŠ‘-proof-mode]
  do [âŠ‘][[ f ]]
  âŠ‘â€£ [âŠ‘-â‰ˆ] f âŸ return âŸ… â—‡ right-unit[âŸ] âŸ†
  âŠ‘â€£ [âŠ‘-focus-right [âŸ] ğ‘œğ‘“ f ] [âŠ‘] Î³â¸¢Î·â¸£[ â‡„Aâ‡„ ] âŸ pure â‹… Î·[ â‡„Aâ‡„ ] âŸ… expansiveâ¸¢Î·â¸£[ â‡„Aâ‡„ ] âŸ†
  âŠ‘â€£ [âŠ‘][[ f âŸ Î³â¸¢Î·â¸£[ â‡„Aâ‡„ ] âŸ pure â‹… Î·[ â‡„Aâ‡„ ] ]]
  â¬œ

left-unit[âŸ]â¸¢contractiveâ¸¢Î·â¸£â¸£[_] : âˆ€ {ğ“} {A Bâ‚ Bâ‚‚ : POSet ğ“} (â‡„Aâ‡„ : Bâ‚ Î·â‡„Î³ Bâ‚‚) {f : âŸª A â‡’ ğ’« Bâ‚‚ âŸ«} â†’ pure â‹… Î·[ â‡„Aâ‡„ ] âŸ Î³â¸¢Î·â¸£[ â‡„Aâ‡„ ] âŸ f âŠ‘ f
left-unit[âŸ]â¸¢contractiveâ¸¢Î·â¸£â¸£[ â‡„Aâ‡„ ] {f} = [âŠ‘-proof-mode]
  do [âŠ‘][[ pure â‹… Î·[ â‡„Aâ‡„ ] âŸ Î³â¸¢Î·â¸£[ â‡„Aâ‡„ ] âŸ f ]]
  âŠ‘â€£ [âŠ‘-â‰ˆ] (pure â‹… Î·[ â‡„Aâ‡„ ] âŸ Î³â¸¢Î·â¸£[ â‡„Aâ‡„ ]) âŸ f âŸ… â—‡ associative[âŸ] âŸ†
  âŠ‘â€£ [âŠ‘-focus-left [âŸ] ğ‘œğ‘“ f ] [âŠ‘] return âŸ… contractiveâ¸¢Î·â¸£[ â‡„Aâ‡„ ] âŸ†
  âŠ‘â€£ [âŠ‘][[ return âŸ f ]]
  âŠ‘â€£ [âŠ‘-â‰ˆ] f âŸ… left-unit[âŸ] âŸ†
  â¬œ

left-unit[*]â¸¢contractiveâ¸¢Î·â¸£â¸£[_] : âˆ€ {ğ“} {Bâ‚ Bâ‚‚ : POSet ğ“} (â‡„Aâ‡„ : Bâ‚ Î·â‡„Î³ Bâ‚‚) {X : âŸª ğ’« Bâ‚‚ âŸ«} â†’ (pure â‹… Î·[ â‡„Aâ‡„ ]) * â‹… (Î³â¸¢Î·â¸£[ â‡„Aâ‡„ ] * â‹… X) âŠ‘ X
left-unit[*]â¸¢contractiveâ¸¢Î·â¸£â¸£[ â‡„Aâ‡„ ] {X = X} = [âŠ‘-proof-mode]
  do [âŠ‘][[ (pure â‹… Î·[ â‡„Aâ‡„ ]) * â‹… (Î³â¸¢Î·â¸£[ â‡„Aâ‡„ ] * â‹… X) ]]
  âŠ‘â€£ [âŠ‘-â‰ˆ] (pure â‹… Î·[ â‡„Aâ‡„ ] âŸ Î³â¸¢Î·â¸£[ â‡„Aâ‡„ ]) * â‹… X âŸ… â—‡ associative[âŸ]â¸¢*â¸£ âŸ†
  âŠ‘â€£ [âŠ‘-focus-left [â‹…] ğ‘œğ‘“ X ] $
     [âŠ‘-focus-in [*] ] [âŠ‘] return âŸ… contractiveâ¸¢Î·â¸£[ â‡„Aâ‡„ ] âŸ†
  âŠ‘â€£ [âŠ‘][[ return * â‹… X ]]
  âŠ‘â€£ [âŠ‘-â‰ˆ] X âŸ… left-unit[*] âŸ†
  â¬œ

right-unit[âŸ]â¸¢contractiveâ¸¢Î·â¸£â¸£[_] : âˆ€ {ğ“} {Aâ‚ Aâ‚‚ B : POSet ğ“} (â‡„Aâ‡„ : Aâ‚ Î·â‡„Î³ Aâ‚‚) {f : âŸª Aâ‚‚ â‡’ ğ’« B âŸ«} â†’ f âŸ pure â‹… Î·[ â‡„Aâ‡„ ] âŸ Î³â¸¢Î·â¸£[ â‡„Aâ‡„ ] âŠ‘ f
right-unit[âŸ]â¸¢contractiveâ¸¢Î·â¸£â¸£[ â‡„Aâ‡„ ] {f} = [âŠ‘-proof-mode]
  do [âŠ‘][[ f âŸ pure â‹… Î·[ â‡„Aâ‡„ ] âŸ Î³â¸¢Î·â¸£[ â‡„Aâ‡„ ] ]]
  âŠ‘â€£ [âŠ‘-focus-right [âŸ] ğ‘œğ‘“ f ] [âŠ‘] return âŸ… contractiveâ¸¢Î·â¸£[ â‡„Aâ‡„ ] âŸ†
  âŠ‘â€£ [âŠ‘][[ f âŸ return ]]
  âŠ‘â€£ [âŠ‘-â‰ˆ] f âŸ… right-unit[âŸ] âŸ†
  â¬œ

infixr 4 _Î·â‡„Î³â¸¢â†‘â¸£_
record _Î·â‡„Î³â¸¢â†‘â¸£_ {ğ“} (A B : Set ğ“) {{A-PO : PreOrder ğ“ A}} {{B-PO : PreOrder ğ“ B}} : Set (sucË¡ ğ“) where
  field
    Î·â¸¢â†‘â¸£ : A â†’ B
    monotonic[Î·â¸¢â†‘â¸£] : proper (_âŠ´_ â‡‰ _âŠ´_) Î·â¸¢â†‘â¸£
    Î³â¸¢â†‘â¸£ : B â†’ A â†’ Set ğ“
    monotonic[Î³â¸¢â†‘â¸£] : proper (_âŠ´_ â‡‰ _âŠµ_ â‡‰ [â†’]) Î³â¸¢â†‘â¸£
    sound[Î·Î³]â¸¢â†‘â¸£ : âˆ€ {x : A} â†’ Î³â¸¢â†‘â¸£ (Î·â¸¢â†‘â¸£ x) x
    complete[Î·Î³]â¸¢â†‘â¸£ : âˆ€ {x x^} â†’ Î³â¸¢â†‘â¸£ x^ x â†’ Î·â¸¢â†‘â¸£ x âŠ´ x^
    
mk[Î·â‡„Î³]â¸¢â†‘â¸£ :
  âˆ€ {ğ“} {A B : Set ğ“}
    {{A-PO : PreOrder ğ“ A}} {{A-REX : Reflexive (_âŠ´_ {A = A})}}
    {{B-PO : PreOrder ğ“ B}} {{B-REX : Reflexive (_âŠ´_ {A = B})}}
  â†’ A Î·â‡„Î³â¸¢â†‘â¸£ B â†’ â‡§ A Î·â‡„Î³ â‡§ B
mk[Î·â‡„Î³]â¸¢â†‘â¸£ {A = A} {B} Aâ‡„B = record
  { Î·[_] = witness-x (curryâ¸¢Î»â†‘â¸£ idâ¸¢Î»â†‘â¸£) $ mk[witness] Î·â¸¢â†‘â¸£ monotonic[Î·â¸¢â†‘â¸£]
  ; Î³â¸¢Î·â¸£[_] = witness-x (curryâ¸¢Î»â†‘â¸£ idâ¸¢Ï‰â†‘â¸£) $ mk[witness] Î³â¸¢â†‘â¸£ monotonic[Î³â¸¢â†‘â¸£]
  ; expansiveâ¸¢Î·â¸£[_] = Ï€â‚‚ expansiveâ†”soundâ¸¢Î·â¸£ sound[Î·Î³]â¸¢â†‘â¸£
  ; contractiveâ¸¢Î·â¸£[_] = Ï€â‚‚ contractiveâ†”completeâ¸¢Î·â¸£ (intro[âŠ‘]â¸¢â†“â¸£ âˆ˜ complete[Î·Î³]â¸¢â†‘â¸£)
  }
  where open _Î·â‡„Î³â¸¢â†‘â¸£_ Aâ‡„B

Î·â‡„Î³â†”Î±â‡„Î³áµ : âˆ€ {ğ“} {A B : POSet ğ“} â†’ (A Î·â‡„Î³ B) â†” (A Î±â‡„Î³áµ B)
Î·â‡„Î³â†”Î±â‡„Î³áµ = LHS , RHS
  where
    LHS : âˆ€ {ğ“} {A B : POSet ğ“} â†’ A Î·â‡„Î³ B â†’ A Î±â‡„Î³áµ B
    LHS Aâ‡„B = record
      { Î±áµ[_] = pure â‹… Î·[ Aâ‡„B ]
      ; Î³áµ[_] = Î³â¸¢Î·â¸£[ Aâ‡„B ]
      ; expansiveáµ[_] = expansiveâ¸¢Î·â¸£[ Aâ‡„B ]
      ; contractiveáµ[_] = contractiveâ¸¢Î·â¸£[ Aâ‡„B ]
      }
    RHS : âˆ€ {ğ“} {A B : POSet ğ“} â†’ A Î±â‡„Î³áµ B â†’ A Î·â‡„Î³ B
    RHS {A = A} {B} Aâ‡„B = record
      { Î·[_] = Î·
      ; Î³â¸¢Î·â¸£[_] = Î³áµ[ Aâ‡„B ]
      ; expansiveâ¸¢Î·â¸£[_] = Ï€â‚‚ expansiveâ†”soundâ¸¢Î·â¸£ sound
      ; contractiveâ¸¢Î·â¸£[_] = Ï€â‚‚ contractiveâ†”completeâ¸¢Î·â¸£ complete
      }
      where
        fun : âŸª A âŸ« â†’ âŸª B âŸ«
        fun x with soundáµ[ Aâ‡„B ] {x}
        ... | âˆƒğ’« y ,, yâˆˆÎ±[x] ,, xâˆˆÎ³[y] = y
        abstract
          ppr : proper (_âŠ‘_ â‡‰ _âŠ‘_) fun
          ppr {x} {y} xâŠ‘y with soundáµ[ Aâ‡„B ] {x} | soundáµ[ Aâ‡„B ] {y}
          ... | âˆƒğ’« x^ ,, x^âˆˆÎ±[x] ,, xâˆˆÎ³[x^] | âˆƒğ’« y^ ,, y^âˆˆÎ±[y] ,, yâˆˆÎ³[y^] =
            res-X[Ï‰]â¸¢âŠ‘â¸£ (res-f[Î»]â¸¢âŠ‘â¸£ $ contractiveáµ[ Aâ‡„B ]) $
            âˆƒğ’« x ,, res-x[Ï‰]â¸¢âŠ‘â¸£ {X = Î³áµ[ Aâ‡„B ] â‹… y^} xâŠ‘y yâˆˆÎ³[y^] ,, x^âˆˆÎ±[x]
        Î· : âŸª A â‡’ B âŸ«
        Î· = witness-x (curryâ¸¢Î»â¸£ $ idâ¸¢Î»â¸£) $ mk[witness] fun ppr
        sound : âˆ€ {x} â†’ x â‹¿ Î³áµ[ Aâ‡„B ] â‹… (Î· â‹… x)
        sound {x} with soundáµ[ Aâ‡„B ] {x}
        ... | âˆƒğ’« x^ ,, x^âˆˆÎ±[x] ,, xâˆˆÎ³[x^] = xâˆˆÎ³[x^]
        complete : âˆ€ {x x^} â†’ x â‹¿ Î³áµ[ Aâ‡„B ] â‹… x^ â†’ Î· â‹… x âŠ‘ x^
        complete {x} {x^} xâˆˆÎ³[x^] with soundáµ[ Aâ‡„B ] {x}
        ... | âˆƒğ’« y^ ,, y^âˆˆÎ±[x] ,, xâˆˆÎ³[y^] = completeáµ[ Aâ‡„B ] $ âˆƒğ’« x ,, xâˆˆÎ³[x^] ,, y^âˆˆÎ±[x]

Î±áµâ†’Î·[_] : âˆ€ {ğ“} {A B : POSet ğ“} â†’ A Î±â‡„Î³áµ B â†’ A Î·â‡„Î³ B
Î±áµâ†’Î·[_] = Ï€â‚‚ Î·â‡„Î³â†”Î±â‡„Î³áµ

Î·â†’Î±áµ[_] : âˆ€ {ğ“} {A B : POSet ğ“} â†’ A Î·â‡„Î³ B â†’ A Î±â‡„Î³áµ B
Î·â†’Î±áµ[_] = Ï€â‚ Î·â‡„Î³â†”Î±â‡„Î³áµ

Î±â‰ˆpure[Î·] : âˆ€ {ğ“} {A B : POSet ğ“} (Aâ‡„B : A Î±â‡„Î³áµ B) â†’ Î±áµ[ Aâ‡„B ] â‰ˆ pure â‹… Î·[ Î±áµâ†’Î·[ Aâ‡„B ] ]
Î±â‰ˆpure[Î·] Aâ‡„B = unique[Î±]áµ Aâ‡„B Î·â†’Î±áµ[ Î±áµâ†’Î·[ Aâ‡„B ] ] xRxâ¸¢â‰ˆâ¸£

pure[Î·]â‰ˆÎ± : âˆ€ {ğ“} {A B : POSet ğ“} (Aâ‡„B : A Î·â‡„Î³ B) â†’ pure â‹… Î·[ Aâ‡„B ] â‰ˆ Î±áµ[ Î·â†’Î±áµ[ Aâ‡„B ] ]
pure[Î·]â‰ˆÎ± Aâ‡„B = unique[Î±]áµ Î·â†’Î±áµ[ Aâ‡„B ] Î·â†’Î±áµ[ Aâ‡„B ] xRxâ¸¢â‰ˆâ¸£

_âŒ¾â¸¢Î·â‡„Î³â¸£_ : âˆ€ {ğ“} {Aâ‚ Aâ‚‚ Aâ‚ƒ : POSet ğ“} â†’ Aâ‚‚ Î·â‡„Î³ Aâ‚ƒ â†’ Aâ‚ Î·â‡„Î³ Aâ‚‚ â†’ Aâ‚ Î·â‡„Î³ Aâ‚ƒ
_âŒ¾â¸¢Î·â‡„Î³â¸£_ {ğ“} {Aâ‚} {Aâ‚‚} {Aâ‚ƒ} â‡„Aâ‡„â‚‚ â‡„Aâ‡„â‚ = record
  { Î·[_] = Î·[ â‡„Aâ‡„â‚‚ ] âŠ™ Î·[ â‡„Aâ‡„â‚ ]
  ; Î³â¸¢Î·â¸£[_] = Î³â¸¢Î·â¸£[ â‡„Aâ‡„â‚ ] âŸ Î³â¸¢Î·â¸£[ â‡„Aâ‡„â‚‚ ]
  ; expansiveâ¸¢Î·â¸£[_] = [âŠ‘-proof-mode]
      do [âŠ‘][[ return ]]
      âŠ‘â€£ [âŠ‘] Î³áµ[ Î·â†’Î±áµ[ â‡„Aâ‡„â‚‚ ] âŒ¾â¸¢Î±â‡„Î³áµâ¸£ Î·â†’Î±áµ[ â‡„Aâ‡„â‚ ] ] âŸ Î±áµ[ Î·â†’Î±áµ[ â‡„Aâ‡„â‚‚ ] âŒ¾â¸¢Î±â‡„Î³áµâ¸£ Î·â†’Î±áµ[ â‡„Aâ‡„â‚ ] ] âŸ… expansiveáµ[ Î·â†’Î±áµ[ â‡„Aâ‡„â‚‚ ] âŒ¾â¸¢Î±â‡„Î³áµâ¸£ Î·â†’Î±áµ[ â‡„Aâ‡„â‚ ] ] âŸ†
      âŠ‘â€£ [âŠ‘-â‰¡] (Î³â¸¢Î·â¸£[ â‡„Aâ‡„â‚ ] âŸ Î³â¸¢Î·â¸£[ â‡„Aâ‡„â‚‚ ]) âŸ (pure â‹… Î·[ â‡„Aâ‡„â‚‚ ] âŸ pure â‹… Î·[ â‡„Aâ‡„â‚ ]) âŸ… â†¯ âŸ†
      âŠ‘â€£ [âŠ‘-focus-right [âŸ] ğ‘œğ‘“ (Î³â¸¢Î·â¸£[ â‡„Aâ‡„â‚ ] âŸ Î³â¸¢Î·â¸£[ â‡„Aâ‡„â‚‚ ]) ] [âŠ‘-â‰ˆ] pure â‹… (Î·[ â‡„Aâ‡„â‚‚ ] âŠ™ Î·[ â‡„Aâ‡„â‚ ]) âŸ… homomorphic[âŸ]â¸¢pureâ¸£ âŸ†
      âŠ‘â€£ [âŠ‘][[ (Î³â¸¢Î·â¸£[ â‡„Aâ‡„â‚ ] âŸ Î³â¸¢Î·â¸£[ â‡„Aâ‡„â‚‚ ]) âŸ pure â‹… (Î·[ â‡„Aâ‡„â‚‚ ] âŠ™ Î·[ â‡„Aâ‡„â‚ ]) ]]
      â¬œ
  ; contractiveâ¸¢Î·â¸£[_] = [âŠ‘-proof-mode]
      do [âŠ‘][[ pure â‹… (Î·[ â‡„Aâ‡„â‚‚ ] âŠ™ Î·[ â‡„Aâ‡„â‚ ]) âŸ (Î³â¸¢Î·â¸£[ â‡„Aâ‡„â‚ ] âŸ Î³â¸¢Î·â¸£[ â‡„Aâ‡„â‚‚ ]) ]]
      âŠ‘â€£ [âŠ‘-focus-left [âŸ] ğ‘œğ‘“ (Î³â¸¢Î·â¸£[ â‡„Aâ‡„â‚ ] âŸ Î³â¸¢Î·â¸£[ â‡„Aâ‡„â‚‚ ]) ] [âŠ‘-â‰ˆ] pure â‹… Î·[ â‡„Aâ‡„â‚‚ ] âŸ pure â‹… Î·[ â‡„Aâ‡„â‚ ] âŸ… â—‡ homomorphic[âŸ]â¸¢pureâ¸£ âŸ†
      âŠ‘â€£ [âŠ‘][[ (pure â‹… Î·[ â‡„Aâ‡„â‚‚ ] âŸ pure â‹… Î·[ â‡„Aâ‡„â‚ ]) âŸ (Î³â¸¢Î·â¸£[ â‡„Aâ‡„â‚ ] âŸ Î³â¸¢Î·â¸£[ â‡„Aâ‡„â‚‚ ]) ]]
      âŠ‘â€£ [âŠ‘-â‰¡] Î±áµ[ Î·â†’Î±áµ[ â‡„Aâ‡„â‚‚ ] âŒ¾â¸¢Î±â‡„Î³áµâ¸£ Î·â†’Î±áµ[ â‡„Aâ‡„â‚ ] ] âŸ Î³áµ[ Î·â†’Î±áµ[ â‡„Aâ‡„â‚‚ ] âŒ¾â¸¢Î±â‡„Î³áµâ¸£ Î·â†’Î±áµ[ â‡„Aâ‡„â‚ ] ] âŸ… â†¯ âŸ†
      âŠ‘â€£ [âŠ‘] return âŸ… contractiveáµ[ Î·â†’Î±áµ[ â‡„Aâ‡„â‚‚ ] âŒ¾â¸¢Î±â‡„Î³áµâ¸£ Î·â†’Î±áµ[ â‡„Aâ‡„â‚ ] ] âŸ†
      â¬œ
  }

_Ã—â¸¢Î·â‡„Î³â¸£_ : âˆ€ {ğ“} {Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚ : POSet ğ“} â†’ Aâ‚ Î·â‡„Î³ Bâ‚ â†’ Aâ‚‚ Î·â‡„Î³ Bâ‚‚ â†’ (Aâ‚ âŸ¨Ã—âŸ© Aâ‚‚) Î·â‡„Î³ (Bâ‚ âŸ¨Ã—âŸ© Bâ‚‚)
_Ã—â¸¢Î·â‡„Î³â¸£_ {ğ“} {Aâ‚} {Aâ‚‚} {Bâ‚} {Bâ‚‚} Aâ‚â‡„Bâ‚ Aâ‚‚â‡„Bâ‚‚ = mk[Î·â‡„Î³]â¸¢â†‘â¸£ record
  { Î·â¸¢â†‘â¸£ = Î·
  ; monotonic[Î·â¸¢â†‘â¸£] = monotonic[Î·]
  ; Î³â¸¢â†‘â¸£ = Î³
  ; monotonic[Î³â¸¢â†‘â¸£] = monotonic[Î³]
  ; sound[Î·Î³]â¸¢â†‘â¸£ = Î» {x} â†’ sound {x}
  ; complete[Î·Î³]â¸¢â†‘â¸£ = complete
  }
  where
    Î· : prod Aâ‚ Aâ‚‚ â†’ prod Bâ‚ Bâ‚‚
    Î· (x , y) = Î·[ Aâ‚â‡„Bâ‚ ] â‹… x , Î·[ Aâ‚‚â‡„Bâ‚‚ ] â‹… y
    monotonic[Î·] : proper (_âŠ´_ â‡‰ _âŠ´_) Î·
    monotonic[Î·] (xâ‚âŠ‘xâ‚‚ , yâ‚âŠ‘yâ‚‚) = res-x[Î»]â¸¢âŠ‘â¸£ {f = Î·[ Aâ‚â‡„Bâ‚ ]} xâ‚âŠ‘xâ‚‚ , res-x[Î»]â¸¢âŠ‘â¸£ {f = Î·[ Aâ‚‚â‡„Bâ‚‚ ]} yâ‚âŠ‘yâ‚‚
    Î³ : prod Bâ‚ Bâ‚‚ â†’ prod Aâ‚ Aâ‚‚ â†’ Set ğ“
    Î³ (x^ , y^) (x , y) = (x â‹¿ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] â‹… x^) Ã— (y â‹¿ Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] â‹… y^)
    monotonic[Î³] : proper (_âŠ´_ â‡‰ _âŠµ_ â‡‰ [â†’]) Î³
    monotonic[Î³] (xâ‚^âŠ‘xâ‚‚^ , yâ‚^âŠ‘yâ‚‚^) (xâ‚âŠµxâ‚‚ , yâ‚âŠµyâ‚‚) (xâ‚âˆˆÎ³[xâ‚^] , yâ‚âˆˆÎ³[yâ‚^]) =
        res-X-x[Ï‰]â¸¢âŠ‘â¸£ (res-x[Î»]â¸¢âŠ‘â¸£ {f = Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ]} xâ‚^âŠ‘xâ‚‚^) xâ‚âŠµxâ‚‚ xâ‚âˆˆÎ³[xâ‚^]
      , res-X-x[Ï‰]â¸¢âŠ‘â¸£ (res-x[Î»]â¸¢âŠ‘â¸£ {f = Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ]} yâ‚^âŠ‘yâ‚‚^) yâ‚âŠµyâ‚‚ yâ‚âˆˆÎ³[yâ‚^]
    sound : âˆ€ {xy} â†’ Î³ (Î· xy) xy
    sound {x , y} = soundâ¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] {x} , soundâ¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] {y}
    complete : âˆ€ {xy^ xy} â†’ Î³ xy^ xy â†’ Î· xy âŠ´ xy^
    complete {x^ , y^} {x , y} (xâ‚âˆˆÎ³[xâ‚^] , yâ‚âˆˆÎ³[yâ‚^]) = completeâ¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] xâ‚âˆˆÎ³[xâ‚^] , completeâ¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] yâ‚âˆˆÎ³[yâ‚^]

_â‡’â¸¢Î·â‡„Î³â¸£_ : âˆ€ {ğ“} {Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚ : POSet ğ“} â†’ Aâ‚ Î·â‡„Î³ Bâ‚ â†’ Aâ‚‚ Î·â‡„Î³ Bâ‚‚ â†’ (Aâ‚ â‡’ ğ’« Aâ‚‚) Î±â‡„Î³ (Bâ‚ â‡’ ğ’« Bâ‚‚)
_â‡’â¸¢Î·â‡„Î³â¸£_ {Aâ‚ = Aâ‚} {Aâ‚‚} {Bâ‚} {Bâ‚‚} Aâ‚â‡„Bâ‚ Aâ‚‚â‡„Bâ‚‚ = Î·â†’Î±áµ[ Aâ‚â‡„Bâ‚ ] â‡’â¸¢Î±â‡„Î³áµâ¸£ Î·â†’Î±áµ[ Aâ‚‚â‡„Bâ‚‚ ]

Î±[f]âŠ‘f^[_,_]â¸¢Î·â¸£ :
  âˆ€ {ğ“} {Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚ : POSet ğ“} (Aâ‚â‡„Bâ‚ : Aâ‚ Î·â‡„Î³ Bâ‚) (Aâ‚‚â‡„Bâ‚‚ : Aâ‚‚ Î·â‡„Î³ Bâ‚‚) {f : âŸª Aâ‚ â‡’ ğ’« Aâ‚‚ âŸ«} {f^ : âŸª Bâ‚ â‡’ ğ’« Bâ‚‚ âŸ«}
  â†’ Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f âŠ‘ f^ â†” pure â‹… Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f âŠ‘ f^ âŸ pure â‹… Î·[ Aâ‚â‡„Bâ‚ ]
Î±[f]âŠ‘f^[ Aâ‚â‡„Bâ‚ , Aâ‚‚â‡„Bâ‚‚ ]â¸¢Î·â¸£ {f} {f^} = LHS , RHS
  where
    LHS : Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f âŠ‘ f^ â†’ pure â‹… Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f âŠ‘ f^ âŸ pure â‹… Î·[ Aâ‚â‡„Bâ‚ ]
    LHS Î±[f]âŠ‘f^ = [âŠ‘-proof-mode]
      do [âŠ‘][[ pure â‹… Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f ]]
      âŠ‘â€£ [âŠ‘-focus-right [âŸ] ğ‘œğ‘“ pure â‹… Î·[ Aâ‚‚â‡„Bâ‚‚ ] ] begin
           do [âŠ‘] f âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] âŸ pure â‹… Î·[ Aâ‚â‡„Bâ‚ ] âŸ… â—‡right-unit[âŸ]â¸¢expansiveâ¸¢Î·â¸£â¸£[ Aâ‚â‡„Bâ‚ ] âŸ†
           âŠ‘â€£ [âŠ‘-â‰ˆ] (f âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ]) âŸ pure â‹… Î·[ Aâ‚â‡„Bâ‚ ] âŸ… â—‡ associative[âŸ] âŸ†
           end
      âŠ‘â€£ [âŠ‘][[ pure â‹… Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŸ (f âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ]) âŸ pure â‹… Î·[ Aâ‚â‡„Bâ‚ ] ]]
      âŠ‘â€£ [âŠ‘-â‰ˆ] (pure â‹… Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ]) âŸ pure â‹… Î·[ Aâ‚â‡„Bâ‚ ] âŸ… â—‡ associative[âŸ] âŸ†
      âŠ‘â€£ [âŠ‘-â‰¡] Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f âŸ pure â‹… Î·[ Aâ‚â‡„Bâ‚ ] âŸ… â†¯ âŸ†
      âŠ‘â€£ [âŠ‘-focus-left [âŸ] ğ‘œğ‘“ pure â‹… Î·[ Aâ‚â‡„Bâ‚ ] ] [âŠ‘] f^ âŸ… Î±[f]âŠ‘f^ âŸ†
      âŠ‘â€£ [âŠ‘][[ f^ âŸ pure â‹… Î·[ Aâ‚â‡„Bâ‚ ] ]]
      â¬œ
    RHS : pure â‹… Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f âŠ‘ f^ âŸ pure â‹… Î·[ Aâ‚â‡„Bâ‚ ] â†’ Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f âŠ‘ f^
    RHS Î·âŸfâŠ‘f^âŸÎ· = [âŠ‘-proof-mode]
      do [âŠ‘][[ Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f ]]
      âŠ‘â€£ [âŠ‘-â‰¡] pure â‹… Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] âŸ… â†¯ âŸ†
      âŠ‘â€£ [âŠ‘-â‰ˆ] (pure â‹… Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f) âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] âŸ… â—‡ associative[âŸ] âŸ†
      âŠ‘â€£ [âŠ‘-focus-left [âŸ] ğ‘œğ‘“ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] ] [âŠ‘] f^ âŸ pure â‹… Î·[ Aâ‚â‡„Bâ‚ ] âŸ… Î·âŸfâŠ‘f^âŸÎ· âŸ†
      âŠ‘â€£ [âŠ‘][[ (f^ âŸ pure â‹… Î·[ Aâ‚â‡„Bâ‚ ]) âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] ]]
      âŠ‘â€£ [âŠ‘-â‰ˆ] f^ âŸ pure â‹… Î·[ Aâ‚â‡„Bâ‚ ] âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] âŸ… associative[âŸ] âŸ†
      âŠ‘â€£ [âŠ‘] f^ âŸ… right-unit[âŸ]â¸¢contractiveâ¸¢Î·â¸£â¸£[ Aâ‚â‡„Bâ‚ ] âŸ†
      â¬œ

Î±[f]âŠ‘f^[_,_]â¸¢Î·-pureâ¸£ : 
  âˆ€ {ğ“} {Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚ : POSet ğ“} (Aâ‚â‡„Bâ‚ : Aâ‚ Î·â‡„Î³ Bâ‚) (Aâ‚‚â‡„Bâ‚‚ : Aâ‚‚ Î·â‡„Î³ Bâ‚‚) {f : âŸª Aâ‚ â‡’ Aâ‚‚ âŸ«} {f^ : âŸª Bâ‚ â‡’ Bâ‚‚ âŸ«}
  â†’ Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… (pure â‹… f) âŠ‘ pure â‹… f^ â†” Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŠ™ f âŠ‘ f^ âŠ™ Î·[ Aâ‚â‡„Bâ‚ ]
Î±[f]âŠ‘f^[ Aâ‚â‡„Bâ‚ , Aâ‚‚â‡„Bâ‚‚ ]â¸¢Î·-pureâ¸£ {f} {f^} = LHS , RHS
  where
    LHS : Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… (pure â‹… f) âŠ‘ pure â‹… f^ â†’ Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŠ™ f âŠ‘ f^ âŠ™ Î·[ Aâ‚â‡„Bâ‚ ]
    LHS Î±[f]âŠ‘f^ = injective[pure]â¸¢âŠ‘â¸£ [âŠ‘-proof-mode]
      do [âŠ‘][[ pure â‹… (Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŠ™ f) ]]
      âŠ‘â€£ [âŠ‘-â‰ˆ] pure â‹… Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŸ pure â‹… f âŸ… â—‡ homomorphic[âŸ]â¸¢pureâ¸£ âŸ†
      âŠ‘â€£ [âŠ‘] pure â‹… f^ âŸ pure â‹… Î·[ Aâ‚â‡„Bâ‚ ] âŸ… Ï€â‚ Î±[f]âŠ‘f^[ Aâ‚â‡„Bâ‚ , Aâ‚‚â‡„Bâ‚‚ ]â¸¢Î·â¸£ Î±[f]âŠ‘f^ âŸ†
      âŠ‘â€£ [âŠ‘-â‰ˆ] pure â‹… (f^ âŠ™ Î·[ Aâ‚â‡„Bâ‚ ]) âŸ… homomorphic[âŸ]â¸¢pureâ¸£ âŸ†
      â¬œ
    RHS : Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŠ™ f âŠ‘ f^ âŠ™ Î·[ Aâ‚â‡„Bâ‚ ] â†’ Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… (pure â‹… f) âŠ‘ pure â‹… f^
    RHS Î·âŠ™fâŠ‘f^âŠ™Î· = Ï€â‚‚ Î±[f]âŠ‘f^[ Aâ‚â‡„Bâ‚ , Aâ‚‚â‡„Bâ‚‚ ]â¸¢Î·â¸£ [âŠ‘-proof-mode]
      do [âŠ‘][[ pure â‹… Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŸ pure â‹… f ]]
      âŠ‘â€£ [âŠ‘-â‰ˆ] pure â‹… (Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŠ™ f) âŸ… homomorphic[âŸ]â¸¢pureâ¸£ âŸ†
      âŠ‘â€£ [âŠ‘-focus-right [â‹…] ğ‘œğ‘“ pure ] [âŠ‘] f^ âŠ™ Î·[ Aâ‚â‡„Bâ‚ ] âŸ… Î·âŠ™fâŠ‘f^âŠ™Î· âŸ†
      âŠ‘â€£ [âŠ‘-â‰ˆ] pure â‹… f^ âŸ pure â‹… Î·[ Aâ‚â‡„Bâ‚ ] âŸ… â—‡ homomorphic[âŸ]â¸¢pureâ¸£ âŸ†
      â¬œ

Î±[f]âŠ‘f^[_,_]â¸¢Î³â¸£ :
  âˆ€ {ğ“} {Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚ : POSet ğ“} (Aâ‚â‡„Bâ‚ : Aâ‚ Î·â‡„Î³ Bâ‚) (Aâ‚‚â‡„Bâ‚‚ : Aâ‚‚ Î·â‡„Î³ Bâ‚‚) {f : âŸª Aâ‚ â‡’ ğ’« Aâ‚‚ âŸ«} {f^ : âŸª Bâ‚ â‡’ ğ’« Bâ‚‚ âŸ«}
  â†’ Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f âŠ‘ f^ â†” f âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] âŠ‘ Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f^
Î±[f]âŠ‘f^[ Aâ‚â‡„Bâ‚ , Aâ‚‚â‡„Bâ‚‚ ]â¸¢Î³â¸£ {f} {f^} = LHS , RHS
  where
    LHS : Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f âŠ‘ f^ â†’ f âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] âŠ‘ Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f^
    LHS Î±[f]âŠ‘f^ = [âŠ‘-proof-mode]
      do [âŠ‘][[ f âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] ]]
      âŠ‘â€£ [âŠ‘] Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] âŸ pure â‹… Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] âŸ… â—‡left-unit[âŸ]â¸¢expansiveâ¸¢Î·â¸£â¸£[ Aâ‚‚â‡„Bâ‚‚ ] âŸ†
      âŠ‘â€£ [âŠ‘-â‰¡] Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] âŸ Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f âŸ… â†¯ âŸ†
      âŠ‘â€£ [âŠ‘-focus-right [âŸ] ğ‘œğ‘“ Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] ] [âŠ‘] f^ âŸ… Î±[f]âŠ‘f^ âŸ†
      âŠ‘â€£ [âŠ‘][[ Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f^ ]]
      â¬œ
    RHS : f âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] âŠ‘ Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f^ â†’ Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f âŠ‘ f^
    RHS fâŸÎ³âŠ‘Î³âŸf^ = [âŠ‘-proof-mode]
      do [âŠ‘][[ Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f ]]
      âŠ‘â€£ [âŠ‘-â‰¡] pure â‹… Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] âŸ… â†¯ âŸ†
      âŠ‘â€£ [âŠ‘-focus-right [âŸ] ğ‘œğ‘“ pure â‹… Î·[ Aâ‚‚â‡„Bâ‚‚ ] ] [âŠ‘] Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f^ âŸ… fâŸÎ³âŠ‘Î³âŸf^ âŸ†
      âŠ‘â€£ [âŠ‘][[ pure â‹… Î·[ Aâ‚‚â‡„Bâ‚‚ ] âŸ Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f^ ]]
      âŠ‘â€£ [âŠ‘] f^ âŸ… left-unit[âŸ]â¸¢contractiveâ¸¢Î·â¸£â¸£[ Aâ‚‚â‡„Bâ‚‚ ] âŸ†
      â¬œ
  
Î±[f]âŠ‘f^[_,_]â¸¢Î³*â¸£ :
  âˆ€ {ğ“} {Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚ : POSet ğ“} (Aâ‚â‡„Bâ‚ : Aâ‚ Î·â‡„Î³ Bâ‚) (Aâ‚‚â‡„Bâ‚‚ : Aâ‚‚ Î·â‡„Î³ Bâ‚‚) {f : âŸª Aâ‚ â‡’ ğ’« Aâ‚‚ âŸ«} {f^ : âŸª Bâ‚ â‡’ ğ’« Bâ‚‚ âŸ«}
  â†’ Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f âŠ‘ f^ â†” (âˆ€ {x} â†’ f * â‹… (Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] â‹… x) âŠ‘ Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] * â‹… (f^ â‹… x))
Î±[f]âŠ‘f^[ Aâ‚â‡„Bâ‚ , Aâ‚‚â‡„Bâ‚‚ ]â¸¢Î³*â¸£ {f} {f^} = LHS , RHS
  where
    LHS : Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f âŠ‘ f^ â†’ âˆ€ {x} â†’ f * â‹… (Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] â‹… x) âŠ‘ Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] * â‹… (f^ â‹… x)
    LHS Î±[f]âŠ‘f^ {x} = res-f[Î»]â¸¢âŠ‘â¸£ {x = x} (Ï€â‚ Î±[f]âŠ‘f^[ Aâ‚â‡„Bâ‚ , Aâ‚‚â‡„Bâ‚‚ ]â¸¢Î³â¸£ Î±[f]âŠ‘f^)
    RHS : (âˆ€ {x} â†’ f * â‹… (Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] â‹… x) âŠ‘ Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] * â‹… (f^ â‹… x)) â†’ Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f âŠ‘ f^
    RHS f[Î³[x]]âŠ‘Î³[f^[x]] = Ï€â‚‚ Î±[f]âŠ‘f^[ Aâ‚â‡„Bâ‚ , Aâ‚‚â‡„Bâ‚‚ ]â¸¢Î³â¸£ $ ext[Î»]â¸¢âŠ‘â¸£ $ Î» {x} â†’ f[Î³[x]]âŠ‘Î³[f^[x]] {x}

Î±[f]âŠ‘f^[_,_]â¸¢Î³*Xâ¸£ :
  âˆ€ {ğ“} {Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚ : POSet ğ“} (Aâ‚â‡„Bâ‚ : Aâ‚ Î·â‡„Î³ Bâ‚) (Aâ‚‚â‡„Bâ‚‚ : Aâ‚‚ Î·â‡„Î³ Bâ‚‚) {f : âŸª Aâ‚ â‡’ ğ’« Aâ‚‚ âŸ«} {f^ : âŸª Bâ‚ â‡’ ğ’« Bâ‚‚ âŸ«}
  â†’ Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f âŠ‘ f^ â†” (âˆ€ {X} â†’ f * â‹… (Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] * â‹… X) âŠ‘ Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] * â‹… (f^ * â‹… X))
Î±[f]âŠ‘f^[ Aâ‚â‡„Bâ‚ , Aâ‚‚â‡„Bâ‚‚ ]â¸¢Î³*Xâ¸£ {f} {f^} = LHS , RHS
  where
    LHS : Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f âŠ‘ f^ â†’ âˆ€ {X} â†’ f * â‹… (Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] * â‹… X) âŠ‘ Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] * â‹… (f^ * â‹… X)
    LHS Î±[f]âŠ‘f^ {X} = [âŠ‘-proof-mode]
      do [âŠ‘][[ f * â‹… (Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] * â‹… X) ]]
      âŠ‘â€£ [âŠ‘-â‰ˆ] (f âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ]) * â‹… X âŸ… â—‡ associative[âŸ]â¸¢*â¸£ âŸ†
      âŠ‘â€£ [âŠ‘-focus-left [â‹…] ğ‘œğ‘“ X ] $
         [âŠ‘-focus-in [*] ] [âŠ‘] Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f^ âŸ… Ï€â‚ Î±[f]âŠ‘f^[ Aâ‚â‡„Bâ‚ , Aâ‚‚â‡„Bâ‚‚ ]â¸¢Î³â¸£ Î±[f]âŠ‘f^ âŸ†
      âŠ‘â€£ [âŠ‘][[ (Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f^) * â‹… X ]]
      âŠ‘â€£ [âŠ‘-â‰ˆ] Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] * â‹… (f^ * â‹… X) âŸ… associative[âŸ]â¸¢*â¸£ âŸ†
      â¬œ
    RHS : (âˆ€ {X} â†’ f * â‹… (Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] * â‹… X) âŠ‘ Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] * â‹… (f^ * â‹… X)) â†’ Î±[ Aâ‚â‡„Bâ‚ â‡’â¸¢Î·â‡„Î³â¸£ Aâ‚‚â‡„Bâ‚‚ ] â‹… f âŠ‘ f^
    RHS f[Î³[X]]âŠ‘Î³[f^[X]] = Ï€â‚‚ Î±[f]âŠ‘f^[ Aâ‚â‡„Bâ‚ , Aâ‚‚â‡„Bâ‚‚ ]â¸¢Î³â¸£ $ injective[*]â¸¢âŠ‘â¸£ $ ext[Î»]â¸¢âŠ‘â¸£ $ Î» {X} â†’ [âŠ‘-proof-mode]
      do [âŠ‘][[ (f âŸ Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ]) * â‹… X ]]
      âŠ‘â€£ [âŠ‘-â‰ˆ] f * â‹… (Î³â¸¢Î·â¸£[ Aâ‚â‡„Bâ‚ ] * â‹… X) âŸ… associative[âŸ]â¸¢*â¸£ âŸ†
      âŠ‘â€£ [âŠ‘] Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] * â‹… (f^ * â‹… X) âŸ… f[Î³[X]]âŠ‘Î³[f^[X]] âŸ†
      âŠ‘â€£ [âŠ‘-â‰ˆ] (Î³â¸¢Î·â¸£[ Aâ‚‚â‡„Bâ‚‚ ] âŸ f^) * â‹… X âŸ… â—‡ associative[âŸ]â¸¢*â¸£ âŸ†
      â¬œ
