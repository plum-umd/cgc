module Poset.ProofMode where

open import Prelude
open import Poset.Poset
open import Poset.Fun
open import Poset.Classes
open import Poset.Lib

abstract
  âŸ¬_âŸ­ : âˆ€ {â„“} {A : Poset â„“} (x : âŸª A âŸ«) â†’ âŸª A âŸ«
  âŸ¬ x âŸ­ = x

  unfold[âŸ¬_âŸ­] : âˆ€ {â„“} {A : Poset â„“} (x : âŸª A âŸ«) â†’ âŸ¬ x âŸ­ â‰¡ x
  unfold[âŸ¬ x âŸ­] = â†¯

inj[âŸ¬âŸ­] : âˆ€ {â„“} {A : Poset â„“} {x y : âŸª A âŸ«} â†’ âŸ¬ x âŸ­ â‰¡ âŸ¬ y âŸ­ â†’ x â‰¡ y
inj[âŸ¬âŸ­] {x = x} {y} rewrite unfold[âŸ¬ x âŸ­] | unfold[âŸ¬ y âŸ­] = id
  
_â¦‰_â¦Š_â‡°_ : âˆ€ {â„“â‚} â„“â‚‚ {A : Poset â„“â‚} (_R_ : âˆ€ {â„“} {A : Poset â„“} â†’ relation â„“ âŸª A âŸ«) â†’ relation (â„“â‚ âŠ”á´¸ â†‘á´¸ â„“â‚‚) âŸª A âŸ«
_â¦‰_â¦Š_â‡°_ â„“â‚‚ {A} _R_ xâ‚ xâ‚‚ = âˆ€ {B : Poset â„“â‚‚} {y : âŸª B âŸ«} {k : âŸª A â†— B âŸ«} â†’ (k â‹… xâ‚‚) R y â†’ (k â‹… xâ‚) R y 

module ProofMode
  (_R_ : âˆ€ {â„“} {A : Poset â„“} â†’ relation â„“ âŸª A âŸ«)
  {{R-Refl : âˆ€ {â„“} {A : Poset â„“} â†’ Reflexive (_R_ {A = A})}}
  {{R-Transitive : âˆ€ {â„“} {A : Poset â„“} â†’ Transitive (_R_ {A = A})}}
  {{R-Logical : âˆ€ {â„“â‚ â„“â‚‚} {A : Poset â„“â‚} {B : Poset â„“â‚‚} â†’ Logical[â†—] (_R_ {A = A}) (_R_ {A = B}) (_R_ {A = A â†— B})}}
  (_â¦‰Râ¦Š_â‡°_ : âˆ€ {â„“â‚} â„“â‚‚ {A : Poset â„“â‚} â†’ relation (â„“â‚ âŠ”á´¸ â†‘á´¸ â„“â‚‚) âŸª A âŸ«)
  (mk[â‡°] : âˆ€ {â„“â‚ â„“â‚‚} {A : Poset â„“â‚} {xâ‚ xâ‚‚ : âŸª A âŸ«} â†’ â„“â‚‚ â¦‰ _R_ â¦Š xâ‚ â‡° xâ‚‚ â†’ â„“â‚‚ â¦‰Râ¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­)
  (un[â‡°] : âˆ€ {â„“â‚ â„“â‚‚} {A : Poset â„“â‚} {xâ‚ xâ‚‚ : âŸª A âŸ«} â†’ â„“â‚‚ â¦‰Râ¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­ â†’ â„“â‚‚ â¦‰ _R_ â¦Š xâ‚ â‡° xâ‚‚)
  where
  [proof-mode]_âˆ : âˆ€ {â„“} {A : Poset â„“} {xâ‚ xâ‚‚ : âŸª A âŸ«} â†’ â„“ â¦‰Râ¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­ â†’ xâ‚ R xâ‚‚
  [proof-mode] F âˆ = un[â‡°] F {k = idâ™®} (xRx {{R-Refl}})

  infixr 0  _â€£_
  _â€£_ : âˆ€ {â„“â‚ â„“â‚‚} {A : Poset â„“â‚} {xâ‚ xâ‚‚ xâ‚ƒ : âŸª A âŸ«} â†’ â„“â‚‚ â¦‰Râ¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­ â†’ â„“â‚‚ â¦‰Râ¦Š âŸ¬ xâ‚‚ âŸ­ â‡° âŸ¬ xâ‚ƒ âŸ­ â†’ â„“â‚‚ â¦‰Râ¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚ƒ âŸ­
  _â€£_ G F = mk[â‡°] $ Î» {B} {y} {k} â†’ un[â‡°] G {k = k} âˆ˜ un[â‡°] F {k = k}

  [[_]] : âˆ€ {â„“â‚ â„“â‚‚} {A : Poset â„“â‚} (x : âŸª A âŸ«) â†’ â„“â‚‚ â¦‰Râ¦Š âŸ¬ x âŸ­ â‡° âŸ¬ x âŸ­
  [[ x ]] = mk[â‡°] id

  âŸ…_âŸ† : âˆ€ {â„“â‚ â„“â‚‚} {A : Poset â„“â‚} {xâ‚ xâ‚‚ : âŸª A âŸ«} â†’ xâ‚ R xâ‚‚ â†’ â„“â‚‚ â¦‰Râ¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­
  âŸ… xâ‚Rxâ‚‚ âŸ† = mk[â‡°] $ Î» {B} {y} {k} P â†’ _âŠš_ {{R-Transitive}} P (res[â€¢x][â†—] {f = k} xâ‚Rxâ‚‚)

  âŸ…_âŸ†â¸¢â‰¡â¸£ : âˆ€ {â„“â‚ â„“â‚‚} {A : Poset â„“â‚} â†’ {xâ‚ xâ‚‚ : âŸª A âŸ«} (P : xâ‚ â‰¡ xâ‚‚) â†’ â„“â‚‚ â¦‰Râ¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­
  âŸ… xâ‚â‰¡xâ‚‚ âŸ†â¸¢â‰¡â¸£ = âŸ… xRx[â‰¡] xâ‚â‰¡xâ‚‚ âŸ†

  [focus-in_] :
    âˆ€ {â„“â‚ â„“â‚‚ â„“â‚ƒ} {A : Poset â„“â‚} {B : Poset â„“â‚‚} (op : âŸª A â†— B âŸ«) {x : âŸª A âŸ«} {y : âŸª A âŸ«}
    â†’ â„“â‚ƒ â¦‰Râ¦Š âŸ¬ x âŸ­ â‡° âŸ¬ y âŸ­ â†’ â„“â‚ƒ â¦‰Râ¦Š âŸ¬ op â‹… x âŸ­ â‡° âŸ¬ op â‹… y âŸ­
  [focus-in op ] xâ‡°y = mk[â‡°] $ Î» {D} {z} {k} â†’ un[â‡°] xâ‡°y {k = k âˆ˜â™® op}

  [focus-left_ğ‘œğ‘“_] :
    âˆ€ {â„“â‚ â„“â‚‚ â„“â‚ƒ â„“â‚„} {A : Poset â„“â‚} {B : Poset â„“â‚‚} {C : Poset â„“â‚ƒ} (op : âŸª A â†— B â†— C âŸ«) (z : âŸª B âŸ«) {x y : âŸª A âŸ«} 
    â†’ â„“â‚„ â¦‰Râ¦Š âŸ¬ x âŸ­ â‡° âŸ¬ y âŸ­ â†’ â„“â‚„ â¦‰Râ¦Š âŸ¬ op â‹… x â‹… z âŸ­ â‡° âŸ¬ op â‹… y â‹… z âŸ­
  [focus-left op ğ‘œğ‘“ z ] xâ‡°y = mk[â‡°] $ Î» {_ _ k} â†’ un[â‡°] xâ‡°y {k = k âˆ˜â™® flipâ™® â‹… op â‹… z}

  [focus-right_ğ‘œğ‘“_] :
    âˆ€ {â„“â‚ â„“â‚‚ â„“â‚ƒ â„“â‚„} {A : Poset â„“â‚} {B : Poset â„“â‚‚} {C : Poset â„“â‚ƒ} (op : âŸª A â†— B â†— C âŸ«) (z : âŸª A âŸ«) {x y : âŸª B âŸ«}
    â†’ â„“â‚„ â¦‰Râ¦Š âŸ¬ x âŸ­ â‡° âŸ¬ y âŸ­ â†’ â„“â‚„ â¦‰Râ¦Š âŸ¬ op â‹… z â‹… x âŸ­ â‡° âŸ¬ op â‹… z â‹… y âŸ­
  [focus-right op ğ‘œğ‘“ z ] xâ‡°y = mk[â‡°] $ Î» {_ _ k} â†’ un[â‡°] xâ‡°y {k = k âˆ˜â™® op â‹… z}

  module Â§-Reflexive[â‰ˆ]
    {{R-Refl[â‰ˆ] : âˆ€ {â„“} {A : Poset â„“} â†’ Reflexive[ _â‰ˆâ™®_ ] (_R_ {A = A})}}
    where
    âŸ…_âŸ†â¸¢â‰ˆâ¸£ : âˆ€ {â„“â‚ â„“â‚‚} {A : Poset â„“â‚} â†’ {xâ‚ xâ‚‚ : âŸª A âŸ«} (P : xâ‚ â‰ˆâ™® xâ‚‚) â†’ â„“â‚‚ â¦‰Râ¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­
    âŸ… xâ‚â‰ˆxâ‚‚ âŸ†â¸¢â‰ˆâ¸£ = âŸ… xRx[] xâ‚â‰ˆxâ‚‚ âŸ†

data _â¦‰âŠ‘â¦Š_â‡°_ {â„“â‚} â„“â‚‚ {A : Poset â„“â‚} : relation (â„“â‚ âŠ”á´¸ â†‘á´¸ â„“â‚‚) âŸª A âŸ« where
  mk[â¦‰âŠ‘â¦Š]-â‰¡ : âˆ€ {xâ‚ xâ‚‚ xâ‚ƒ xâ‚„ : âŸª A âŸ«} â†’ xâ‚ƒ â‰¡ âŸ¬ xâ‚ âŸ­ â†’ xâ‚„ â‰¡ âŸ¬ xâ‚‚ âŸ­ â†’ â„“â‚‚ â¦‰ _âŠ‘â™®_ â¦Š xâ‚ â‡° xâ‚‚ â†’ â„“â‚‚ â¦‰âŠ‘â¦Š xâ‚ƒ â‡° xâ‚„

mk[â¦‰âŠ‘â¦Š] : âˆ€ {â„“â‚ â„“â‚‚} {A : Poset â„“â‚} {xâ‚ xâ‚‚ : âŸª A âŸ«} â†’ â„“â‚‚ â¦‰ _âŠ‘â™®_ â¦Š xâ‚ â‡° xâ‚‚ â†’ â„“â‚‚ â¦‰âŠ‘â¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­
mk[â¦‰âŠ‘â¦Š] = mk[â¦‰âŠ‘â¦Š]-â‰¡ â†¯ â†¯

un[â¦‰âŠ‘â¦Š] : âˆ€ {â„“â‚ â„“â‚‚} {A : Poset â„“â‚} {xâ‚ xâ‚‚ : âŸª A âŸ«} â†’ â„“â‚‚ â¦‰âŠ‘â¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­ â†’ â„“â‚‚ â¦‰ _âŠ‘â™®_ â¦Š xâ‚ â‡° xâ‚‚
un[â¦‰âŠ‘â¦Š] (mk[â¦‰âŠ‘â¦Š]-â‰¡ Eâ‚ Eâ‚‚ P) rewrite inj[âŸ¬âŸ­] Eâ‚ | inj[âŸ¬âŸ­] Eâ‚‚ = Î» {B} {y} {k} â†’ P {B} {y} {k}

module ProofMode[âŠ‘] where
  open ProofMode _âŠ‘â™®_ _â¦‰âŠ‘â¦Š_â‡°_ mk[â¦‰âŠ‘â¦Š] un[â¦‰âŠ‘â¦Š] public
  open Â§-Reflexive[â‰ˆ] public

open ProofMode[âŠ‘] using () renaming
  ( [proof-mode]_âˆ     to [proof-mode]â¸¢âŠ‘â¸£_âˆ
  ; _â€£_                to _â€£â¸¢âŠ‘â¸£_
  ; [[_]]              to [[_]]â¸¢âŠ‘â¸£
  ; âŸ…_âŸ†                to âŸ…_âŸ†â¸¢âŠ‘â¸£
  ; âŸ…_âŸ†â¸¢â‰¡â¸£             to âŸ…_âŸ†â¸¢âŠ‘-â‰¡â¸£
  ; [focus-in_]        to [focus-in_]â¸¢âŠ‘â¸£
  ; [focus-left_ğ‘œğ‘“_]   to [focus-left_ğ‘œğ‘“_]â¸¢âŠ‘â¸£
  ; [focus-right_ğ‘œğ‘“_]  to [focus-right_ğ‘œğ‘“_]â¸¢âŠ‘â¸£
  ; âŸ…_âŸ†â¸¢â‰ˆâ¸£             to âŸ…_âŸ†â¸¢âŠ‘-â‰ˆâ¸£
  ) public

data _â¦‰â‰ˆâ¦Š_â‡°_ {â„“â‚} â„“â‚‚ {A : Poset â„“â‚} : relation (â„“â‚ âŠ”á´¸ â†‘á´¸ â„“â‚‚) âŸª A âŸ« where
  mk[â¦‰â‰ˆâ¦Š]-â‰¡ : âˆ€ {xâ‚ xâ‚‚ xâ‚ƒ xâ‚„ : âŸª A âŸ«} â†’ xâ‚ƒ â‰¡ âŸ¬ xâ‚ âŸ­ â†’ xâ‚„ â‰¡ âŸ¬ xâ‚‚ âŸ­ â†’ â„“â‚‚ â¦‰ _â‰ˆâ™®_ â¦Š xâ‚ â‡° xâ‚‚ â†’ â„“â‚‚ â¦‰â‰ˆâ¦Š xâ‚ƒ â‡° xâ‚„

mk[â¦‰â‰ˆâ¦Š] : âˆ€ {â„“â‚ â„“â‚‚} {A : Poset â„“â‚} {xâ‚ xâ‚‚ : âŸª A âŸ«} â†’ â„“â‚‚ â¦‰ _â‰ˆâ™®_ â¦Š xâ‚ â‡° xâ‚‚ â†’ â„“â‚‚ â¦‰â‰ˆâ¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­
mk[â¦‰â‰ˆâ¦Š] = mk[â¦‰â‰ˆâ¦Š]-â‰¡ â†¯ â†¯

un[â¦‰â‰ˆâ¦Š] : âˆ€ {â„“â‚ â„“â‚‚} {A : Poset â„“â‚} {xâ‚ xâ‚‚ : âŸª A âŸ«} â†’ â„“â‚‚ â¦‰â‰ˆâ¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­ â†’ â„“â‚‚ â¦‰ _â‰ˆâ™®_ â¦Š xâ‚ â‡° xâ‚‚
un[â¦‰â‰ˆâ¦Š] (mk[â¦‰â‰ˆâ¦Š]-â‰¡ Eâ‚ Eâ‚‚ P) rewrite inj[âŸ¬âŸ­] Eâ‚ | inj[âŸ¬âŸ­] Eâ‚‚ = Î» {B} {y} {k} â†’ P {B} {y} {k}

module ProofMode[â‰ˆ] where
  open ProofMode _â‰ˆâ™®_ _â¦‰â‰ˆâ¦Š_â‡°_ mk[â¦‰â‰ˆâ¦Š] un[â¦‰â‰ˆâ¦Š] public
open ProofMode[â‰ˆ] using () renaming
  ( [proof-mode]_âˆ    to [proof-mode]â¸¢â‰ˆâ¸£_âˆ
  ; _â€£_                to _â€£â¸¢â‰ˆâ¸£_
  ; [[_]]            to [[_]]â¸¢â‰ˆâ¸£
  ; âŸ…_âŸ†              to âŸ…_âŸ†â¸¢â‰ˆ-â‰ˆâ¸£
  ; âŸ…_âŸ†â¸¢â‰¡â¸£            to âŸ…_âŸ†â¸¢â‰ˆ-â‰¡â¸£
  ; [focus-in_]       to [focus-in_]â¸¢â‰ˆâ¸£
  ; [focus-left_ğ‘œğ‘“_]  to [focus-left_ğ‘œğ‘“_]â¸¢â‰ˆâ¸£
  ; [focus-right_ğ‘œğ‘“_] to [focus-right_ğ‘œğ‘“_]â¸¢â‰ˆâ¸£
  ) public

data _â¦‰â‰¡â¦Š_â‡°_ {â„“â‚} â„“â‚‚ {A : Poset â„“â‚} : relation (â„“â‚ âŠ”á´¸ â†‘á´¸ â„“â‚‚) âŸª A âŸ« where
  mk[â¦‰â‰¡â¦Š]-â‰¡ : âˆ€ {xâ‚ xâ‚‚ xâ‚ƒ xâ‚„ : âŸª A âŸ«} â†’ xâ‚ƒ â‰¡ âŸ¬ xâ‚ âŸ­ â†’ xâ‚„ â‰¡ âŸ¬ xâ‚‚ âŸ­ â†’ â„“â‚‚ â¦‰ _â‰¡_ â¦Š xâ‚ â‡° xâ‚‚ â†’ â„“â‚‚ â¦‰â‰¡â¦Š xâ‚ƒ â‡° xâ‚„

mk[â¦‰â‰¡â¦Š] : âˆ€ {â„“â‚ â„“â‚‚} {A : Poset â„“â‚} {xâ‚ xâ‚‚ : âŸª A âŸ«} â†’ â„“â‚‚ â¦‰ _â‰¡_ â¦Š xâ‚ â‡° xâ‚‚ â†’ â„“â‚‚ â¦‰â‰¡â¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­
mk[â¦‰â‰¡â¦Š] = mk[â¦‰â‰¡â¦Š]-â‰¡ â†¯ â†¯

un[â¦‰â‰¡â¦Š] : âˆ€ {â„“â‚ â„“â‚‚} {A : Poset â„“â‚} {xâ‚ xâ‚‚ : âŸª A âŸ«} â†’ â„“â‚‚ â¦‰â‰¡â¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­ â†’ â„“â‚‚ â¦‰ _â‰¡_ â¦Š xâ‚ â‡° xâ‚‚
un[â¦‰â‰¡â¦Š] (mk[â¦‰â‰¡â¦Š]-â‰¡ Eâ‚ Eâ‚‚ P) rewrite inj[âŸ¬âŸ­] Eâ‚ | inj[âŸ¬âŸ­] Eâ‚‚ = Î» {B} {y} {k} â†’ P {B} {y} {k}

module ProofMode[â‰¡] where
  open ProofMode _â‰¡_ _â¦‰â‰¡â¦Š_â‡°_ mk[â¦‰â‰¡â¦Š] un[â¦‰â‰¡â¦Š] public
open ProofMode[â‰¡] using () renaming
  ( [proof-mode]_âˆ     to [proof-mode]â¸¢â‰¡â¸£_âˆ
  ; _â€£_                to _â€£â¸¢â‰¡â¸£_
  ; [[_]]              to [[_]]â¸¢â‰¡â¸£
  ; âŸ…_âŸ†                to âŸ…_âŸ†â¸¢â‰¡-â‰¡â¸£
  ; [focus-in_]        to [focus-in_]â¸¢â‰¡â¸£
  ; [focus-left_ğ‘œğ‘“_]   to [focus-left_ğ‘œğ‘“_]â¸¢â‰¡â¸£
  ; [focus-right_ğ‘œğ‘“_]  to [focus-right_ğ‘œğ‘“_]â¸¢â‰¡â¸£
  ) public

-- record ProofMode {â„“} (_R_ : âˆ€ {A : Poset â„“} â†’ relation â„“ âŸª A âŸ«) (â¦‰Râ¦Š_â‡°_ : âˆ€ {A : Poset â„“} â†’ relation (â†‘á´¸ â„“) âŸª A âŸ«) : Set (â†‘á´¸ â„“) where
--   field
--     [proof-mode]_âˆ : âˆ€ {A : Poset â„“} {xâ‚ xâ‚‚ : âŸª A âŸ«} â†’ â¦‰Râ¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­ â†’ xâ‚ R xâ‚‚
-- open ProofMode {{...}} public
-- 
-- record ProofState {â„“â‚ â„“â‚‚} (â¦‰Râ¦Š_â‡°_ : âˆ€ {A : Poset â„“â‚} â†’ relation (â„“â‚ âŠ”á´¸ â†‘á´¸ â„“â‚‚) âŸª A âŸ«) : Set (â†‘á´¸ (â„“â‚ âŠ”á´¸ â„“â‚‚)) where
--   infixr 0 _â€£_
--   field
--     _â€£_ : âˆ€ {A : Poset â„“â‚} {xâ‚ xâ‚‚ xâ‚ƒ : âŸª A âŸ«} â†’ â¦‰Râ¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­ â†’ â¦‰Râ¦Š âŸ¬ xâ‚‚ âŸ­ â‡° âŸ¬ xâ‚ƒ âŸ­ â†’ â¦‰Râ¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚ƒ âŸ­
--     [[_]] : âˆ€ {A : Poset â„“â‚} (x : âŸª A âŸ«) â†’ â¦‰Râ¦Š âŸ¬ x âŸ­ â‡° âŸ¬ x âŸ­
-- open ProofState {{...}} public
-- 
-- record ProofStep {â„“â‚ â„“â‚‚} (_R_ : âˆ€ {A : Poset â„“â‚} â†’ relation â„“â‚ âŸª A âŸ«) (â¦‰Râ¦Š_â‡°_ : âˆ€ {A : Poset â„“â‚} â†’ relation (â„“â‚ âŠ”á´¸ â†‘á´¸ â„“â‚‚) âŸª A âŸ«) : Set (â†‘á´¸ (â„“â‚ âŠ”á´¸ â„“â‚‚)) where
--   field
--     âŸ…_âŸ† : âˆ€ {A : Poset â„“â‚} {xâ‚ xâ‚‚ : âŸª A âŸ«} â†’ xâ‚ R xâ‚‚ â†’ â¦‰Râ¦Š âŸ¬ xâ‚ âŸ­ â‡° âŸ¬ xâ‚‚ âŸ­
-- open ProofStep {{...}} public
-- 
-- record ProofFocusIn {â„“â‚ â„“â‚‚ â„“â‚ƒ}
--   (â¦‰Râ¦Šâ‚_â‡°_ : âˆ€ {A : Poset â„“â‚} â†’ relation (â„“â‚ âŠ”á´¸ â†‘á´¸ â„“â‚ƒ) âŸª A âŸ«)
--   (â¦‰Râ¦Šâ‚‚_â‡°_ : âˆ€ {A : Poset â„“â‚‚} â†’ relation (â„“â‚‚ âŠ”á´¸ â†‘á´¸ â„“â‚ƒ) âŸª A âŸ«)
--   : Set (â†‘á´¸ (â„“â‚ âŠ”á´¸ â„“â‚‚ âŠ”á´¸ â„“â‚ƒ)) where
--   field
--     [focus-in_] : âˆ€ {A : Poset â„“â‚} {B : Poset â„“â‚‚} (op : âŸª A â†— B âŸ«) {x : âŸª A âŸ«} {y : âŸª A âŸ«} â†’ â¦‰Râ¦Šâ‚ âŸ¬ x âŸ­ â‡° âŸ¬ y âŸ­ â†’ â¦‰Râ¦Šâ‚‚ âŸ¬ op â‹… x âŸ­ â‡° âŸ¬ op â‹… y âŸ­
-- open ProofFocusIn {{...}} public
-- 
-- record ProofFocusLeft {â„“â‚ â„“â‚‚ â„“â‚ƒ â„“â‚„}
--   (â¦‰Râ¦Šâ‚_â‡°_ : âˆ€ {A : Poset â„“â‚} â†’ relation (â„“â‚ âŠ”á´¸ â†‘á´¸ â„“â‚„) âŸª A âŸ«)
--   (â¦‰Râ¦Šâ‚ƒ_â‡°_ : âˆ€ {A : Poset â„“â‚ƒ} â†’ relation (â„“â‚ƒ âŠ”á´¸ â†‘á´¸ â„“â‚„) âŸª A âŸ«)
--   : Set (â†‘á´¸ (â„“â‚ âŠ”á´¸ â„“â‚‚ âŠ”á´¸ â„“â‚ƒ âŠ”á´¸ â„“â‚„)) where
--   field
--     [focus-left_ğ‘œğ‘“_] :
--       âˆ€ {A : Poset â„“â‚} {B : Poset â„“â‚‚} {C : Poset â„“â‚ƒ} (op : âŸª A â†— B â†— C âŸ«) (z : âŸª B âŸ«) {x y : âŸª A âŸ«} 
--       â†’ â¦‰Râ¦Šâ‚ âŸ¬ x âŸ­ â‡° âŸ¬ y âŸ­ â†’ â¦‰Râ¦Šâ‚ƒ âŸ¬ op â‹… x â‹… z âŸ­ â‡° âŸ¬ op â‹… y â‹… z âŸ­
-- open ProofFocusLeft {{...}} public
-- 
-- record ProofFocusRight {â„“â‚ â„“â‚‚ â„“â‚ƒ â„“â‚„}
--   (â¦‰Râ¦Šâ‚‚_â‡°_ : âˆ€ {A : Poset â„“â‚‚} â†’ relation (â„“â‚‚ âŠ”á´¸ â†‘á´¸ â„“â‚„) âŸª A âŸ«)
--   (â¦‰Râ¦Šâ‚ƒ_â‡°_ : âˆ€ {A : Poset â„“â‚ƒ} â†’ relation (â„“â‚ƒ âŠ”á´¸ â†‘á´¸ â„“â‚„) âŸª A âŸ«)
--   : Set (â†‘á´¸ (â„“â‚ âŠ”á´¸ â„“â‚‚ âŠ”á´¸ â„“â‚ƒ âŠ”á´¸ â„“â‚„)) where
--   field
--     [focus-right_ğ‘œğ‘“_] :
--       âˆ€ {A : Poset â„“â‚} {B : Poset â„“â‚‚} {C : Poset â„“â‚ƒ} (op : âŸª A â†— B â†— C âŸ«) (z : âŸª A âŸ«) {x y : âŸª B âŸ«}
--       â†’ â¦‰Râ¦Šâ‚‚ âŸ¬ x âŸ­ â‡° âŸ¬ y âŸ­ â†’ â¦‰Râ¦Šâ‚ƒ âŸ¬ op â‹… z â‹… x âŸ­ â‡° âŸ¬ op â‹… z â‹… y âŸ­
-- open ProofFocusRight {{...}} public

-- instance
--   ProofMode[âŠ‘] : âˆ€ {â„“} â†’ ProofMode {â„“} _âŠ‘_ (_â¦‰âŠ‘â¦Š_â‡°_ â„“)
--   ProofMode[âŠ‘] = record { [proof-mode]_âˆ = ProofMode[âŠ‘].[R-proof-mode]_âˆ }
--   ProofState[âŠ‘] : âˆ€ {â„“â‚ â„“â‚‚} â†’ ProofState {â„“â‚} {â„“â‚‚} (_â¦‰âŠ‘â¦Š_â‡°_ â„“â‚‚)
--   ProofState[âŠ‘] = record { _â€£_ = ProofMode[âŠ‘]._Râ€£_ ; [[_]] = ProofMode[âŠ‘].[R][[_]]}
--   ProofStep[âŠ‘] : âˆ€ {â„“â‚ â„“â‚‚} â†’ ProofStep {â„“â‚} {â„“â‚‚} _âŠ‘_ (_â¦‰âŠ‘â¦Š_â‡°_ â„“â‚‚)
--   ProofStep[âŠ‘] = record { âŸ…_âŸ† = ProofMode[âŠ‘].[R]âŸ…_âŸ† }
--   ProofStep[âŠ‘-â‰¡] : âˆ€ {â„“â‚ â„“â‚‚} â†’ ProofStep {â„“â‚} {â„“â‚‚} _â‰¡_ (_â¦‰âŠ‘â¦Š_â‡°_ â„“â‚‚)
--   ProofStep[âŠ‘-â‰¡] = record { âŸ…_âŸ† = ProofMode[âŠ‘].[R-â‰¡]âŸ…_âŸ† }
--   ProofStep[âŠ‘-â‰ˆ] : âˆ€ {â„“â‚ â„“â‚‚} â†’ ProofStep {â„“â‚} {â„“â‚‚} _â‰ˆ_ (_â¦‰âŠ‘â¦Š_â‡°_ â„“â‚‚)
--   ProofStep[âŠ‘-â‰ˆ] = record { âŸ…_âŸ† = ProofMode[âŠ‘].Â§-Reflexive[â‰ˆ].[R-â‰ˆ]âŸ…_âŸ† }
--   ProofFocusIn[âŠ‘] : âˆ€ {â„“â‚ â„“â‚‚ â„“â‚ƒ} â†’ ProofFocusIn {â„“â‚} {â„“â‚‚} {â„“â‚ƒ} (_â¦‰âŠ‘â¦Š_â‡°_ â„“â‚ƒ) (_â¦‰âŠ‘â¦Š_â‡°_ â„“â‚ƒ)
--   ProofFocusIn[âŠ‘] = record { [focus-in_] = ProofMode[âŠ‘].[R-focus-in_] }
--   ProofFocusLeft[âŠ‘] : âˆ€ {â„“â‚ â„“â‚‚ â„“â‚ƒ â„“â‚„} â†’ ProofFocusLeft {â„“â‚} {â„“â‚‚} {â„“â‚ƒ} {â„“â‚„} (_â¦‰âŠ‘â¦Š_â‡°_ â„“â‚„) (_â¦‰âŠ‘â¦Š_â‡°_ â„“â‚„)
--   ProofFocusLeft[âŠ‘] = record { [focus-left_ğ‘œğ‘“_] = ProofMode[âŠ‘].[R-focus-left_ğ‘œğ‘“_] }
--   ProofFocusRight[âŠ‘] : âˆ€ {â„“â‚ â„“â‚‚ â„“â‚ƒ â„“â‚„} â†’ ProofFocusRight {â„“â‚} {â„“â‚‚} {â„“â‚ƒ} {â„“â‚„} (_â¦‰âŠ‘â¦Š_â‡°_ â„“â‚„) (_â¦‰âŠ‘â¦Š_â‡°_ â„“â‚„)
--   ProofFocusRight[âŠ‘] = record { [focus-right_ğ‘œğ‘“_] = ProofMode[âŠ‘].[R-focus-right_ğ‘œğ‘“_] }
-- 
-- instance
--   ProofMode[â‰ˆ] : âˆ€ {â„“} â†’ ProofMode {â„“} _â‰ˆ_ (_â¦‰â‰ˆâ¦Š_â‡°_ â„“)
--   ProofMode[â‰ˆ] = record { [proof-mode]_âˆ = ProofMode[â‰ˆ].[R-proof-mode]_âˆ }
--   ProofState[â‰ˆ] : âˆ€ {â„“â‚ â„“â‚‚} â†’ ProofState {â„“â‚} {â„“â‚‚} (_â¦‰â‰ˆâ¦Š_â‡°_ â„“â‚‚)
--   ProofState[â‰ˆ] = record { _â€£_ = ProofMode[â‰ˆ]._Râ€£_ ; [[_]] = ProofMode[â‰ˆ].[R][[_]]}
--   ProofStep[â‰ˆ] : âˆ€ {â„“â‚ â„“â‚‚} â†’ ProofStep {â„“â‚} {â„“â‚‚} _â‰ˆ_ (_â¦‰â‰ˆâ¦Š_â‡°_ â„“â‚‚)
--   ProofStep[â‰ˆ] = record { âŸ…_âŸ† = ProofMode[â‰ˆ].[R]âŸ…_âŸ† }
--   ProofStep[â‰ˆ-â‰¡] : âˆ€ {â„“â‚ â„“â‚‚} â†’ ProofStep {â„“â‚} {â„“â‚‚} _â‰¡_ (_â¦‰â‰ˆâ¦Š_â‡°_ â„“â‚‚)
--   ProofStep[â‰ˆ-â‰¡] = record { âŸ…_âŸ† = ProofMode[â‰ˆ].[R-â‰¡]âŸ…_âŸ† }
--   ProofFocusIn[â‰ˆ] : âˆ€ {â„“â‚ â„“â‚‚ â„“â‚ƒ} â†’ ProofFocusIn {â„“â‚} {â„“â‚‚} {â„“â‚ƒ} (_â¦‰â‰ˆâ¦Š_â‡°_ â„“â‚ƒ) (_â¦‰â‰ˆâ¦Š_â‡°_ â„“â‚ƒ)
--   ProofFocusIn[â‰ˆ] = record { [focus-in_] = ProofMode[â‰ˆ].[R-focus-in_] }
--   ProofFocusLeft[â‰ˆ] : âˆ€ {â„“â‚ â„“â‚‚ â„“â‚ƒ â„“â‚„} â†’ ProofFocusLeft {â„“â‚} {â„“â‚‚} {â„“â‚ƒ} {â„“â‚„} (_â¦‰â‰ˆâ¦Š_â‡°_ â„“â‚„) (_â¦‰â‰ˆâ¦Š_â‡°_ â„“â‚„)
--   ProofFocusLeft[â‰ˆ] = record { [focus-left_ğ‘œğ‘“_] = ProofMode[â‰ˆ].[R-focus-left_ğ‘œğ‘“_] }
--   ProofFocusRight[â‰ˆ] : âˆ€ {â„“â‚ â„“â‚‚ â„“â‚ƒ â„“â‚„} â†’ ProofFocusRight {â„“â‚} {â„“â‚‚} {â„“â‚ƒ} {â„“â‚„} (_â¦‰â‰ˆâ¦Š_â‡°_ â„“â‚„) (_â¦‰â‰ˆâ¦Š_â‡°_ â„“â‚„)
--   ProofFocusRight[â‰ˆ] = record { [focus-right_ğ‘œğ‘“_] = ProofMode[â‰ˆ].[R-focus-right_ğ‘œğ‘“_] }
-- 
-- instance
--   ProofMode[â‰¡] : âˆ€ {â„“} â†’ ProofMode {â„“} _â‰¡_ (_â¦‰â‰¡â¦Š_â‡°_ â„“)
--   ProofMode[â‰¡] = record { [proof-mode]_âˆ = ProofMode[â‰¡].[R-proof-mode]_âˆ }
--   ProofState[â‰¡] : âˆ€ {â„“â‚ â„“â‚‚} â†’ ProofState {â„“â‚} {â„“â‚‚} (_â¦‰â‰¡â¦Š_â‡°_ â„“â‚‚)
--   ProofState[â‰¡] = record { _â€£_ = ProofMode[â‰¡]._Râ€£_ ; [[_]] = ProofMode[â‰¡].[R][[_]]}
--   ProofStep[â‰¡] : âˆ€ {â„“â‚ â„“â‚‚} â†’ ProofStep {â„“â‚} {â„“â‚‚} _â‰¡_ (_â¦‰â‰¡â¦Š_â‡°_ â„“â‚‚)
--   ProofStep[â‰¡] = record { âŸ…_âŸ† = ProofMode[â‰¡].[R]âŸ…_âŸ† }
--   ProofFocusIn[â‰¡] : âˆ€ {â„“â‚ â„“â‚‚ â„“â‚ƒ} â†’ ProofFocusIn {â„“â‚} {â„“â‚‚} {â„“â‚ƒ} (_â¦‰â‰¡â¦Š_â‡°_ â„“â‚ƒ) (_â¦‰â‰¡â¦Š_â‡°_ â„“â‚ƒ)
--   ProofFocusIn[â‰¡] = record { [focus-in_] = ProofMode[â‰¡].[R-focus-in_] }
--   ProofFocusLeft[â‰¡] : âˆ€ {â„“â‚ â„“â‚‚ â„“â‚ƒ â„“â‚„} â†’ ProofFocusLeft {â„“â‚} {â„“â‚‚} {â„“â‚ƒ} {â„“â‚„} (_â¦‰â‰¡â¦Š_â‡°_ â„“â‚„) (_â¦‰â‰¡â¦Š_â‡°_ â„“â‚„)
--   ProofFocusLeft[â‰¡] = record { [focus-left_ğ‘œğ‘“_] = ProofMode[â‰¡].[R-focus-left_ğ‘œğ‘“_] }
--   ProofFocusRight[â‰¡] : âˆ€ {â„“â‚ â„“â‚‚ â„“â‚ƒ â„“â‚„} â†’ ProofFocusRight {â„“â‚} {â„“â‚‚} {â„“â‚ƒ} {â„“â‚„} (_â¦‰â‰¡â¦Š_â‡°_ â„“â‚„) (_â¦‰â‰¡â¦Š_â‡°_ â„“â‚„)
--   ProofFocusRight[â‰¡] = record { [focus-right_ğ‘œğ‘“_] = ProofMode[â‰¡].[R-focus-right_ğ‘œğ‘“_] }
