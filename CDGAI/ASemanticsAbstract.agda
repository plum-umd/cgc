module CDGAI.ASemanticsAbstract where

open import Prelude
open import Poset
open import CDGAI.ASyntax
open import CDGAI.ASemantics
open import CDGAI.EnvAbstraction
open import CDGAI.ZAbstraction

âŸ¦_âŸ§áµƒâ™¯ : âˆ€ {Î“} â†’ aexp Î“ â†’ âŸª â‡§ (envâ™¯ Î“) â†— â„¤â™¯ âŸ«
âŸ¦ Num n âŸ§áµƒâ™¯            = constâ™® â‹… (Î·á¶œ[ â‡„â„¤â‡„ ] â‹… â™® n)
âŸ¦ Var x âŸ§áµƒâ™¯            = lookupâ™¯[ x ]
âŸ¦ âŠ¤â„¤ âŸ§áµƒâ™¯               = constâ™® â‹… âŠ¤â„¤â™¯
âŸ¦ Unary[ o ] e âŸ§áµƒâ™¯     = âŸ¦ o âŸ§áµƒÂ¹â™¯ âˆ˜â™® âŸ¦ e âŸ§áµƒâ™¯
âŸ¦ Binary[ o ] eâ‚ eâ‚‚ âŸ§áµƒâ™¯ = uncurryâ™® â‹… âŸ¦ o âŸ§áµƒÂ²â™¯ âˆ˜â™® applyâ¸¢âˆ§â™®â¸£ â‹… âŸ¨ âŸ¦ eâ‚ âŸ§áµƒâ™¯ ,â™® âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ âŸ© âˆ˜â™® splitâ™®

Î±[âŸ¦âŸ§áµƒ] : âˆ€ {Î“} (e : aexp Î“) â†’ Î±[ â‡„envâ‡„ â†—â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] â‹… âŸ¦ e âŸ§áµƒâ™® âŠ‘â™® pure â‹… âŸ¦ e âŸ§áµƒâ™¯
Î±[âŸ¦âŸ§áµƒ] (Num n) = ext[â†—]â¸¢âŠ‘â¸£ $ Î» {Ï} â†’ let open ProofMode[âŠ‘] in [proof-mode]
  do [[ (Î±[ â‡„envâ‡„ â†—â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] â‹… âŸ¦ Num n âŸ§áµƒâ™®) â‹… Ï ]]
   â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ âŸ¦ Num n âŸ§áµƒâ™® âŸ Î³á¶œ[ â‡„envâ‡„ ]) â‹… Ï ]]
   â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) *â™® â‹… (âŸ¦ Num n âŸ§áµƒâ™® *â™® â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï)) ]]
   â€£ [focus-right [â‹…] ğ‘œğ‘“ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) *â™® ] begin
       do [[ (âŸ¦ Num n âŸ§áµƒâ™® *â™® â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï)) ]]
        â€£ âŸ… ğ’âŸ¦NumâŸ§â¸¢âŠ‘â¸£ âŸ†â¸¢âŠ‘â¸£
        â€£ [[ returnâ™® â‹… â™® n ]]
       end
   â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) *â™® â‹… (returnâ™® â‹… â™® n) ]]
   â€£ âŸ… right-unit[*] âŸ†â¸¢â‰ˆâ¸£
   â€£ [[ pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] â‹… â™® n ]]
   â€£ [[ pure â‹… (constâ™® â‹… (Î·á¶œ[ â‡„â„¤â‡„ ] â‹… â™® n)) â‹… Ï ]]
   â€£ [[ pure â‹… âŸ¦ Num n âŸ§áµƒâ™¯ â‹… Ï ]]
   âˆ 
Î±[âŸ¦âŸ§áµƒ] (Var x) = let open ProofMode[âŠ‘] in [proof-mode]
  do [[ Î±[ â‡„envâ‡„ â†—â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] â‹… âŸ¦ Var x âŸ§áµƒâ™® ]]
   â€£ [[ pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ âŸ¦ Var x âŸ§áµƒâ™® âŸ Î³á¶œ[ â‡„envâ‡„ ] ]]
   â€£ [focus-right [âŸ] ğ‘œğ‘“ pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] ] begin
       do [focus-left [âŸ] ğ‘œğ‘“ Î³á¶œ[ â‡„envâ‡„ ] ] begin
            do [[ âŸ¦ Var x âŸ§áµƒâ™® ]]
             â€£ âŸ… ğ’âŸ¦VarâŸ§â¸¢âˆ˜â™®â¸£ âŸ†â¸¢â‰ˆâ¸£
             â€£ [[ pure â‹… lookupâ™®[ x ] ]]
            end
        â€£ [[ pure â‹… lookupâ™®[ x ] âŸ Î³á¶œ[ â‡„envâ‡„ ] ]]
        â€£ âŸ… Ï€â‚ Î³Î³á¶œ[ â‡„envâ‡„ , â‡„â„¤â‡„ ] $ Î±[lookup] {x = x} âŸ†
        â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… lookupâ™¯[ x ] ]]
       end
   â€£ [[ pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… lookupâ™¯[ x ] ]]
   â€£ âŸ… â—‡ associative[âŸ] âŸ†â¸¢â‰ˆâ¸£
   â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ Î³á¶œ[ â‡„â„¤â‡„ ]) âŸ pure â‹… lookupâ™¯[ x ] ]]
   â€£ âŸ… left-unit-reductive[âŸ]á¶œ[ â‡„â„¤â‡„ ] âŸ†
   â€£ [[ pure â‹… lookupâ™¯[ x ] ]]
   â€£ [[ pure â‹… âŸ¦ Var x âŸ§áµƒâ™¯ ]]
   âˆ 
Î±[âŸ¦âŸ§áµƒ] âŠ¤â„¤ = ext[â†—]â¸¢âŠ‘â¸£ $ Î» {Ï} â†’ let open ProofMode[âŠ‘] in [proof-mode]
  do [[ (Î±[ â‡„envâ‡„ â†—â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] â‹… âŸ¦ âŠ¤â„¤ âŸ§áµƒâ™®) â‹… Ï ]]
   â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ âŸ¦ âŠ¤â„¤ âŸ§áµƒâ™® âŸ Î³á¶œ[ â‡„envâ‡„ ]) â‹… Ï ]]
   â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) *â™® â‹… (âŸ¦ âŠ¤â„¤ âŸ§áµƒâ™® *â™® â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï)) ]]
   â€£ [focus-right [â‹…] ğ‘œğ‘“ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) *â™® ] begin
       do [[ (âŸ¦ âŠ¤â„¤ âŸ§áµƒâ™® *â™® â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï)) ]]
        â€£ âŸ… ğ’âŸ¦âŠ¤â„¤âŸ§â¸¢âŠ‘â¸£ âŸ†
        â€£ [[ allâ™® (â‡§ â„¤) ]]
       end
   â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) *â™® â‹… allâ™® (â‡§ â„¤) ]]
   â€£ âŸ… Î·[âŠ¤â„¤] âŸ†
   â€£ [[ returnâ™® â‹… âŠ¤â„¤â™¯ ]]
   â€£ [[ pure â‹… âŸ¦ âŠ¤â„¤ âŸ§áµƒâ™¯ â‹… Ï ]]
   âˆ 
Î±[âŸ¦âŸ§áµƒ] (Unary[ o ] e) with Î±[âŸ¦âŸ§áµƒ] e
... | IH = let open ProofMode[âŠ‘] in [proof-mode]
  do [[ Î±[ â‡„envâ‡„ â†—â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] â‹… âŸ¦ Unary[ o ] e âŸ§áµƒâ™® ]]
   â€£ [[ pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ âŸ¦ Unary[ o ] e âŸ§áµƒâ™® âŸ Î³á¶œ[ â‡„envâ‡„ ] ]]
   â€£ [focus-right [âŸ] ğ‘œğ‘“ pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] ] begin
       do [focus-left [âŸ] ğ‘œğ‘“ Î³á¶œ[ â‡„envâ‡„ ] ] begin
            do [[ âŸ¦ Unary[ o ] e âŸ§áµƒâ™® ]]
             â€£ âŸ… ğ’âŸ¦UnaryâŸ§â¸¢âŸâ¸£ âŸ†â¸¢â‰ˆâ¸£
             â€£ [[ pure â‹… âŸ¦ o âŸ§áµƒÂ¹â™® âŸ âŸ¦ e âŸ§áµƒâ™® ]]
            end
        â€£ [[ (pure â‹… âŸ¦ o âŸ§áµƒÂ¹â™® âŸ âŸ¦ e âŸ§áµƒâ™®) âŸ Î³á¶œ[ â‡„envâ‡„ ] ]]
        â€£ âŸ… associative[âŸ] âŸ†â¸¢â‰ˆâ¸£
        â€£ [[ pure â‹… âŸ¦ o âŸ§áµƒÂ¹â™® âŸ âŸ¦ e âŸ§áµƒâ™® âŸ Î³á¶œ[ â‡„envâ‡„ ] ]]
        â€£ [focus-right [âŸ] ğ‘œğ‘“ pure â‹… âŸ¦ o âŸ§áµƒÂ¹â™® ] begin
            do [[ âŸ¦ e âŸ§áµƒâ™® âŸ Î³á¶œ[ â‡„envâ‡„ ] ]]
             â€£ âŸ… Ï€â‚ Î³Î³á¶œ[ â‡„envâ‡„ , â‡„â„¤â‡„ ] IH âŸ†
             â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… âŸ¦ e âŸ§áµƒâ™¯ ]]
            end
        â€£ [[ pure â‹… âŸ¦ o âŸ§áµƒÂ¹â™® âŸ Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… âŸ¦ e âŸ§áµƒâ™¯ ]]
        â€£ âŸ… â—‡ associative[âŸ] âŸ†â¸¢â‰ˆâ¸£
        â€£ [[ (pure â‹… âŸ¦ o âŸ§áµƒÂ¹â™® âŸ Î³á¶œ[ â‡„â„¤â‡„ ]) âŸ pure â‹… âŸ¦ e âŸ§áµƒâ™¯ ]]
        â€£ [focus-left [âŸ] ğ‘œğ‘“ pure â‹… âŸ¦ e âŸ§áµƒâ™¯ ] begin
            do [[ pure â‹… âŸ¦ o âŸ§áµƒÂ¹â™® âŸ Î³á¶œ[ â‡„â„¤â‡„ ] ]]
             â€£ âŸ… Ï€â‚ Î³Î³á¶œ[ â‡„â„¤â‡„ , â‡„â„¤â‡„ ] Î±[âŸ¦âŸ§áµƒÂ¹] âŸ†
             â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… âŸ¦ o âŸ§áµƒÂ¹â™¯ ]]
            end
        â€£ [[ (Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… âŸ¦ o âŸ§áµƒÂ¹â™¯) âŸ pure â‹… âŸ¦ e âŸ§áµƒâ™¯ ]]
        â€£ âŸ… associative[âŸ] âŸ†â¸¢â‰ˆâ¸£
        â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… âŸ¦ o âŸ§áµƒÂ¹â™¯ âŸ pure â‹… âŸ¦ e âŸ§áµƒâ™¯ ]]
       end
   â€£ [[ pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… âŸ¦ o âŸ§áµƒÂ¹â™¯ âŸ pure â‹… âŸ¦ e âŸ§áµƒâ™¯ ]]
   â€£ âŸ… â—‡ associative[âŸ] âŸ†â¸¢â‰ˆâ¸£
   â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ Î³á¶œ[ â‡„â„¤â‡„ ]) âŸ pure â‹… âŸ¦ o âŸ§áµƒÂ¹â™¯ âŸ pure â‹… âŸ¦ e âŸ§áµƒâ™¯ ]]
   â€£ âŸ… left-unit-reductive[âŸ]á¶œ[ â‡„â„¤â‡„ ] âŸ†
   â€£ [[ pure â‹… âŸ¦ o âŸ§áµƒÂ¹â™¯ âŸ pure â‹… âŸ¦ e âŸ§áµƒâ™¯ ]]
   â€£ âŸ… homomorphic[pure/âŸ] âŸ†â¸¢â‰ˆâ¸£
   â€£ [[ pure â‹… (âŸ¦ o âŸ§áµƒÂ¹â™¯ âˆ˜â™® âŸ¦ e âŸ§áµƒâ™¯) ]]
   â€£ [[ pure â‹… âŸ¦ Unary[ o ] e âŸ§áµƒâ™¯ ]]
   âˆ
Î±[âŸ¦âŸ§áµƒ] (Binary[ o ] eâ‚ eâ‚‚) with Î±[âŸ¦âŸ§áµƒ] eâ‚ | Î±[âŸ¦âŸ§áµƒ] eâ‚‚
... | IHâ‚ | IHâ‚‚ = ext[â†—]â¸¢âŠ‘â¸£ $ Î» {Ï} â†’ let open ProofMode[âŠ‘] in [proof-mode]
  do [[ (Î±[ â‡„envâ‡„ â†—â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] â‹… âŸ¦ Binary[ o ] eâ‚ eâ‚‚ âŸ§áµƒâ™®) â‹… Ï ]]
   â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ âŸ¦ Binary[ o ] eâ‚ eâ‚‚ âŸ§áµƒâ™® âŸ Î³á¶œ[ â‡„envâ‡„ ]) â‹… Ï ]]
   â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) *â™® â‹… (âŸ¦ Binary[ o ] eâ‚ eâ‚‚ âŸ§áµƒâ™® *â™® â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï)) ]]
   â€£ [focus-right [â‹…] ğ‘œğ‘“ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) *â™® ] begin
       do [[ âŸ¦ Binary[ o ] eâ‚ eâ‚‚ âŸ§áµƒâ™® *â™® â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) ]]
        â€£ âŸ… ğ’âŸ¦BinaryâŸ§â¸¢*â¸£â¸¢âŠ‘â¸£ âŸ†
        â€£ [[ (uncurryâ™® â‹… âŸ¦ o âŸ§áµƒÂ²â™®) *â™® â‹… (Î³â¸¢IAâ¸£ â‹… âŸ¨ âŸ¦ eâ‚ âŸ§áµƒâ™® *â™® â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) ,â™® âŸ¦ eâ‚‚ âŸ§áµƒâ™® *â™® â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) âŸ©) ]]
        â€£ [focus-right [â‹…] ğ‘œğ‘“ (uncurryâ™® â‹… âŸ¦ o âŸ§áµƒÂ²â™®) *â™® ] begin
            do [focus-right [â‹…] ğ‘œğ‘“ Î³â¸¢IAâ¸£ ] begin
                 do [[ âŸ¨ âŸ¦ eâ‚ âŸ§áµƒâ™® *â™® â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) ,â™® âŸ¦ eâ‚‚ âŸ§áµƒâ™® *â™® â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) âŸ© ]]
                  â€£ [focus-left [,] ğ‘œğ‘“ âŸ¦ eâ‚‚ âŸ§áµƒâ™® *â™® â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) ] begin
                      do [[ âŸ¦ eâ‚ âŸ§áµƒâ™® *â™® â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) ]]
                       â€£ âŸ… Ï€â‚ Î³Î³á¶œ[*][ â‡„envâ‡„ , â‡„â„¤â‡„ ] IHâ‚ âŸ†
                       â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] *â™® â‹… (pure â‹… âŸ¦ eâ‚ âŸ§áµƒâ™¯ â‹… Ï) ]]
                       end
                  â€£ [[ âŸ¨ Î³á¶œ[ â‡„â„¤â‡„ ] *â™® â‹… (pure â‹… âŸ¦ eâ‚ âŸ§áµƒâ™¯ â‹… Ï) ,â™® âŸ¦ eâ‚‚ âŸ§áµƒâ™® *â™® â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) âŸ© ]]
                  â€£ [focus-right [,] ğ‘œğ‘“ Î³á¶œ[ â‡„â„¤â‡„ ] *â™® â‹… (pure â‹… âŸ¦ eâ‚ âŸ§áµƒâ™¯ â‹… Ï) ] begin
                      do [[ âŸ¦ eâ‚‚ âŸ§áµƒâ™® *â™® â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) ]]
                       â€£ âŸ… Ï€â‚ Î³Î³á¶œ[*][ â‡„envâ‡„ , â‡„â„¤â‡„ ] IHâ‚‚ âŸ†
                       â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] *â™® â‹… (pure â‹… âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ â‹… Ï) ]]
                      end
                  â€£ [[ âŸ¨ Î³á¶œ[ â‡„â„¤â‡„ ] *â™® â‹… (pure â‹… âŸ¦ eâ‚ âŸ§áµƒâ™¯ â‹… Ï) ,â™® Î³á¶œ[ â‡„â„¤â‡„ ] *â™® â‹… (pure â‹… âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ â‹… Ï) âŸ© ]]
                 end
             â€£ [[ Î³â¸¢IAâ¸£ â‹… âŸ¨ Î³á¶œ[ â‡„â„¤â‡„ ] *â™® â‹… (pure â‹… âŸ¦ eâ‚ âŸ§áµƒâ™¯ â‹… Ï) ,â™® Î³á¶œ[ â‡„â„¤â‡„ ] *â™® â‹… (pure â‹… âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ â‹… Ï) âŸ© ]]
             â€£ âŸ… homomorphic[Î³Î³]â¸¢IAâ¸£[ â‡„â„¤â‡„ , â‡„â„¤â‡„ ] âŸ†â¸¢â‰ˆâ¸£
             â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ âˆ§â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] *â™® â‹… (Î³â¸¢IAâ¸£ â‹… âŸ¨ pure â‹… âŸ¦ eâ‚ âŸ§áµƒâ™¯ â‹… Ï ,â™® pure â‹… âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ â‹… Ï âŸ©) ]]
             â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ âˆ§â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] *â™® â‹… (Î³â¸¢IAâ¸£ â‹… âŸ¨ returnâ™® â‹… (âŸ¦ eâ‚ âŸ§áµƒâ™¯ â‹… Ï) ,â™® returnâ™® â‹… (âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ â‹… Ï) âŸ©) ]]
             â€£ [focus-right [â‹…] ğ‘œğ‘“ Î³á¶œ[ â‡„â„¤â‡„ âˆ§â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] *â™® ] begin
                 do [[ Î³â¸¢IAâ¸£ â‹… âŸ¨ returnâ™® â‹… (âŸ¦ eâ‚ âŸ§áµƒâ™¯ â‹… Ï) ,â™® returnâ™® â‹… (âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ â‹… Ï) âŸ© ]]
                  â€£ âŸ… homomorphic[Î³return]â¸¢IAâ¸£ âŸ†â¸¢â‰ˆâ¸£
                  â€£ [[ returnâ™® â‹… âŸ¨ âŸ¦ eâ‚ âŸ§áµƒâ™¯ â‹… Ï ,â™® âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ â‹… Ï âŸ© ]]
                 end
             â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ âˆ§â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] *â™® â‹… (returnâ™® â‹… âŸ¨ âŸ¦ eâ‚ âŸ§áµƒâ™¯ â‹… Ï ,â™® âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ â‹… Ï âŸ©) ]]
            end
        â€£ [[ (uncurryâ™® â‹… âŸ¦ o âŸ§áµƒÂ²â™®) *â™® â‹… (Î³á¶œ[ â‡„â„¤â‡„ âˆ§â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] *â™® â‹… (returnâ™® â‹… âŸ¨ âŸ¦ eâ‚ âŸ§áµƒâ™¯ â‹… Ï ,â™® âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ â‹… Ï âŸ©)) ]]
        â€£ âŸ… Ï€â‚ Î³Î³á¶œ[â‹…][ â‡„â„¤â‡„ âˆ§â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ , â‡„â„¤â‡„ ] Î±[âŸ¦âŸ§áµƒÂ²] âŸ†
        â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] *â™® â‹… ((pure â‹… (uncurryâ™® â‹… âŸ¦ o âŸ§áµƒÂ²â™¯)) *â™® â‹… (returnâ™® â‹… âŸ¨ âŸ¦ eâ‚ âŸ§áµƒâ™¯ â‹… Ï ,â™® âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ â‹… Ï âŸ©)) ]]
       end
   â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) *â™® â‹… (Î³á¶œ[ â‡„â„¤â‡„ ] *â™® â‹… ((pure â‹… (uncurryâ™® â‹… âŸ¦ o âŸ§áµƒÂ²â™¯)) *â™® â‹… (returnâ™® â‹… âŸ¨ âŸ¦ eâ‚ âŸ§áµƒâ™¯ â‹… Ï ,â™® âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ â‹… Ï âŸ©))) ]]
   â€£ âŸ… reductiveá¶œ[â‹…][ â‡„â„¤â‡„ ] âŸ†
   â€£ [[ (pure â‹… (uncurryâ™® â‹… âŸ¦ o âŸ§áµƒÂ²â™¯)) *â™® â‹… (returnâ™® â‹… âŸ¨ âŸ¦ eâ‚ âŸ§áµƒâ™¯ â‹… Ï ,â™® âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ â‹… Ï âŸ©) ]]
   â€£ âŸ… right-unit[*] âŸ†â¸¢â‰ˆâ¸£
   â€£ [[ pure â‹… (uncurryâ™® â‹… âŸ¦ o âŸ§áµƒÂ²â™¯) â‹… âŸ¨ âŸ¦ eâ‚ âŸ§áµƒâ™¯ â‹… Ï ,â™® âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ â‹… Ï âŸ© ]]
   â€£ [[ pure â‹… (uncurryâ™® â‹… âŸ¦ o âŸ§áµƒÂ²â™¯) â‹… ((applyâ¸¢âˆ§â™®â¸£ â‹… âŸ¨ âŸ¦ eâ‚ âŸ§áµƒâ™¯ ,â™® âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ âŸ©  âˆ˜â™® splitâ™®) â‹… Ï) ]]
   â€£ âŸ… â—‡ $ homomorphic[pure] {g = (uncurryâ™® â‹… âŸ¦ o âŸ§áµƒÂ²â™¯)} {f = applyâ¸¢âˆ§â™®â¸£ â‹… âŸ¨ âŸ¦ eâ‚ âŸ§áµƒâ™¯ ,â™® âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ âŸ© âˆ˜â™® splitâ™®} âŸ†â¸¢â‰ˆâ¸£
   â€£ [[ pure â‹… (uncurryâ™® â‹… âŸ¦ o âŸ§áµƒÂ²â™¯ âˆ˜â™® applyâ¸¢âˆ§â™®â¸£ â‹… âŸ¨ âŸ¦ eâ‚ âŸ§áµƒâ™¯ ,â™® âŸ¦ eâ‚‚ âŸ§áµƒâ™¯ âŸ© âˆ˜â™® splitâ™®) â‹… Ï ]]
   â€£ [[ pure â‹… âŸ¦ Binary[ o ] eâ‚ eâ‚‚ âŸ§áµƒâ™¯ â‹… Ï ]]
   âˆ
