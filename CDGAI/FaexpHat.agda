module CDGAI.FaexpHat where

open import Prelude
open import OSet
open import CDGAI.Syntax
open import CDGAI.Semantics
open import CDGAI.EnvHat

module Â§-Faexp^
  (â„¤^ : POSet zeroË¡)
  (â‡„â„¤â‡„ : â‡§ â„¤ Î·â‡„Î³ â„¤^)
  (âŠ¤â„¤^ : âŸª â„¤^ âŸ«)
  (Î·[âŠ¤â„¤] : (pure â‹… Î·[ â‡„â„¤â‡„ ]) * â‹… all (â‡§ â„¤) âŠ‘ return â‹… âŠ¤â„¤^)
  (â†‘âŸ¦_âŸ§áµ˜^ : unary â†’ âŸª â„¤^ â‡’ â„¤^ âŸ«)
  (Î±[âŸ¦âŸ§áµ˜] : âˆ€ {o} â†’ Î±[ â‡„â„¤â‡„ â‡’â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„ ] â‹… (pure â‹… â†‘âŸ¦ o âŸ§áµ˜) âŠ‘ pure â‹… â†‘âŸ¦ o âŸ§áµ˜^)
  (â†‘âŸ¦_âŸ§áµ‡^ : binary â†’ âŸª â„¤^ â‡’ â„¤^ â‡’ â„¤^ âŸ«)
  (Î±[âŸ¦âŸ§áµ‡] : âˆ€ {o} â†’ Î±[ (â‡„â„¤â‡„ Ã—â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„) â‡’â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„ ] â‹… (â†‘uncurry â‹… â†‘âŸ¦ o âŸ§áµ‡) âŠ‘ pure â‹… (â†‘uncurry â‹… â†‘âŸ¦ o âŸ§áµ‡^))
  where
  open Â§-env^ â„¤^ â‡„â„¤â‡„
  âˆƒÎ±[Faexp] :
    âˆƒ Faexp^[_] â¦‚ (âˆ€ {Î“} â†’ aexp Î“ â†’ âŸª â‡§ (env^ Î“) â‡’ â„¤^ âŸ«)
    ğ‘ ğ‘¡ (âˆ€ {Î“} (e : aexp Î“) â†’ Î±[ â‡„envâ‡„ â‡’â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„ ] â‹… Faexp[ e ] âŠ‘ pure â‹… Faexp^[ e ])
  âˆƒÎ±[Faexp] = âˆƒ Faexp^[_] ,, Î±[Faexp]
    where
      Faexp^[_] : âˆ€ {Î“} â†’ aexp Î“ â†’ âŸª â‡§ (env^ Î“) â‡’ â„¤^ âŸ«
      Faexp^[ Num n ]             = â†‘const â‹… (Î·[ â‡„â„¤â‡„ ] â‹… â†‘ n)
      Faexp^[ Var x ]             = â†‘lookup^[ x ]
      Faexp^[ âŠ¤â„¤ ]                = â†‘const â‹… âŠ¤â„¤^
      Faexp^[ Unary[ o ] e ]      = â†‘âŸ¦ o âŸ§áµ˜^ âŠ™ Faexp^[ e ]
      Faexp^[ Binary[ o ] eâ‚ eâ‚‚ ] = â†‘uncurry â‹… â†‘âŸ¦ o âŸ§áµ‡^ âŠ™ â†‘applyâ¸¢Ã—â¸£ â‹… (Faexp^[ eâ‚ ] âŸ¨,âŸ© Faexp^[ eâ‚‚ ]) âŠ™ â†‘split
      Î±[Faexp] : âˆ€ {Î“} (e : aexp Î“) â†’ Î±[ â‡„envâ‡„ â‡’â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„ ] â‹… Faexp[ e ] âŠ‘ pure â‹… Faexp^[ e ]
      Î±[Faexp] (Num n) = ext[Î»]â¸¢âŠ‘â¸£ $ Î» {Ï} â†’ [âŠ‘-proof-mode]
        do [âŠ‘][[ (Î±[ â‡„envâ‡„ â‡’â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„ ] â‹… Faexp[ Num n ]) â‹… Ï ]]
        âŠ‘â€£ [âŠ‘-â‰¡] (pure â‹… Î·[ â‡„â„¤â‡„ ] âŸ Faexp[ Num n ] âŸ Î³â¸¢Î·â¸£[ â‡„envâ‡„ ]) â‹… Ï âŸ… â†¯ âŸ†
        âŠ‘â€£ [âŠ‘-â‰¡] (pure â‹… Î·[ â‡„â„¤â‡„ ]) * â‹… (Faexp[ Num n ] * â‹… (Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] â‹… Ï)) âŸ… â†¯ âŸ†
        âŠ‘â€£ [âŠ‘-focus-right [â‹…] ğ‘œğ‘“ (pure â‹… Î·[ â‡„â„¤â‡„ ]) * ] [âŠ‘] return â‹… â†‘ n âŸ… Î²-Faexp[Num]â¸¢âŠ‘â¸£ âŸ†
        âŠ‘â€£ [âŠ‘][[ (pure â‹… Î·[ â‡„â„¤â‡„ ]) * â‹… (return â‹… â†‘ n) ]]
        âŠ‘â€£ [âŠ‘-â‰ˆ] pure â‹… Î·[ â‡„â„¤â‡„ ] â‹… â†‘ n âŸ… right-unit[*] âŸ†
        âŠ‘â€£ [âŠ‘-â‰¡] pure â‹… (â†‘const â‹… (Î·[ â‡„â„¤â‡„ ] â‹… â†‘ n)) â‹… Ï âŸ… â†¯ âŸ†
        âŠ‘â€£ [âŠ‘-â‰¡] pure â‹… Faexp^[ Num n ] â‹… Ï âŸ… â†¯ âŸ†
        â¬œ 
      Î±[Faexp] (Var x) = [âŠ‘-proof-mode]
        do [âŠ‘][[ Î±[ â‡„envâ‡„ â‡’â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„ ] â‹… Faexp[ Var x ] ]]
        âŠ‘â€£ [âŠ‘-â‰¡] pure â‹… Î·[ â‡„â„¤â‡„ ] âŸ Faexp[ Var x ] âŸ Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] âŸ… â†¯ âŸ†
        âŠ‘â€£ [âŠ‘-focus-right [âŸ] ğ‘œğ‘“ pure â‹… Î·[ â‡„â„¤â‡„ ] ] begin
             do [âŠ‘-focus-left [âŸ] ğ‘œğ‘“ Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] ] begin
                  do [âŠ‘][[ Faexp[ Var x ] ]]
                  âŠ‘â€£ [âŠ‘-â‰ˆ] pure â‹… â†‘lookup[ x ] âŸ… Î²-Faexp[Var]â¸¢âŠ™â¸£ âŸ†
                  end
             âŠ‘â€£ [âŠ‘][[ pure â‹… â†‘lookup[ x ] âŸ Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] ]]
             âŠ‘â€£ [âŠ‘] Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] âŸ pure â‹… â†‘lookup^[ x ] âŸ… Ï€â‚ Î±[f]âŠ‘f^[ â‡„envâ‡„ , â‡„â„¤â‡„ ]â¸¢Î³â¸£ $ Î±[lookup] {x = x} âŸ†
             end
        âŠ‘â€£ [âŠ‘][[ pure â‹… Î·[ â‡„â„¤â‡„ ] âŸ Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] âŸ pure â‹… â†‘lookup^[ x ] ]]
        âŠ‘â€£ [âŠ‘] pure â‹… â†‘lookup^[ x ] âŸ… left-unit[âŸ]â¸¢contractiveâ¸¢Î·â¸£â¸£[ â‡„â„¤â‡„ ] âŸ†
        âŠ‘â€£ [âŠ‘-â‰¡] pure â‹… Faexp^[ Var x ] âŸ… â†¯ âŸ†
        â¬œ 
      Î±[Faexp] âŠ¤â„¤ = ext[Î»]â¸¢âŠ‘â¸£ $ Î» {Ï} â†’ [âŠ‘-proof-mode]
        do [âŠ‘][[ (Î±[ â‡„envâ‡„ â‡’â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„ ] â‹… Faexp[ âŠ¤â„¤ ]) â‹… Ï ]]
        âŠ‘â€£ [âŠ‘-â‰¡] (pure â‹… Î·[ â‡„â„¤â‡„ ] âŸ Faexp[ âŠ¤â„¤ ] âŸ Î³â¸¢Î·â¸£[ â‡„envâ‡„ ]) â‹… Ï âŸ… â†¯ âŸ†
        âŠ‘â€£ [âŠ‘-â‰¡] (pure â‹… Î·[ â‡„â„¤â‡„ ]) * â‹… (Faexp[ âŠ¤â„¤ ] * â‹… (Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] â‹… Ï)) âŸ… â†¯ âŸ†
        âŠ‘â€£ [âŠ‘-focus-right [â‹…] ğ‘œğ‘“ (pure â‹… Î·[ â‡„â„¤â‡„ ]) * ] [âŠ‘] all (â‡§ â„¤) âŸ… Î²-Faexp[âŠ¤â„¤]â¸¢âŠ‘â¸£ âŸ†
        âŠ‘â€£ [âŠ‘][[ (pure â‹… Î·[ â‡„â„¤â‡„ ]) * â‹… all (â‡§ â„¤) ]]
        âŠ‘â€£ [âŠ‘] return â‹… âŠ¤â„¤^ âŸ… Î·[âŠ¤â„¤] âŸ†
        âŠ‘â€£ [âŠ‘-â‰¡] pure â‹… Faexp^[ âŠ¤â„¤ ] â‹… Ï âŸ… â†¯ âŸ†
        â¬œ 
      Î±[Faexp] (Unary[ o ] e) with Î±[Faexp] e
      ... | IH = [âŠ‘-proof-mode]
        do [âŠ‘][[ Î±[ â‡„envâ‡„ â‡’â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„ ] â‹… Faexp[ Unary[ o ] e ] ]]
        âŠ‘â€£ [âŠ‘-â‰¡] pure â‹… Î·[ â‡„â„¤â‡„ ] âŸ Faexp[ Unary[ o ] e ] âŸ Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] âŸ… â†¯ âŸ†
        âŠ‘â€£ [âŠ‘-focus-right [âŸ] ğ‘œğ‘“ pure â‹… Î·[ â‡„â„¤â‡„ ] ] begin
             do [âŠ‘-focus-left [âŸ] ğ‘œğ‘“ Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] ] [âŠ‘-â‰ˆ] pure â‹… â†‘âŸ¦ o âŸ§áµ˜ âŸ Faexp[ e ] âŸ… Î²-Faexp[Unary]â¸¢âŸâ¸£ âŸ†
             âŠ‘â€£ [âŠ‘][[ (pure â‹… â†‘âŸ¦ o âŸ§áµ˜ âŸ Faexp[ e ]) âŸ Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] ]]
             âŠ‘â€£ [âŠ‘-â‰ˆ] pure â‹… â†‘âŸ¦ o âŸ§áµ˜ âŸ Faexp[ e ] âŸ Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] âŸ… associative[âŸ] âŸ†
             âŠ‘â€£ [âŠ‘-focus-right [âŸ] ğ‘œğ‘“ pure â‹… â†‘âŸ¦ o âŸ§áµ˜ ] [âŠ‘] Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] âŸ pure â‹… Faexp^[ e ] âŸ… Ï€â‚ Î±[f]âŠ‘f^[ â‡„envâ‡„ , â‡„â„¤â‡„ ]â¸¢Î³â¸£ IH âŸ†
             âŠ‘â€£ [âŠ‘][[ pure â‹… â†‘âŸ¦ o âŸ§áµ˜ âŸ Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] âŸ pure â‹… Faexp^[ e ] ]]
             âŠ‘â€£ [âŠ‘-â‰ˆ] (pure â‹… â†‘âŸ¦ o âŸ§áµ˜ âŸ Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ]) âŸ pure â‹… Faexp^[ e ] âŸ… â—‡ associative[âŸ] âŸ†
             âŠ‘â€£ [âŠ‘-focus-left [âŸ] ğ‘œğ‘“ pure â‹… Faexp^[ e ] ] [âŠ‘] Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] âŸ pure â‹… â†‘âŸ¦ o âŸ§áµ˜^ âŸ… Ï€â‚ Î±[f]âŠ‘f^[ â‡„â„¤â‡„ , â‡„â„¤â‡„ ]â¸¢Î³â¸£ Î±[âŸ¦âŸ§áµ˜] âŸ†
             âŠ‘â€£ [âŠ‘][[ (Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] âŸ pure â‹… â†‘âŸ¦ o âŸ§áµ˜^) âŸ pure â‹… Faexp^[ e ] ]]
             âŠ‘â€£ [âŠ‘-â‰ˆ] Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] âŸ pure â‹… â†‘âŸ¦ o âŸ§áµ˜^ âŸ pure â‹… Faexp^[ e ] âŸ… associative[âŸ] âŸ†
             end
        âŠ‘â€£ [âŠ‘][[ pure â‹… Î·[ â‡„â„¤â‡„ ] âŸ Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] âŸ pure â‹… â†‘âŸ¦ o âŸ§áµ˜^ âŸ pure â‹… Faexp^[ e ] ]]
        âŠ‘â€£ [âŠ‘] pure â‹… â†‘âŸ¦ o âŸ§áµ˜^ âŸ pure â‹… Faexp^[ e ] âŸ… left-unit[âŸ]â¸¢contractiveâ¸¢Î·â¸£â¸£[ â‡„â„¤â‡„ ] âŸ†
        âŠ‘â€£ [âŠ‘-â‰ˆ] pure â‹… (â†‘âŸ¦ o âŸ§áµ˜^ âŠ™ Faexp^[ e ]) âŸ… homomorphic[âŸ]â¸¢pureâ¸£ âŸ†
        âŠ‘â€£ [âŠ‘-â‰¡] pure â‹… Faexp^[ Unary[ o ] e ] âŸ… â†¯ âŸ†
        â¬œ
      Î±[Faexp] (Binary[ o ] eâ‚ eâ‚‚) with Î±[Faexp] eâ‚ | Î±[Faexp] eâ‚‚
      ... | IHâ‚ | IHâ‚‚ = ext[Î»]â¸¢âŠ‘â¸£ $ Î» {Ï} â†’ [âŠ‘-proof-mode]
        do [âŠ‘][[ (Î±[ â‡„envâ‡„ â‡’â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„ ] â‹… Faexp[ Binary[ o ] eâ‚ eâ‚‚ ]) â‹… Ï ]]
        âŠ‘â€£ [âŠ‘-â‰¡] (pure â‹… Î·[ â‡„â„¤â‡„ ] âŸ Faexp[ Binary[ o ] eâ‚ eâ‚‚ ] âŸ Î³â¸¢Î·â¸£[ â‡„envâ‡„ ]) â‹… Ï âŸ… â†¯ âŸ†
        âŠ‘â€£ [âŠ‘-â‰¡] (pure â‹… Î·[ â‡„â„¤â‡„ ]) * â‹… (Faexp[ Binary[ o ] eâ‚ eâ‚‚ ] * â‹… (Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] â‹… Ï)) âŸ… â†¯ âŸ†
        âŠ‘â€£ [âŠ‘-focus-right [â‹…] ğ‘œğ‘“ (pure â‹… Î·[ â‡„â„¤â‡„ ]) * ] begin
             do [âŠ‘][[ Faexp[ Binary[ o ] eâ‚ eâ‚‚ ] * â‹… (Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] â‹… Ï) ]]
             âŠ‘â€£ [âŠ‘] (â†‘uncurry â‹… â†‘âŸ¦ o âŸ§áµ‡) * â‹… (Î³â¸¢IAâ¸£ â‹… (Faexp[ eâ‚ ] * â‹… (Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] â‹… Ï) âŸ¨,âŸ© Faexp[ eâ‚‚ ] * â‹… (Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] â‹… Ï))) âŸ… Î²-Faexp[Binary]â¸¢*â¸£â¸¢âŠ‘â¸£ âŸ†
             âŠ‘â€£ [âŠ‘-focus-right [â‹…] ğ‘œğ‘“ (â†‘uncurry â‹… â†‘âŸ¦ o âŸ§áµ‡) * ] begin
                  do [âŠ‘-focus-right [â‹…] ğ‘œğ‘“ Î³â¸¢IAâ¸£ ] begin
                       do [âŠ‘][[ Faexp[ eâ‚ ] * â‹… (Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] â‹… Ï) âŸ¨,âŸ© Faexp[ eâ‚‚ ] * â‹… (Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] â‹… Ï) ]]
                       âŠ‘â€£ [âŠ‘-focus-left [,] ğ‘œğ‘“ Faexp[ eâ‚‚ ] * â‹… (Î³â¸¢Î·â¸£[ â‡„envâ‡„ ] â‹… Ï) ] [âŠ‘] Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] * â‹… (pure â‹… Faexp^[ eâ‚ ] â‹… Ï) âŸ… Ï€â‚ Î±[f]âŠ‘f^[ â‡„envâ‡„ , â‡„â„¤â‡„ ]â¸¢Î³*â¸£ IHâ‚ âŸ†
                       âŠ‘â€£ [âŠ‘-focus-right [,] ğ‘œğ‘“ Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] * â‹… (pure â‹… Faexp^[ eâ‚ ] â‹… Ï) ] [âŠ‘] Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] * â‹… (pure â‹… Faexp^[ eâ‚‚ ] â‹… Ï) âŸ… Ï€â‚ Î±[f]âŠ‘f^[ â‡„envâ‡„ , â‡„â„¤â‡„ ]â¸¢Î³*â¸£ IHâ‚‚ âŸ†
                       âŠ‘â€£ [âŠ‘][[ Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] * â‹… (pure â‹… Faexp^[ eâ‚ ] â‹… Ï) âŸ¨,âŸ© Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] * â‹… (pure â‹… Faexp^[ eâ‚‚ ] â‹… Ï) ]]
                       end
                  âŠ‘â€£ [âŠ‘][[ Î³â¸¢IAâ¸£ â‹… (Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] * â‹… (pure â‹… Faexp^[ eâ‚ ] â‹… Ï) âŸ¨,âŸ© Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] * â‹… (pure â‹… Faexp^[ eâ‚‚ ] â‹… Ï)) ]]
                  âŠ‘â€£ [âŠ‘-â‰ˆ] Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ Ã—â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„ ] * â‹… (Î³â¸¢IAâ¸£ â‹… (pure â‹… Faexp^[ eâ‚ ] â‹… Ï âŸ¨,âŸ© pure â‹… Faexp^[ eâ‚‚ ] â‹… Ï)) âŸ… exchange[Î³â¸¢IAâ¸£] â‡„â„¤â‡„ â‡„â„¤â‡„ âŸ†
                  âŠ‘â€£ [âŠ‘-â‰¡] Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ Ã—â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„ ] * â‹… (Î³â¸¢IAâ¸£ â‹… (return â‹… (Faexp^[ eâ‚ ] â‹… Ï) âŸ¨,âŸ© return â‹… (Faexp^[ eâ‚‚ ] â‹… Ï))) âŸ… â†¯ âŸ†
                  âŠ‘â€£ [âŠ‘-focus-right [â‹…] ğ‘œğ‘“ Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ Ã—â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„ ] * ] [âŠ‘-â‰ˆ] return â‹… (Faexp^[ eâ‚ ] â‹… Ï âŸ¨,âŸ© Faexp^[ eâ‚‚ ] â‹… Ï) âŸ… unit[Î³â¸¢IAâ¸£] âŸ†
                  âŠ‘â€£ [âŠ‘][[ Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ Ã—â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„ ] * â‹… (return â‹… (Faexp^[ eâ‚ ] â‹… Ï âŸ¨,âŸ© Faexp^[ eâ‚‚ ] â‹… Ï)) ]]
                  end
             âŠ‘â€£ [âŠ‘][[ (â†‘uncurry â‹… â†‘âŸ¦ o âŸ§áµ‡) * â‹… (Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ Ã—â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„ ] * â‹… (return â‹… (Faexp^[ eâ‚ ] â‹… Ï âŸ¨,âŸ© Faexp^[ eâ‚‚ ] â‹… Ï))) ]]
             âŠ‘â€£ [âŠ‘] Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] * â‹… ((pure â‹… (â†‘uncurry â‹… â†‘âŸ¦ o âŸ§áµ‡^)) * â‹… (return â‹… (Faexp^[ eâ‚ ] â‹… Ï âŸ¨,âŸ© Faexp^[ eâ‚‚ ] â‹… Ï))) âŸ… Ï€â‚ Î±[f]âŠ‘f^[ â‡„â„¤â‡„ Ã—â¸¢Î·â‡„Î³â¸£ â‡„â„¤â‡„ , â‡„â„¤â‡„ ]â¸¢Î³*Xâ¸£ Î±[âŸ¦âŸ§áµ‡] âŸ†
             end
        âŠ‘â€£ [âŠ‘][[ (pure â‹… Î·[ â‡„â„¤â‡„ ]) * â‹… (Î³â¸¢Î·â¸£[ â‡„â„¤â‡„ ] * â‹… ((pure â‹… (â†‘uncurry â‹… â†‘âŸ¦ o âŸ§áµ‡^)) * â‹… (return â‹… (Faexp^[ eâ‚ ] â‹… Ï âŸ¨,âŸ© Faexp^[ eâ‚‚ ] â‹… Ï)))) ]]
        âŠ‘â€£ [âŠ‘] (pure â‹… (â†‘uncurry â‹… â†‘âŸ¦ o âŸ§áµ‡^)) * â‹… (return â‹… (Faexp^[ eâ‚ ] â‹… Ï âŸ¨,âŸ© Faexp^[ eâ‚‚ ] â‹… Ï)) âŸ… left-unit[*]â¸¢contractiveâ¸¢Î·â¸£â¸£[ â‡„â„¤â‡„ ]  âŸ†
        âŠ‘â€£ [âŠ‘-â‰ˆ] pure â‹… (â†‘uncurry â‹… â†‘âŸ¦ o âŸ§áµ‡^) â‹… (Faexp^[ eâ‚ ] â‹… Ï âŸ¨,âŸ© Faexp^[ eâ‚‚ ] â‹… Ï) âŸ… right-unit[*] âŸ†
        âŠ‘â€£ [âŠ‘-â‰¡] pure â‹… (â†‘uncurry â‹… â†‘âŸ¦ o âŸ§áµ‡^) â‹… ((â†‘applyâ¸¢Ã—â¸£ â‹… (Faexp^[ eâ‚ ] âŸ¨,âŸ© Faexp^[ eâ‚‚ ])  âŠ™ â†‘split) â‹… Ï) âŸ… â†¯ âŸ†
        âŠ‘â€£ [âŠ‘-â‰ˆ] pure â‹… (â†‘uncurry â‹… â†‘âŸ¦ o âŸ§áµ‡^ âŠ™ â†‘applyâ¸¢Ã—â¸£ â‹… (Faexp^[ eâ‚ ] âŸ¨,âŸ© Faexp^[ eâ‚‚ ]) âŠ™ â†‘split) â‹… Ï
           âŸ… associative[pure] {g = (â†‘uncurry â‹… â†‘âŸ¦ o âŸ§áµ‡^)} {f = â†‘applyâ¸¢Ã—â¸£ â‹… (Faexp^[ eâ‚ ] âŸ¨,âŸ© Faexp^[ eâ‚‚ ]) âŠ™ â†‘split} âŸ†
        âŠ‘â€£ [âŠ‘-â‰¡] pure â‹… Faexp^[ Binary[ o ] eâ‚ eâ‚‚ ] â‹… Ï âŸ… â†¯ âŸ†
        â¬œ
