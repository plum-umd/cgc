module CDGAI.FaexpHat where

open import Prelude
open import POSet
open import CDGAI.Syntax
open import CDGAI.Semantics
open import CDGAI.EnvHat

module Â§-Faexpâ™¯
  (â„¤â™¯ : POSet zeroË¡)
  (â‡„â„¤â‡„ : â‡§ â„¤ â‡„á¶œ â„¤â™¯)
  (âŠ¤â„¤â™¯ : âŸª â„¤â™¯ âŸ«)
  (Î·[âŠ¤â„¤] : (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) * â‹… allâº (â‡§ â„¤) âŠ‘ return â‹… âŠ¤â„¤â™¯)
  (âŸ¦_âŸ§áµ˜â™¯ : unary â†’ âŸª â„¤â™¯ â‡’ â„¤â™¯ âŸ«)
  (Î±[âŸ¦âŸ§áµ˜] : âˆ€ {o} â†’ Î±[ â‡„â„¤â‡„ â‡’â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] â‹… (pure â‹… âŸ¦ o âŸ§áµ˜âº) âŠ‘ pure â‹… âŸ¦ o âŸ§áµ˜â™¯)
  (âŸ¦_âŸ§áµ‡â™¯ : binary â†’ âŸª â„¤â™¯ â‡’ â„¤â™¯ â‡’ â„¤â™¯ âŸ«)
  (Î±[âŸ¦âŸ§áµ‡] : âˆ€ {o} â†’ Î±[ (â‡„â„¤â‡„ Ã—â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„) â‡’â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] â‹… (uncurryâº â‹… âŸ¦ o âŸ§áµ‡âº) âŠ‘ pure â‹… (uncurryâº â‹… âŸ¦ o âŸ§áµ‡â™¯))
  where
  open Â§-envâ™¯ â„¤â™¯ â‡„â„¤â‡„
  âˆƒÎ±[Faexp] :
    âˆƒ Faexpâ™¯[_] â¦‚ (âˆ€ {Î“} â†’ aexp Î“ â†’ âŸª â‡§ (envâ™¯ Î“) â‡’ â„¤â™¯ âŸ«)
    ğ‘ ğ‘¡ (âˆ€ {Î“} (e : aexp Î“) â†’ Î±[ â‡„envâ‡„ â‡’â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] â‹… Faexp[ e ] âŠ‘ pure â‹… Faexpâ™¯[ e ])
  âˆƒÎ±[Faexp] = âˆƒ Faexpâ™¯[_] ,, Î±[Faexp]
    where
      Faexpâ™¯[_] : âˆ€ {Î“} â†’ aexp Î“ â†’ âŸª â‡§ (envâ™¯ Î“) â‡’ â„¤â™¯ âŸ«
      Faexpâ™¯[ Num n ]             = constâº â‹… (Î·á¶œ[ â‡„â„¤â‡„ ] â‹… â†‘ n)
      Faexpâ™¯[ Var x ]             = lookupâ™¯[ x ]
      Faexpâ™¯[ âŠ¤â„¤ ]                = constâº â‹… âŠ¤â„¤â™¯
      Faexpâ™¯[ Unary[ o ] e ]      = âŸ¦ o âŸ§áµ˜â™¯ âŠ™ Faexpâ™¯[ e ]
      Faexpâ™¯[ Binary[ o ] eâ‚ eâ‚‚ ] = uncurryâº â‹… âŸ¦ o âŸ§áµ‡â™¯ âŠ™ applyâ¸¢Ã—âºâ¸£ â‹… (Faexpâ™¯[ eâ‚ ] ,âº Faexpâ™¯[ eâ‚‚ ]) âŠ™ splitâº
      Î±[Faexp] : âˆ€ {Î“} (e : aexp Î“) â†’ Î±[ â‡„envâ‡„ â‡’â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] â‹… Faexp[ e ] âŠ‘ pure â‹… Faexpâ™¯[ e ]
      Î±[Faexp] (Num n) = ext[â‡’]â¸¢âŠ‘â¸£ $ Î» {Ï} â†’ let open Â§-ProofMode[âŠ‘] in [proof-mode]
        do [[ (Î±[ â‡„envâ‡„ â‡’â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] â‹… Faexp[ Num n ]) â‹… Ï ]]
         â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ Faexp[ Num n ] âŸ Î³á¶œ[ â‡„envâ‡„ ]) â‹… Ï ]]
         â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) * â‹… (Faexp[ Num n ] * â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï)) ]]
         â€£ [focus-right [â‹…] ğ‘œğ‘“ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) * ] begin
             do [[ (Faexp[ Num n ] * â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï)) ]]
              â€£ âŸ… Î²-Faexp[Num]â¸¢âŠ‘â¸£ âŸ†â¸¢âŠ‘â¸£
              â€£ [[ return â‹… â†‘ n ]]
             end
         â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) * â‹… (return â‹… â†‘ n) ]]
         â€£ âŸ… right-unit[*] âŸ†â¸¢â‰ˆâ¸£
         â€£ [[ pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] â‹… â†‘ n ]]
         â€£ [[ pure â‹… (constâº â‹… (Î·á¶œ[ â‡„â„¤â‡„ ] â‹… â†‘ n)) â‹… Ï ]]
         â€£ [[ pure â‹… Faexpâ™¯[ Num n ] â‹… Ï ]]
         âˆ 
      Î±[Faexp] (Var x) = let open Â§-ProofMode[âŠ‘] in [proof-mode]
        do [[ Î±[ â‡„envâ‡„ â‡’â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] â‹… Faexp[ Var x ] ]]
         â€£ [[ pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ Faexp[ Var x ] âŸ Î³á¶œ[ â‡„envâ‡„ ] ]]
         â€£ [focus-right [âŸ] ğ‘œğ‘“ pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] ] begin
             do [focus-left [âŸ] ğ‘œğ‘“ Î³á¶œ[ â‡„envâ‡„ ] ] begin
                  do [[ Faexp[ Var x ] ]]
                   â€£ âŸ… Î²-Faexp[Var]â¸¢âŠ™â¸£ âŸ†â¸¢â‰ˆâ¸£
                   â€£ [[ pure â‹… lookup[ x ]âº ]]
                  end
              â€£ [[ pure â‹… lookup[ x ]âº âŸ Î³á¶œ[ â‡„envâ‡„ ] ]]
              â€£ âŸ… Ï€â‚ Î±[f]â†”fâŸÎ³á¶œ[ â‡„envâ‡„ , â‡„â„¤â‡„ ] $ Î±[lookup] {x = x} âŸ†
              â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… lookupâ™¯[ x ] ]]
             end
         â€£ [[ pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… lookupâ™¯[ x ] ]]
         â€£ âŸ… â—‡ associative[âŸ] âŸ†â¸¢â‰ˆâ¸£
         â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ Î³á¶œ[ â‡„â„¤â‡„ ]) âŸ pure â‹… lookupâ™¯[ x ] ]]
         â€£ âŸ… left-unit-contractive[âŸ]á¶œ[ â‡„â„¤â‡„ ] âŸ†
         â€£ [[ pure â‹… lookupâ™¯[ x ] ]]
         â€£ [[ pure â‹… Faexpâ™¯[ Var x ] ]]
         âˆ 
      Î±[Faexp] âŠ¤â„¤ = ext[â‡’]â¸¢âŠ‘â¸£ $ Î» {Ï} â†’ let open Â§-ProofMode[âŠ‘] in [proof-mode]
        do [[ (Î±[ â‡„envâ‡„ â‡’â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] â‹… Faexp[ âŠ¤â„¤ ]) â‹… Ï ]]
         â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ Faexp[ âŠ¤â„¤ ] âŸ Î³á¶œ[ â‡„envâ‡„ ]) â‹… Ï ]]
         â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) * â‹… (Faexp[ âŠ¤â„¤ ] * â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï)) ]]
         â€£ [focus-right [â‹…] ğ‘œğ‘“ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) * ] begin
             do [[ (Faexp[ âŠ¤â„¤ ] * â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï)) ]]
              â€£ âŸ… Î²-Faexp[âŠ¤â„¤]â¸¢âŠ‘â¸£ âŸ†
              â€£ [[ allâº (â‡§ â„¤) ]]
             end
         â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) * â‹… allâº (â‡§ â„¤) ]]
         â€£ âŸ… Î·[âŠ¤â„¤] âŸ†
         â€£ [[ return â‹… âŠ¤â„¤â™¯ ]]
         â€£ [[ pure â‹… Faexpâ™¯[ âŠ¤â„¤ ] â‹… Ï ]]
         âˆ 
      Î±[Faexp] (Unary[ o ] e) with Î±[Faexp] e
      ... | IH = let open Â§-ProofMode[âŠ‘] in [proof-mode]
        do [[ Î±[ â‡„envâ‡„ â‡’â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] â‹… Faexp[ Unary[ o ] e ] ]]
         â€£ [[ pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ Faexp[ Unary[ o ] e ] âŸ Î³á¶œ[ â‡„envâ‡„ ] ]]
         â€£ [focus-right [âŸ] ğ‘œğ‘“ pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] ] begin
             do [focus-left [âŸ] ğ‘œğ‘“ Î³á¶œ[ â‡„envâ‡„ ] ] begin
                  do [[ Faexp[ Unary[ o ] e ] ]]
                   â€£ âŸ… Î²-Faexp[Unary]â¸¢âŸâ¸£ âŸ†â¸¢â‰ˆâ¸£
                   â€£ [[ pure â‹… âŸ¦ o âŸ§áµ˜âº âŸ Faexp[ e ] ]]
                  end
              â€£ [[ (pure â‹… âŸ¦ o âŸ§áµ˜âº âŸ Faexp[ e ]) âŸ Î³á¶œ[ â‡„envâ‡„ ] ]]
              â€£ âŸ… associative[âŸ] âŸ†â¸¢â‰ˆâ¸£
              â€£ [[ pure â‹… âŸ¦ o âŸ§áµ˜âº âŸ Faexp[ e ] âŸ Î³á¶œ[ â‡„envâ‡„ ] ]]
              â€£ [focus-right [âŸ] ğ‘œğ‘“ pure â‹… âŸ¦ o âŸ§áµ˜âº ] begin
                  do [[ Faexp[ e ] âŸ Î³á¶œ[ â‡„envâ‡„ ] ]]
                   â€£ âŸ… Ï€â‚ Î±[f]â†”fâŸÎ³á¶œ[ â‡„envâ‡„ , â‡„â„¤â‡„ ] IH âŸ†
                   â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… Faexpâ™¯[ e ] ]]
                  end
              â€£ [[ pure â‹… âŸ¦ o âŸ§áµ˜âº âŸ Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… Faexpâ™¯[ e ] ]]
              â€£ âŸ… â—‡ associative[âŸ] âŸ†â¸¢â‰ˆâ¸£
              â€£ [[ (pure â‹… âŸ¦ o âŸ§áµ˜âº âŸ Î³á¶œ[ â‡„â„¤â‡„ ]) âŸ pure â‹… Faexpâ™¯[ e ] ]]
              â€£ [focus-left [âŸ] ğ‘œğ‘“ pure â‹… Faexpâ™¯[ e ] ] begin
                  do [[ pure â‹… âŸ¦ o âŸ§áµ˜âº âŸ Î³á¶œ[ â‡„â„¤â‡„ ] ]]
                   â€£ âŸ… Ï€â‚ Î±[f]â†”fâŸÎ³á¶œ[ â‡„â„¤â‡„ , â‡„â„¤â‡„ ] Î±[âŸ¦âŸ§áµ˜] âŸ†
                   â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… âŸ¦ o âŸ§áµ˜â™¯ ]]
                  end
              â€£ [[ (Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… âŸ¦ o âŸ§áµ˜â™¯) âŸ pure â‹… Faexpâ™¯[ e ] ]]
              â€£ âŸ… associative[âŸ] âŸ†â¸¢â‰ˆâ¸£
              â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… âŸ¦ o âŸ§áµ˜â™¯ âŸ pure â‹… Faexpâ™¯[ e ] ]]
             end
         â€£ [[ pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ Î³á¶œ[ â‡„â„¤â‡„ ] âŸ pure â‹… âŸ¦ o âŸ§áµ˜â™¯ âŸ pure â‹… Faexpâ™¯[ e ] ]]
         â€£ âŸ… â—‡ associative[âŸ] âŸ†â¸¢â‰ˆâ¸£
         â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ Î³á¶œ[ â‡„â„¤â‡„ ]) âŸ pure â‹… âŸ¦ o âŸ§áµ˜â™¯ âŸ pure â‹… Faexpâ™¯[ e ] ]]
         â€£ âŸ… left-unit-contractive[âŸ]á¶œ[ â‡„â„¤â‡„ ] âŸ†
         â€£ [[ pure â‹… âŸ¦ o âŸ§áµ˜â™¯ âŸ pure â‹… Faexpâ™¯[ e ] ]]
         â€£ âŸ… homomorphic[pure]â¸¢âŸâ¸£ âŸ†â¸¢â‰ˆâ¸£
         â€£ [[ pure â‹… (âŸ¦ o âŸ§áµ˜â™¯ âŠ™ Faexpâ™¯[ e ]) ]]
         â€£ [[ pure â‹… Faexpâ™¯[ Unary[ o ] e ] ]]
         âˆ
      Î±[Faexp] (Binary[ o ] eâ‚ eâ‚‚) with Î±[Faexp] eâ‚ | Î±[Faexp] eâ‚‚
      ... | IHâ‚ | IHâ‚‚ = ext[â‡’]â¸¢âŠ‘â¸£ $ Î» {Ï} â†’ let open Â§-ProofMode[âŠ‘] in [proof-mode]
        do [[ (Î±[ â‡„envâ‡„ â‡’â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] â‹… Faexp[ Binary[ o ] eâ‚ eâ‚‚ ]) â‹… Ï ]]
         â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ] âŸ Faexp[ Binary[ o ] eâ‚ eâ‚‚ ] âŸ Î³á¶œ[ â‡„envâ‡„ ]) â‹… Ï ]]
         â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) * â‹… (Faexp[ Binary[ o ] eâ‚ eâ‚‚ ] * â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï)) ]]
         â€£ [focus-right [â‹…] ğ‘œğ‘“ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) * ] begin
             do [[ Faexp[ Binary[ o ] eâ‚ eâ‚‚ ] * â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) ]]
              â€£ âŸ… Î²-Faexp[Binary]â¸¢*â¸£â¸¢âŠ‘â¸£ âŸ†
              â€£ [[ (uncurryâº â‹… âŸ¦ o âŸ§áµ‡âº) * â‹… (Î³â¸¢IAâ¸£ â‹… (Faexp[ eâ‚ ] * â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) ,âº Faexp[ eâ‚‚ ] * â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï))) ]]
              â€£ [focus-right [â‹…] ğ‘œğ‘“ (uncurryâº â‹… âŸ¦ o âŸ§áµ‡âº) * ] begin
                  do [focus-right [â‹…] ğ‘œğ‘“ Î³â¸¢IAâ¸£ ] begin
                       do [[ Faexp[ eâ‚ ] * â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) ,âº Faexp[ eâ‚‚ ] * â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) ]]
                        â€£ [focus-left [,] ğ‘œğ‘“ Faexp[ eâ‚‚ ] * â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) ] begin
                            do [[ Faexp[ eâ‚ ] * â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) ]]
                             â€£ âŸ… Ï€â‚ Î±[f]â†”fâŸÎ³á¶œ*[ â‡„envâ‡„ , â‡„â„¤â‡„ ] IHâ‚ âŸ†
                             â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] * â‹… (pure â‹… Faexpâ™¯[ eâ‚ ] â‹… Ï) ]]
                             end
                        â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] * â‹… (pure â‹… Faexpâ™¯[ eâ‚ ] â‹… Ï) ,âº Faexp[ eâ‚‚ ] * â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) ]]
                        â€£ [focus-right [,] ğ‘œğ‘“ Î³á¶œ[ â‡„â„¤â‡„ ] * â‹… (pure â‹… Faexpâ™¯[ eâ‚ ] â‹… Ï) ] begin
                            do [[ Faexp[ eâ‚‚ ] * â‹… (Î³á¶œ[ â‡„envâ‡„ ] â‹… Ï) ]]
                             â€£ âŸ… Ï€â‚ Î±[f]â†”fâŸÎ³á¶œ*[ â‡„envâ‡„ , â‡„â„¤â‡„ ] IHâ‚‚ âŸ†
                             â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] * â‹… (pure â‹… Faexpâ™¯[ eâ‚‚ ] â‹… Ï) ]]
                            end
                        â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] * â‹… (pure â‹… Faexpâ™¯[ eâ‚ ] â‹… Ï) ,âº Î³á¶œ[ â‡„â„¤â‡„ ] * â‹… (pure â‹… Faexpâ™¯[ eâ‚‚ ] â‹… Ï) ]]
                       end
                   â€£ [[ Î³â¸¢IAâ¸£ â‹… (Î³á¶œ[ â‡„â„¤â‡„ ] * â‹… (pure â‹… Faexpâ™¯[ eâ‚ ] â‹… Ï) ,âº Î³á¶œ[ â‡„â„¤â‡„ ] * â‹… (pure â‹… Faexpâ™¯[ eâ‚‚ ] â‹… Ï)) ]]
                   â€£ âŸ… homomorphic[Î³/Î³]â¸¢IAâ¸£[ â‡„â„¤â‡„ , â‡„â„¤â‡„ ] âŸ†â¸¢â‰ˆâ¸£
                   â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ Ã—â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] * â‹… (Î³â¸¢IAâ¸£ â‹… (pure â‹… Faexpâ™¯[ eâ‚ ] â‹… Ï ,âº pure â‹… Faexpâ™¯[ eâ‚‚ ] â‹… Ï)) ]]
                   â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ Ã—â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] * â‹… (Î³â¸¢IAâ¸£ â‹… (return â‹… (Faexpâ™¯[ eâ‚ ] â‹… Ï) ,âº return â‹… (Faexpâ™¯[ eâ‚‚ ] â‹… Ï))) ]]
                   â€£ [focus-right [â‹…] ğ‘œğ‘“ Î³á¶œ[ â‡„â„¤â‡„ Ã—â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] * ] begin
                       do [[ Î³â¸¢IAâ¸£ â‹… (return â‹… (Faexpâ™¯[ eâ‚ ] â‹… Ï) ,âº return â‹… (Faexpâ™¯[ eâ‚‚ ] â‹… Ï)) ]]
                        â€£ âŸ… homomorphic[Î³/return]â¸¢IAâ¸£ âŸ†â¸¢â‰ˆâ¸£
                        â€£ [[ return â‹… (Faexpâ™¯[ eâ‚ ] â‹… Ï ,âº Faexpâ™¯[ eâ‚‚ ] â‹… Ï) ]]
                       end
                   â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ Ã—â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] * â‹… (return â‹… (Faexpâ™¯[ eâ‚ ] â‹… Ï ,âº Faexpâ™¯[ eâ‚‚ ] â‹… Ï)) ]]
                  end
              â€£ [[ (uncurryâº â‹… âŸ¦ o âŸ§áµ‡âº) * â‹… (Î³á¶œ[ â‡„â„¤â‡„ Ã—â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ ] * â‹… (return â‹… (Faexpâ™¯[ eâ‚ ] â‹… Ï ,âº Faexpâ™¯[ eâ‚‚ ] â‹… Ï))) ]]
              â€£ âŸ… Ï€â‚ Î±[f]â†”fâŸÎ³á¶œ*X[ â‡„â„¤â‡„ Ã—â¸¢â‡„á¶œâ¸£ â‡„â„¤â‡„ , â‡„â„¤â‡„ ] Î±[âŸ¦âŸ§áµ‡] âŸ†
              â€£ [[ Î³á¶œ[ â‡„â„¤â‡„ ] * â‹… ((pure â‹… (uncurryâº â‹… âŸ¦ o âŸ§áµ‡â™¯)) * â‹… (return â‹… (Faexpâ™¯[ eâ‚ ] â‹… Ï ,âº Faexpâ™¯[ eâ‚‚ ] â‹… Ï))) ]]
             end
         â€£ [[ (pure â‹… Î·á¶œ[ â‡„â„¤â‡„ ]) * â‹… (Î³á¶œ[ â‡„â„¤â‡„ ] * â‹… ((pure â‹… (uncurryâº â‹… âŸ¦ o âŸ§áµ‡â™¯)) * â‹… (return â‹… (Faexpâ™¯[ eâ‚ ] â‹… Ï ,âº Faexpâ™¯[ eâ‚‚ ] â‹… Ï)))) ]]
         â€£ âŸ… contractiveá¶œ[X*][ â‡„â„¤â‡„ ] âŸ†
         â€£ [[ (pure â‹… (uncurryâº â‹… âŸ¦ o âŸ§áµ‡â™¯)) * â‹… (return â‹… (Faexpâ™¯[ eâ‚ ] â‹… Ï ,âº Faexpâ™¯[ eâ‚‚ ] â‹… Ï)) ]]
         â€£ âŸ… right-unit[*] âŸ†â¸¢â‰ˆâ¸£
         â€£ [[ pure â‹… (uncurryâº â‹… âŸ¦ o âŸ§áµ‡â™¯) â‹… (Faexpâ™¯[ eâ‚ ] â‹… Ï ,âº Faexpâ™¯[ eâ‚‚ ] â‹… Ï) ]]
         â€£ [[ pure â‹… (uncurryâº â‹… âŸ¦ o âŸ§áµ‡â™¯) â‹… ((applyâ¸¢Ã—âºâ¸£ â‹… (Faexpâ™¯[ eâ‚ ] ,âº Faexpâ™¯[ eâ‚‚ ])  âŠ™ splitâº) â‹… Ï) ]]
         â€£ âŸ… â—‡ $ homomorphic[pure] {g = (uncurryâº â‹… âŸ¦ o âŸ§áµ‡â™¯)} {f = applyâ¸¢Ã—âºâ¸£ â‹… (Faexpâ™¯[ eâ‚ ] ,âº Faexpâ™¯[ eâ‚‚ ]) âŠ™ splitâº} âŸ†â¸¢â‰ˆâ¸£
         â€£ [[ pure â‹… (uncurryâº â‹… âŸ¦ o âŸ§áµ‡â™¯ âŠ™ applyâ¸¢Ã—âºâ¸£ â‹… (Faexpâ™¯[ eâ‚ ] ,âº Faexpâ™¯[ eâ‚‚ ]) âŠ™ splitâº) â‹… Ï ]]
         â€£ [[ pure â‹… Faexpâ™¯[ Binary[ o ] eâ‚ eâ‚‚ ] â‹… Ï ]]
         âˆ
