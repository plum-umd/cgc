module AGT.Gradual where

open import Prelude

open import AGT.Precise

infix  14 _âŠ²â™¯_
infix  14 _âŠ¢â™¯_
infix  14 _âŠ¢â¦‚â™¯_

infixr 15 _âŸ¨â†’âŸ©_
infixr 16 âŸ¨ifâŸ©_âŸ¨thenâŸ©_âŸ¨elseâŸ©_
infixl 17 _âŸ¨â‹…âŸ©_
infixl 18 _â¦‚â¦‚_

infixr 22 _âŸ‡â™¯_
infixr 24 _âŸ‘â™¯_

infixr 40 _âˆ·_

---------------------------
-- Gradual Type Language --
---------------------------

data typeâ™¯ : Set where
  âŠ¤ : typeâ™¯
  Any : typeâ™¯
  None : typeâ™¯
  âŸ¨ğ”¹âŸ© : typeâ™¯
  _âŸ¨â†’âŸ©_ : typeâ™¯ â†’ typeâ™¯ â†’ typeâ™¯

-----------------------------
-- Precision Partial Order --
-----------------------------

data _â‰¼áµ—â™¯_ : typeâ™¯ â†’ typeâ™¯ â†’ Set where
  âŠ¤ : âˆ€ {Ï„} â†’ Ï„ â‰¼áµ—â™¯ âŠ¤
  Any : Any â‰¼áµ—â™¯ Any
  None : None â‰¼áµ—â™¯ None
  âŸ¨ğ”¹âŸ© : âŸ¨ğ”¹âŸ© â‰¼áµ—â™¯ âŸ¨ğ”¹âŸ©
  _âŸ¨â†’âŸ©_ : âˆ€ {Ï„â‚â‚ Ï„â‚‚â‚ Ï„â‚â‚‚ Ï„â‚‚â‚‚}
    â†’ Ï„â‚â‚ â‰¼áµ—â™¯ Ï„â‚â‚‚
    â†’ Ï„â‚‚â‚ â‰¼áµ—â™¯ Ï„â‚‚â‚‚
    â†’ (Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚) â‰¼áµ—â™¯ (Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚‚)

xRxâ¸¢â‰¼áµ—â™¯â¸£ : âˆ€ {Ï„} â†’ Ï„ â‰¼áµ—â™¯ Ï„
xRxâ¸¢â‰¼áµ—â™¯â¸£ {âŠ¤} = âŠ¤
xRxâ¸¢â‰¼áµ—â™¯â¸£ {Any} = Any
xRxâ¸¢â‰¼áµ—â™¯â¸£ {None} = None
xRxâ¸¢â‰¼áµ—â™¯â¸£ {âŸ¨ğ”¹âŸ©} = âŸ¨ğ”¹âŸ©
xRxâ¸¢â‰¼áµ—â™¯â¸£ {Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚} = xRxâ¸¢â‰¼áµ—â™¯â¸£ âŸ¨â†’âŸ© xRxâ¸¢â‰¼áµ—â™¯â¸£

_âŠšâ¸¢â‰¼áµ—â™¯â¸£_ : âˆ€ {Ï„â‚ Ï„â‚‚ Ï„â‚ƒ} â†’ Ï„â‚‚ â‰¼áµ—â™¯ Ï„â‚ƒ â†’ Ï„â‚ â‰¼áµ—â™¯ Ï„â‚‚ â†’ Ï„â‚ â‰¼áµ—â™¯ Ï„â‚ƒ
âŠ¤ âŠšâ¸¢â‰¼áµ—â™¯â¸£ â‰¼â‚ = âŠ¤
Any âŠšâ¸¢â‰¼áµ—â™¯â¸£ Any = Any
None âŠšâ¸¢â‰¼áµ—â™¯â¸£ None = None
âŸ¨ğ”¹âŸ© âŠšâ¸¢â‰¼áµ—â™¯â¸£ âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ©
(â‰¼â‚â‚ âŸ¨â†’âŸ© â‰¼â‚‚â‚) âŠšâ¸¢â‰¼áµ—â™¯â¸£ (â‰¼â‚â‚‚ âŸ¨â†’âŸ© â‰¼â‚‚â‚‚) = â‰¼â‚â‚ âŠšâ¸¢â‰¼áµ—â™¯â¸£ â‰¼â‚â‚‚ âŸ¨â†’âŸ© â‰¼â‚‚â‚ âŠšâ¸¢â‰¼áµ—â™¯â¸£ â‰¼â‚‚â‚‚

instance
  Reflexive[â‰¼áµ—â™¯] : Reflexive _â‰¼áµ—â™¯_
  Reflexive[â‰¼áµ—â™¯] = record { xRx = xRxâ¸¢â‰¼áµ—â™¯â¸£ }
  Transitive[â‰¼áµ—â™¯] : Transitive _â‰¼áµ—â™¯_
  Transitive[â‰¼áµ—â™¯] = record { _âŠš_ = _âŠšâ¸¢â‰¼áµ—â™¯â¸£_ }
  PreOrder[typeâ™¯] : PreOrder 0á´¸ typeâ™¯
  PreOrder[typeâ™¯] = record { _â‰¼_ = _â‰¼áµ—â™¯_ }

---------------------------------
-- Precision Galois Connection --
---------------------------------

Î·áµ— : type â†’ typeâ™¯
Î·áµ— Any = Any
Î·áµ— None = None
Î·áµ— âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ©
Î·áµ— (Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚) = Î·áµ— Ï„â‚ âŸ¨â†’âŸ© Î·áµ— Ï„â‚‚

mono[Î·áµ—] : proper (_â‰¼_ â‡‰ _â‰¼_) Î·áµ—
mono[Î·áµ—] â†¯ = xRx

data _âˆˆÎ³áµ—[_] : type â†’ typeâ™¯ â†’ Set where
  âŠ¤ : âˆ€ {Ï„} â†’ Ï„ âˆˆÎ³áµ—[ âŠ¤ ]
  Any : Any âˆˆÎ³áµ—[ Any ]
  None : None âˆˆÎ³áµ—[ None ]
  âŸ¨ğ”¹âŸ© : âŸ¨ğ”¹âŸ© âˆˆÎ³áµ—[ âŸ¨ğ”¹âŸ© ]
  _âŸ¨â†’âŸ©_ : âˆ€ {Ï„â‚ Ï„â‚‚ Ï„â‚â™¯ Ï„â‚‚â™¯}
    â†’ Ï„â‚ âˆˆÎ³áµ—[ Ï„â‚â™¯ ]
    â†’ Ï„â‚‚ âˆˆÎ³áµ—[ Ï„â‚‚â™¯ ]
    â†’ (Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚) âˆˆÎ³áµ—[ Ï„â‚â™¯ âŸ¨â†’âŸ© Ï„â‚‚â™¯ ]

mono[âˆˆÎ³áµ—] : proper (_â‰¼_ â‡‰ _â‰½_ â‡‰ [â†’]) (flip _âˆˆÎ³áµ—[_])
mono[âˆˆÎ³áµ—] âŠ¤ â†¯ Ï„â‚âˆˆÏ„â‚‚ = âŠ¤
mono[âˆˆÎ³áµ—] Any â†¯ Any = Any
mono[âˆˆÎ³áµ—] None â†¯ None = None
mono[âˆˆÎ³áµ—] âŸ¨ğ”¹âŸ© â†¯ âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ©
mono[âˆˆÎ³áµ—] (â‰¼â‚ âŸ¨â†’âŸ© â‰¼â‚‚) â†¯ (âˆˆÎ³â‚ âŸ¨â†’âŸ© âˆˆÎ³â‚‚) = mono[âˆˆÎ³áµ—] â‰¼â‚ â†¯ âˆˆÎ³â‚ âŸ¨â†’âŸ© mono[âˆˆÎ³áµ—] â‰¼â‚‚ â†¯ âˆˆÎ³â‚‚

sound[Î·Î³áµ—] : âˆ€ {Ï„} â†’ Ï„ âˆˆÎ³áµ—[ Î·áµ— Ï„ ]
sound[Î·Î³áµ—] {Any} = Any
sound[Î·Î³áµ—] {None} = None
sound[Î·Î³áµ—] {âŸ¨ğ”¹âŸ©} = âŸ¨ğ”¹âŸ©
sound[Î·Î³áµ—] {Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚} = sound[Î·Î³áµ—] âŸ¨â†’âŸ© sound[Î·Î³áµ—]

complete[Î·Î³áµ—] : âˆ€ {Ï„ Ï„â™¯} â†’ Ï„ âˆˆÎ³áµ—[ Ï„â™¯ ] â†’ Î·áµ— Ï„ â‰¼ Ï„â™¯
complete[Î·Î³áµ—] âŠ¤ = âŠ¤
complete[Î·Î³áµ—] Any = Any
complete[Î·Î³áµ—] None = None
complete[Î·Î³áµ—] âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ©
complete[Î·Î³áµ—] (âˆˆÎ³â‚ âŸ¨â†’âŸ© âˆˆÎ³â‚‚) = complete[Î·Î³áµ—] âˆˆÎ³â‚ âŸ¨â†’âŸ© complete[Î·Î³áµ—] âˆˆÎ³â‚‚

----------------------
-- Galois Injection --
----------------------

-- Proves that Î·/Î³ form a stronger correspondance, called a Galois
-- injection.

âˆƒâˆˆÎ³áµ— : âˆ€ Ï„â™¯ â†’ âˆƒ Ï„ ğ‘ ğ‘¡ Ï„ âˆˆÎ³áµ—[ Ï„â™¯ ]
âˆƒâˆˆÎ³áµ— âŠ¤ = âˆƒ âŸ¨ğ”¹âŸ© ,, âŠ¤
âˆƒâˆˆÎ³áµ— Any = âˆƒ Any ,, Any
âˆƒâˆˆÎ³áµ— None = âˆƒ None ,, None
âˆƒâˆˆÎ³áµ— âŸ¨ğ”¹âŸ© = âˆƒ âŸ¨ğ”¹âŸ© ,, âŸ¨ğ”¹âŸ©
âˆƒâˆˆÎ³áµ— (Ï„â‚â™¯ âŸ¨â†’âŸ© Ï„â‚‚â™¯) with âˆƒâˆˆÎ³áµ— Ï„â‚â™¯ | âˆƒâˆˆÎ³áµ— Ï„â‚‚â™¯
... | âˆƒ Ï„â‚ ,, âˆˆÎ³â‚ | âˆƒ Ï„â‚‚ ,, âˆˆÎ³â‚‚ = âˆƒ Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚ ,, âˆˆÎ³â‚ âŸ¨â†’âŸ© âˆˆÎ³â‚‚

injective[âˆˆÎ³áµ—] : âˆ€ Ï„â‚â™¯ Ï„â‚‚â™¯ â†’ (âˆ€ Ï„ â†’ Ï„ âˆˆÎ³áµ—[ Ï„â‚â™¯ ] â†’ Ï„ âˆˆÎ³áµ—[ Ï„â‚‚â™¯ ]) â†’ Ï„â‚â™¯ â‰¼ Ï„â‚‚â™¯
injective[âˆˆÎ³áµ—] _ âŠ¤ _ = âŠ¤
injective[âˆˆÎ³áµ—] Any Any _ = Any
injective[âˆˆÎ³áµ—] None None _ = None
injective[âˆˆÎ³áµ—] âŸ¨ğ”¹âŸ© âŸ¨ğ”¹âŸ© _ = âŸ¨ğ”¹âŸ©
injective[âˆˆÎ³áµ—] (Ï„â‚â‚â™¯ âŸ¨â†’âŸ© Ï„â‚‚â‚â™¯) (Ï„â‚â‚‚â™¯ âŸ¨â†’âŸ© Ï„â‚‚â‚‚â™¯) âŠ†â‚ = injective[âˆˆÎ³áµ—] Ï„â‚â‚â™¯ Ï„â‚â‚‚â™¯ Fâ‚ âŸ¨â†’âŸ© injective[âˆˆÎ³áµ—] Ï„â‚‚â‚â™¯ Ï„â‚‚â‚‚â™¯ Fâ‚‚
  where
    Fâ‚ : âˆ€ Ï„ â†’ Ï„ âˆˆÎ³áµ—[ Ï„â‚â‚â™¯ ] â†’ Ï„ âˆˆÎ³áµ—[ Ï„â‚â‚‚â™¯ ]
    Fâ‚ Ï„â‚ âˆˆÎ³â‚ with âˆƒâˆˆÎ³áµ— Ï„â‚‚â‚â™¯
    ... | âˆƒ Ï„â‚‚ ,, âˆˆÎ³â‚‚ with âŠ†â‚ (Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚) (âˆˆÎ³â‚ âŸ¨â†’âŸ© âˆˆÎ³â‚‚)
    ... | âˆˆÎ³â‚' âŸ¨â†’âŸ© âˆˆÎ³â‚‚' = âˆˆÎ³â‚'
    Fâ‚‚ : âˆ€ Ï„ â†’ Ï„ âˆˆÎ³áµ—[ Ï„â‚‚â‚â™¯ ] â†’ Ï„ âˆˆÎ³áµ—[ Ï„â‚‚â‚‚â™¯ ]
    Fâ‚‚ Ï„â‚‚ âˆˆÎ³â‚‚ with âˆƒâˆˆÎ³áµ— Ï„â‚â‚â™¯
    ... | âˆƒ Ï„â‚ ,, âˆˆÎ³â‚ with âŠ†â‚ (Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚) (âˆˆÎ³â‚ âŸ¨â†’âŸ© âˆˆÎ³â‚‚)
    ... | âˆˆÎ³â‚' âŸ¨â†’âŸ© âˆˆÎ³â‚‚' = âˆˆÎ³â‚‚'
injective[âˆˆÎ³áµ—] âŠ¤ Any âŠ†â‚ = case âŠ†â‚ (âŸ¨ğ”¹âŸ© âŸ¨â†’âŸ© âŸ¨ğ”¹âŸ©) âŠ¤ ğ‘œğ‘“ Î» ()
injective[âˆˆÎ³áµ—] âŠ¤ None âŠ†â‚ = case âŠ†â‚ (âŸ¨ğ”¹âŸ© âŸ¨â†’âŸ© âŸ¨ğ”¹âŸ©) âŠ¤ ğ‘œğ‘“ Î» ()
injective[âˆˆÎ³áµ—] âŠ¤ âŸ¨ğ”¹âŸ© âŠ†â‚ = case âŠ†â‚ (âŸ¨ğ”¹âŸ© âŸ¨â†’âŸ© âŸ¨ğ”¹âŸ©) âŠ¤ ğ‘œğ‘“ Î» ()
injective[âˆˆÎ³áµ—] âŠ¤ (Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚) âŠ†â‚ = case âŠ†â‚ âŸ¨ğ”¹âŸ© âŠ¤ ğ‘œğ‘“ Î» ()
injective[âˆˆÎ³áµ—] Any None âŠ†â‚ = case âŠ†â‚ Any Any ğ‘œğ‘“ Î» () 
injective[âˆˆÎ³áµ—] Any âŸ¨ğ”¹âŸ© âŠ†â‚ = case âŠ†â‚ Any Any ğ‘œğ‘“ Î» ()
injective[âˆˆÎ³áµ—] Any (_ âŸ¨â†’âŸ© _) âŠ†â‚ = case âŠ†â‚ Any Any ğ‘œğ‘“ Î» ()
injective[âˆˆÎ³áµ—] None Any âŠ†â‚ = case âŠ†â‚ None None ğ‘œğ‘“ Î» () 
injective[âˆˆÎ³áµ—] None âŸ¨ğ”¹âŸ© âŠ†â‚ = case âŠ†â‚ None None ğ‘œğ‘“ Î» ()
injective[âˆˆÎ³áµ—] None (_ âŸ¨â†’âŸ© _) âŠ†â‚ = case âŠ†â‚ None None ğ‘œğ‘“ Î» ()
injective[âˆˆÎ³áµ—] âŸ¨ğ”¹âŸ© Any âŠ†â‚ = case âŠ†â‚ âŸ¨ğ”¹âŸ© âŸ¨ğ”¹âŸ© ğ‘œğ‘“ Î» ()
injective[âˆˆÎ³áµ—] âŸ¨ğ”¹âŸ© None âŠ†â‚ = case âŠ†â‚ âŸ¨ğ”¹âŸ© âŸ¨ğ”¹âŸ© ğ‘œğ‘“ Î» ()
injective[âˆˆÎ³áµ—] âŸ¨ğ”¹âŸ© (_ âŸ¨â†’âŸ© _) âŠ†â‚ = case âŠ†â‚ âŸ¨ğ”¹âŸ© âŸ¨ğ”¹âŸ© ğ‘œğ‘“ Î» ()
injective[âˆˆÎ³áµ—] (Ï„â‚â™¯ âŸ¨â†’âŸ© Ï„â‚‚â™¯) Any âŠ†â‚ with âˆƒâˆˆÎ³áµ— Ï„â‚â™¯ | âˆƒâˆˆÎ³áµ— Ï„â‚‚â™¯
... | âˆƒ Ï„â‚ ,, Ï„â‚âˆˆÎ³[Ï„â‚â™¯] | âˆƒ Ï„â‚‚ ,, Ï„â‚‚âˆˆÎ³[Ï„â‚‚â™¯] = case âŠ†â‚ (Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚) (Ï„â‚âˆˆÎ³[Ï„â‚â™¯] âŸ¨â†’âŸ© Ï„â‚‚âˆˆÎ³[Ï„â‚‚â™¯]) ğ‘œğ‘“ Î» ()
injective[âˆˆÎ³áµ—] (Ï„â‚â™¯ âŸ¨â†’âŸ© Ï„â‚‚â™¯) None âŠ†â‚ with âˆƒâˆˆÎ³áµ— Ï„â‚â™¯ | âˆƒâˆˆÎ³áµ— Ï„â‚‚â™¯
... | âˆƒ Ï„â‚ ,, Ï„â‚âˆˆÎ³[Ï„â‚â™¯] | âˆƒ Ï„â‚‚ ,, Ï„â‚‚âˆˆÎ³[Ï„â‚‚â™¯] = case âŠ†â‚ (Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚) (Ï„â‚âˆˆÎ³[Ï„â‚â™¯] âŸ¨â†’âŸ© Ï„â‚‚âˆˆÎ³[Ï„â‚‚â™¯]) ğ‘œğ‘“ Î» ()
injective[âˆˆÎ³áµ—] (Ï„â‚â™¯ âŸ¨â†’âŸ© Ï„â‚‚â™¯) âŸ¨ğ”¹âŸ© âŠ†â‚ with âˆƒâˆˆÎ³áµ— Ï„â‚â™¯ | âˆƒâˆˆÎ³áµ— Ï„â‚‚â™¯
... | âˆƒ Ï„â‚ ,, Ï„â‚âˆˆÎ³[Ï„â‚â™¯] | âˆƒ Ï„â‚‚ ,, Ï„â‚‚âˆˆÎ³[Ï„â‚‚â™¯] = case âŠ†â‚ (Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚) (Ï„â‚âˆˆÎ³[Ï„â‚â™¯] âŸ¨â†’âŸ© Ï„â‚‚âˆˆÎ³[Ï„â‚‚â™¯]) ğ‘œğ‘“ Î» ()

--------------------------
-- Consistent Subtyping --
--------------------------

syntax lift-P p Ï„â‚â™¯ Ï„â‚‚â™¯ = Ï„â‚â™¯ ~[ p ]~ Ï„â‚‚â™¯
syntax Lift-P r âˆˆÎ³â‚ âˆˆÎ³â‚‚ = âˆˆÎ³â‚ ~[[ r ]]~ âˆˆÎ³â‚‚
data lift-P (p : type â†’ type â†’ Set) (Ï„â‚â™¯ : typeâ™¯) (Ï„â‚‚â™¯ : typeâ™¯) : Set where
  Lift-P : âˆ€ {Ï„â‚ Ï„â‚‚} â†’ p Ï„â‚ Ï„â‚‚ â†’ Ï„â‚ âˆˆÎ³áµ—[ Ï„â‚â™¯ ] â†’ Ï„â‚‚ âˆˆÎ³áµ—[ Ï„â‚‚â™¯ ] â†’ lift-P p Ï„â‚â™¯ Ï„â‚‚â™¯

mono[lift-P] : âˆ€ (p : type â†’ type â†’ Set) â†’ proper (_â‰¼_ â‡‰ _â‰¼_ â‡‰ [â†’]) (lift-P p)
mono[lift-P] p {Ï„â‚â‚â™¯} {Ï„â‚‚â‚â™¯} â‰½â‚ {Ï„â‚â‚‚â™¯} {Ï„â‚‚â‚‚â™¯} â‰½â‚‚ (âˆˆÎ³â‚ ~[[ p[Ï„â‚,Ï„â‚‚] ]]~ âˆˆÎ³â‚‚) = Lift-P p[Ï„â‚,Ï„â‚‚] (mono[âˆˆÎ³áµ—] â‰½â‚ â†¯ âˆˆÎ³â‚) (mono[âˆˆÎ³áµ—] â‰½â‚‚ â†¯ âˆˆÎ³â‚‚)

data is[âŠ¤] : typeâ™¯ â†’ Set where
  âŠ¤ : is[âŠ¤] âŠ¤

data not[âŠ¤] : typeâ™¯ â†’ Set where
  Any : not[âŠ¤] Any
  None : not[âŠ¤] None
  âŸ¨ğ”¹âŸ© : not[âŠ¤] âŸ¨ğ”¹âŸ©
  [âŸ¨â†’âŸ©] : âˆ€ {Ï„â‚ Ï„â‚‚} â†’ not[âŠ¤] (Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚)

dec[âŠ¤] : âˆ€ Ï„ â†’ is[âŠ¤] Ï„ âˆ¨ not[âŠ¤] Ï„
dec[âŠ¤] âŠ¤ = Inl âŠ¤
dec[âŠ¤] Any = Inr Any
dec[âŠ¤] None = Inr None
dec[âŠ¤] âŸ¨ğ”¹âŸ© = Inr âŸ¨ğ”¹âŸ©
dec[âŠ¤] (_ âŸ¨â†’âŸ© _) = Inr [âŸ¨â†’âŸ©]

data _â‹–â™¯_ : typeâ™¯ â†’ typeâ™¯ â†’ Set where
  âŠ¤RÏ„ : âˆ€ {Ï„} â†’ âŠ¤ â‹–â™¯ Ï„
  Ï„RâŠ¤ : âˆ€ {Ï„} â†’ Ï„ â‹–â™¯ âŠ¤
  Any : âˆ€ {Ï„} â†’ not[âŠ¤] Ï„ â†’ Ï„ â‹–â™¯ Any
  None : âˆ€ {Ï„} â†’ not[âŠ¤] Ï„ â†’ None â‹–â™¯ Ï„
  âŸ¨ğ”¹âŸ© : âŸ¨ğ”¹âŸ© â‹–â™¯ âŸ¨ğ”¹âŸ©
  _âŸ¨â†’âŸ©_ : âˆ€ {Ï„â‚â‚ Ï„â‚‚â‚ Ï„â‚â‚‚ Ï„â‚‚â‚‚}
    â†’ Ï„â‚â‚‚ â‹–â™¯ Ï„â‚â‚
    â†’ Ï„â‚‚â‚ â‹–â™¯ Ï„â‚‚â‚‚
    â†’ (Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚) â‹–â™¯ (Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚‚)

xRxâ¸¢â‹–â™¯â¸£ : reflexive _â‹–â™¯_
xRxâ¸¢â‹–â™¯â¸£ {âŠ¤} = âŠ¤RÏ„
xRxâ¸¢â‹–â™¯â¸£ {Any} = Any Any
xRxâ¸¢â‹–â™¯â¸£ {None} = None None
xRxâ¸¢â‹–â™¯â¸£ {âŸ¨ğ”¹âŸ©} = âŸ¨ğ”¹âŸ©
xRxâ¸¢â‹–â™¯â¸£ {Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚} = xRxâ¸¢â‹–â™¯â¸£ âŸ¨â†’âŸ© xRxâ¸¢â‹–â™¯â¸£

instance
  Reflexive[â‹–â™¯] : Reflexive _â‹–â™¯_
  Reflexive[â‹–â™¯] = record { xRx = xRxâ¸¢â‹–â™¯â¸£ }

â‹–â™¯Any : âˆ€ {Ï„} â†’ Ï„ â‹–â™¯ Any
â‹–â™¯Any {âŠ¤} = âŠ¤RÏ„
â‹–â™¯Any {Any} = Any Any
â‹–â™¯Any {None} = Any None
â‹–â™¯Any {âŸ¨ğ”¹âŸ©} = Any âŸ¨ğ”¹âŸ©
â‹–â™¯Any {_ âŸ¨â†’âŸ© _} = Any [âŸ¨â†’âŸ©]

â‹–â™¯None : âˆ€ {Ï„} â†’ None â‹–â™¯ Ï„
â‹–â™¯None {âŠ¤} = Ï„RâŠ¤
â‹–â™¯None {Any} = Any None
â‹–â™¯None {None} = None None
â‹–â™¯None {âŸ¨ğ”¹âŸ©} = None âŸ¨ğ”¹âŸ©
â‹–â™¯None {_ âŸ¨â†’âŸ© _} = None [âŸ¨â†’âŸ©]

mono[â‹–â™¯] : proper (_â‰¼_ â‡‰ _â‰¼_ â‡‰ [â†’]) _â‹–â™¯_
mono[â‹–â™¯] _ Any (Any _) = â‹–â™¯Any
mono[â‹–â™¯] None _ (None _) = â‹–â™¯None
mono[â‹–â™¯] âŸ¨ğ”¹âŸ© âŸ¨ğ”¹âŸ© âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ©
mono[â‹–â™¯] (â‰¼â‚â‚ âŸ¨â†’âŸ© â‰¼â‚‚â‚) (â‰¼â‚â‚‚ âŸ¨â†’âŸ© â‰¼â‚‚â‚‚) (â‹–â‚ âŸ¨â†’âŸ© â‹–â‚‚) = mono[â‹–â™¯] â‰¼â‚â‚‚ â‰¼â‚â‚ â‹–â‚ âŸ¨â†’âŸ© mono[â‹–â™¯] â‰¼â‚‚â‚ â‰¼â‚‚â‚‚ â‹–â‚‚
mono[â‹–â™¯] âŠ¤ _ _ = âŠ¤RÏ„
mono[â‹–â™¯] _ âŠ¤ _ = Ï„RâŠ¤

consistent[â‹–â™¯] : âˆ€ {Ï„â‚â™¯ Ï„â‚‚â™¯} â†’ (Ï„â‚â™¯ â‹–â™¯ Ï„â‚‚â™¯) â†” (Ï„â‚â™¯ ~[ _â‹–_ ]~ Ï„â‚‚â™¯)
consistent[â‹–â™¯] = LHS , RHS
  where
    LHS : âˆ€ {Ï„â‚â™¯ Ï„â‚‚â™¯} â†’ Ï„â‚â™¯ â‹–â™¯ Ï„â‚‚â™¯ â†’ Ï„â‚â™¯ ~[ _â‹–_ ]~ Ï„â‚‚â™¯
    LHS {.âŠ¤} {Ï„â‚‚â™¯} âŠ¤RÏ„ with âˆƒâˆˆÎ³áµ— Ï„â‚‚â™¯
    ... | âˆƒ Ï„ ,, Ï„âˆˆÎ³[Ï„â‚‚â™¯] = âŠ¤ ~[[ xRx ]]~ Ï„âˆˆÎ³[Ï„â‚‚â™¯]
    LHS {Ï„â‚â™¯} {.âŠ¤} Ï„RâŠ¤ with âˆƒâˆˆÎ³áµ— Ï„â‚â™¯
    ... | âˆƒ Ï„ ,, Ï„âˆˆÎ³[Ï„â‚â™¯] = Ï„âˆˆÎ³[Ï„â‚â™¯] ~[[ xRx ]]~ âŠ¤
    LHS {Ï„â‚â™¯} {.Any} (Any _) with âˆƒâˆˆÎ³áµ— Ï„â‚â™¯
    ... | âˆƒ Ï„ ,, Ï„âˆˆÎ³[Ï„â‚â™¯] = Ï„âˆˆÎ³[Ï„â‚â™¯] ~[[ Any ]]~ Any
    LHS {.None} {Ï„â‚‚â™¯} (None _) with âˆƒâˆˆÎ³áµ— Ï„â‚‚â™¯
    ... | âˆƒ Ï„ ,, Ï„âˆˆÎ³[Ï„â‚‚â™¯] = None ~[[ None ]]~ Ï„âˆˆÎ³[Ï„â‚‚â™¯]
    LHS âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ© ~[[ âŸ¨ğ”¹âŸ© ]]~ âŸ¨ğ”¹âŸ©
    LHS (â‹–â™¯â‚ âŸ¨â†’âŸ© â‹–â™¯â‚‚) with LHS â‹–â™¯â‚ | LHS â‹–â™¯â‚‚
    ... | Ï„â‚â‚âˆˆÎ³[Ï„â‚â‚â™¯] ~[[ Ï„â‚â‚<:Ï„â‚â‚‚ ]]~ Ï„â‚â‚‚âˆˆÎ³[Ï„â‚â‚‚â™¯] | Ï„â‚‚â‚âˆˆÎ³[Ï„â‚‚â‚â™¯] ~[[ Ï„â‚‚â‚<:Ï„â‚‚â‚‚ ]]~ Ï„â‚‚â‚‚âˆˆÎ³[Ï„â‚‚â‚‚â™¯] =
      (Ï„â‚â‚‚âˆˆÎ³[Ï„â‚â‚‚â™¯] âŸ¨â†’âŸ© Ï„â‚‚â‚âˆˆÎ³[Ï„â‚‚â‚â™¯]) ~[[ Ï„â‚â‚<:Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚<:Ï„â‚‚â‚‚ ]]~ (Ï„â‚â‚âˆˆÎ³[Ï„â‚â‚â™¯] âŸ¨â†’âŸ© Ï„â‚‚â‚‚âˆˆÎ³[Ï„â‚‚â‚‚â™¯])
    RHS : âˆ€ {Ï„â‚â™¯ Ï„â‚‚â™¯} â†’ Ï„â‚â™¯ ~[ _â‹–_ ]~ Ï„â‚‚â™¯ â†’ Ï„â‚â™¯ â‹–â™¯ Ï„â‚‚â™¯ 
    RHS {Ï„â‚â™¯} {.Any} (Lift-P Any âˆˆÎ³â‚ Any) with dec[âŠ¤] Ï„â‚â™¯
    RHS {.âŠ¤} {.Any} (Lift-P Any âˆˆÎ³â‚ Any) | Inl âŠ¤ = âŠ¤RÏ„
    ... | Inr not[âŠ¤] = Any not[âŠ¤]
    RHS {.None} {Ï„â‚‚â™¯} (Lift-P None None âˆˆÎ³â‚‚) with dec[âŠ¤] Ï„â‚‚â™¯
    RHS {.None} {.âŠ¤} (Lift-P None None âˆˆÎ³â‚‚) | Inl âŠ¤ = Ï„RâŠ¤
    ... | Inr not[âŠ¤] = None not[âŠ¤]
    RHS (Lift-P âŸ¨ğ”¹âŸ© âŸ¨ğ”¹âŸ© âŸ¨ğ”¹âŸ©) = âŸ¨ğ”¹âŸ©
    RHS (Lift-P (<:â‚ âŸ¨â†’âŸ© <:â‚‚) (âˆˆÎ³â‚â‚ âŸ¨â†’âŸ© âˆˆÎ³â‚‚â‚) (âˆˆÎ³â‚â‚‚ âŸ¨â†’âŸ© âˆˆÎ³â‚‚â‚‚)) = RHS (Lift-P <:â‚ âˆˆÎ³â‚â‚‚ âˆˆÎ³â‚â‚) âŸ¨â†’âŸ© RHS (Lift-P <:â‚‚ âˆˆÎ³â‚‚â‚ âˆˆÎ³â‚‚â‚‚)
    RHS (Lift-P _ _ âŠ¤) = Ï„RâŠ¤
    RHS (Lift-P _ âŠ¤ _) = âŠ¤RÏ„

---------------------------
-- Subtype Join and Meet --
---------------------------

mutual
  _âŸ‡â™¯_ : typeâ™¯ â†’ typeâ™¯ â†’ typeâ™¯
  âŠ¤ âŸ‡â™¯ _ = âŠ¤
  _ âŸ‡â™¯ âŠ¤ = âŠ¤
  Any âŸ‡â™¯ _ = Any
  _ âŸ‡â™¯ Any = Any
  None âŸ‡â™¯ Ï„ = Ï„
  Ï„ âŸ‡â™¯ None = Ï„
  âŸ¨ğ”¹âŸ© âŸ‡â™¯ âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ©
  (Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚) âŸ‡â™¯ (Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚‚) = (Ï„â‚â‚ âŸ‘â™¯ Ï„â‚â‚‚) âŸ¨â†’âŸ© (Ï„â‚‚â‚ âŸ‡â™¯ Ï„â‚‚â‚‚)
  âŸ¨ğ”¹âŸ© âŸ‡â™¯ (_ âŸ¨â†’âŸ© _) = Any
  (_ âŸ¨â†’âŸ© _) âŸ‡â™¯ âŸ¨ğ”¹âŸ© = Any

  _âŸ‘â™¯_ : typeâ™¯ â†’ typeâ™¯ â†’ typeâ™¯
  âŠ¤ âŸ‘â™¯ _ = âŠ¤
  _ âŸ‘â™¯ âŠ¤ = âŠ¤
  Any âŸ‘â™¯ Ï„ = Ï„
  Ï„ âŸ‘â™¯ Any = Ï„
  None âŸ‘â™¯ _ = None
  _ âŸ‘â™¯ None = None
  âŸ¨ğ”¹âŸ© âŸ‘â™¯ âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ©
  (Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚) âŸ‘â™¯ (Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚‚) = (Ï„â‚â‚ âŸ‡â™¯ Ï„â‚â‚‚) âŸ¨â†’âŸ© (Ï„â‚‚â‚ âŸ‘â™¯ Ï„â‚‚â‚‚)
  âŸ¨ğ”¹âŸ© âŸ‘â™¯ (y âŸ¨â†’âŸ© yâ‚) = None
  (x âŸ¨â†’âŸ© xâ‚) âŸ‘â™¯ âŸ¨ğ”¹âŸ© = None

zero[âŸ‡â™¯]/âŠ¤ : âˆ€ Ï„ â†’ âŠ¤ âŸ‡â™¯ Ï„ â‰¡ âŠ¤ âˆ§ Ï„ âŸ‡â™¯ âŠ¤ â‰¡ âŠ¤
zero[âŸ‡â™¯]/âŠ¤ âŠ¤ = â†¯ , â†¯
zero[âŸ‡â™¯]/âŠ¤ Any = â†¯ , â†¯
zero[âŸ‡â™¯]/âŠ¤ None = â†¯ , â†¯
zero[âŸ‡â™¯]/âŠ¤ âŸ¨ğ”¹âŸ© = â†¯ , â†¯
zero[âŸ‡â™¯]/âŠ¤ (_ âŸ¨â†’âŸ© _) = â†¯ , â†¯

zero[âŸ‘â™¯]/âŠ¤ : âˆ€ Ï„ â†’ âŠ¤ âŸ‘â™¯ Ï„ â‰¡ âŠ¤ âˆ§ Ï„ âŸ‘â™¯ âŠ¤ â‰¡ âŠ¤
zero[âŸ‘â™¯]/âŠ¤ âŠ¤ = â†¯ , â†¯
zero[âŸ‘â™¯]/âŠ¤ Any = â†¯ , â†¯
zero[âŸ‘â™¯]/âŠ¤ None = â†¯ , â†¯
zero[âŸ‘â™¯]/âŠ¤ âŸ¨ğ”¹âŸ© = â†¯ , â†¯
zero[âŸ‘â™¯]/âŠ¤ (_ âŸ¨â†’âŸ© _) = â†¯ , â†¯

unit[âŸ‡â™¯] : âˆ€ Ï„ â†’ None âŸ‡â™¯ Ï„ â‰¡ Ï„ âˆ§ Ï„ âŸ‡â™¯ None â‰¡ Ï„
unit[âŸ‡â™¯] âŠ¤ = â†¯ , â†¯
unit[âŸ‡â™¯] Any = â†¯ , â†¯
unit[âŸ‡â™¯] None = â†¯ , â†¯
unit[âŸ‡â™¯] âŸ¨ğ”¹âŸ© = â†¯ , â†¯
unit[âŸ‡â™¯] (_ âŸ¨â†’âŸ© _) = â†¯ , â†¯

zero[âŸ‡â™¯]/Â¬âŠ¤ : âˆ€ {Ï„} â†’ not[âŠ¤] Ï„ â†’ Any âŸ‡â™¯ Ï„ â‰¡ Any âˆ§ Ï„ âŸ‡â™¯ Any â‰¡ Any
zero[âŸ‡â™¯]/Â¬âŠ¤ Any = â†¯ , â†¯
zero[âŸ‡â™¯]/Â¬âŠ¤ None = â†¯ , â†¯
zero[âŸ‡â™¯]/Â¬âŠ¤ âŸ¨ğ”¹âŸ© = â†¯ , â†¯
zero[âŸ‡â™¯]/Â¬âŠ¤ [âŸ¨â†’âŸ©] = â†¯ , â†¯

unit[âŸ‘â™¯] : âˆ€ Ï„ â†’ Any âŸ‘â™¯ Ï„ â‰¡ Ï„ âˆ§ Ï„ âŸ‘â™¯ Any â‰¡ Ï„
unit[âŸ‘â™¯] âŠ¤ = â†¯ , â†¯
unit[âŸ‘â™¯] Any = â†¯ , â†¯
unit[âŸ‘â™¯] None = â†¯ , â†¯
unit[âŸ‘â™¯] âŸ¨ğ”¹âŸ© = â†¯ , â†¯
unit[âŸ‘â™¯] (_ âŸ¨â†’âŸ© _) = â†¯ , â†¯

zero[âŸ‘â™¯]/Â¬âŠ¤ : âˆ€ {Ï„} â†’ not[âŠ¤] Ï„ â†’ None âŸ‘â™¯ Ï„ â‰¡ None âˆ§ Ï„ âŸ‘â™¯ None â‰¡ None
zero[âŸ‘â™¯]/Â¬âŠ¤ Any = â†¯ , â†¯
zero[âŸ‘â™¯]/Â¬âŠ¤ None = â†¯ , â†¯
zero[âŸ‘â™¯]/Â¬âŠ¤ âŸ¨ğ”¹âŸ© = â†¯ , â†¯
zero[âŸ‘â™¯]/Â¬âŠ¤ [âŸ¨â†’âŸ©] = â†¯ , â†¯

strengthen[not[âŠ¤]] : âˆ€ {Ï„â‚ Ï„â‚‚ : typeâ™¯} â†’ Ï„â‚ â‰¼ Ï„â‚‚ â†’ not[âŠ¤] Ï„â‚‚ â†’ not[âŠ¤] Ï„â‚
strengthen[not[âŠ¤]] Any Any = Any
strengthen[not[âŠ¤]] None None = None
strengthen[not[âŠ¤]] âŸ¨ğ”¹âŸ© âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ©
strengthen[not[âŠ¤]] (_ âŸ¨â†’âŸ© _) [âŸ¨â†’âŸ©] = [âŸ¨â†’âŸ©]

mutual
  mono[âŸ‡â™¯] : proper (_â‰¼_ â‡‰ _â‰¼_ â‡‰ _â‰¼_) _âŸ‡â™¯_
  mono[âŸ‡â™¯] {_} {Ï„â‚} _ {_} {Ï„â‚‚} _ with dec[âŠ¤] Ï„â‚ | dec[âŠ¤] Ï„â‚‚
  mono[âŸ‡â™¯] _ _ | Inl âŠ¤ | _ = âŠ¤
  mono[âŸ‡â™¯] {_} {Ï„â‚} _ _ | _ | Inl âŠ¤ rewrite Ï€â‚‚ (zero[âŸ‡â™¯]/âŠ¤ Ï„â‚) = âŠ¤
  mono[âŸ‡â™¯] Any â‰¼â‚‚ | Inr Any | Inr not[âŠ¤]â‚‚ rewrite Ï€â‚ (zero[âŸ‡â™¯]/Â¬âŠ¤ (strengthen[not[âŠ¤]] â‰¼â‚‚ not[âŠ¤]â‚‚)) | Ï€â‚ (zero[âŸ‡â™¯]/Â¬âŠ¤ not[âŠ¤]â‚‚) = Any
  mono[âŸ‡â™¯] â‰¼â‚ Any | Inr not[âŠ¤]â‚ | Inr Any rewrite Ï€â‚‚ (zero[âŸ‡â™¯]/Â¬âŠ¤ (strengthen[not[âŠ¤]] â‰¼â‚ not[âŠ¤]â‚)) | Ï€â‚‚ (zero[âŸ‡â™¯]/Â¬âŠ¤ not[âŠ¤]â‚) = Any
  mono[âŸ‡â™¯] None {Ï„â‚} {Ï„â‚‚} â‰¼â‚‚ | Inr None | Inr _ rewrite Ï€â‚ (unit[âŸ‡â™¯] Ï„â‚) | Ï€â‚ (unit[âŸ‡â™¯] Ï„â‚‚) = â‰¼â‚‚
  mono[âŸ‡â™¯] {Ï„â‚} {Ï„â‚‚} â‰¼â‚ None | Inr _ | Inr None rewrite Ï€â‚‚ (unit[âŸ‡â™¯] Ï„â‚) | Ï€â‚‚ (unit[âŸ‡â™¯] Ï„â‚‚) = â‰¼â‚
  mono[âŸ‡â™¯] âŸ¨ğ”¹âŸ© âŸ¨ğ”¹âŸ© | Inr âŸ¨ğ”¹âŸ© | Inr âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ©
  mono[âŸ‡â™¯] (â‰¼â‚â‚ âŸ¨â†’âŸ© â‰¼â‚‚â‚) (â‰¼â‚â‚‚ âŸ¨â†’âŸ© â‰¼â‚‚â‚‚) | Inr [âŸ¨â†’âŸ©] | Inr [âŸ¨â†’âŸ©] = mono[âŸ‘â™¯] â‰¼â‚â‚ â‰¼â‚â‚‚ âŸ¨â†’âŸ© mono[âŸ‡â™¯] â‰¼â‚‚â‚ â‰¼â‚‚â‚‚
  mono[âŸ‡â™¯] âŸ¨ğ”¹âŸ© (_ âŸ¨â†’âŸ© _) | Inr âŸ¨ğ”¹âŸ© | Inr [âŸ¨â†’âŸ©] = Any
  mono[âŸ‡â™¯] (_ âŸ¨â†’âŸ© _) âŸ¨ğ”¹âŸ© | Inr [âŸ¨â†’âŸ©] | Inr âŸ¨ğ”¹âŸ© = Any

  mono[âŸ‘â™¯] : proper (_â‰¼_ â‡‰ _â‰¼_ â‡‰ _â‰¼_) _âŸ‘â™¯_
  mono[âŸ‘â™¯] {_} {Ï„â‚} _ {_} {Ï„â‚‚} _ with dec[âŠ¤] Ï„â‚ | dec[âŠ¤] Ï„â‚‚
  mono[âŸ‘â™¯] _ _ | Inl âŠ¤ | _ = âŠ¤
  mono[âŸ‘â™¯] {_} {Ï„â‚} _ _ | _ | Inl âŠ¤ rewrite Ï€â‚‚ (zero[âŸ‘â™¯]/âŠ¤ Ï„â‚) = âŠ¤
  mono[âŸ‘â™¯] Any {Ï„â‚} {Ï„â‚‚} â‰¼â‚‚ | Inr Any | Inr _ rewrite Ï€â‚ (unit[âŸ‘â™¯] Ï„â‚) | Ï€â‚ (unit[âŸ‘â™¯] Ï„â‚‚) = â‰¼â‚‚
  mono[âŸ‘â™¯] {Ï„â‚} {Ï„â‚‚} â‰¼â‚ Any | Inr _ | Inr Any rewrite Ï€â‚‚ (unit[âŸ‘â™¯] Ï„â‚) | Ï€â‚‚ (unit[âŸ‘â™¯] Ï„â‚‚) = â‰¼â‚
  mono[âŸ‘â™¯] None â‰¼â‚‚ | Inr None | Inr not[âŠ¤]â‚‚ rewrite Ï€â‚ (zero[âŸ‘â™¯]/Â¬âŠ¤ (strengthen[not[âŠ¤]] â‰¼â‚‚ not[âŠ¤]â‚‚)) | Ï€â‚ (zero[âŸ‘â™¯]/Â¬âŠ¤ not[âŠ¤]â‚‚) = None
  mono[âŸ‘â™¯] â‰¼â‚ None | Inr not[âŠ¤]â‚ | Inr None rewrite Ï€â‚‚ (zero[âŸ‘â™¯]/Â¬âŠ¤ (strengthen[not[âŠ¤]] â‰¼â‚ not[âŠ¤]â‚)) | Ï€â‚‚ (zero[âŸ‘â™¯]/Â¬âŠ¤ not[âŠ¤]â‚) = None
  mono[âŸ‘â™¯] âŸ¨ğ”¹âŸ© âŸ¨ğ”¹âŸ© | Inr âŸ¨ğ”¹âŸ© | Inr âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ©
  mono[âŸ‘â™¯] (â‰¼â‚â‚ âŸ¨â†’âŸ© â‰¼â‚‚â‚) (â‰¼â‚â‚‚ âŸ¨â†’âŸ© â‰¼â‚‚â‚‚) | Inr [âŸ¨â†’âŸ©] | Inr [âŸ¨â†’âŸ©] = mono[âŸ‡â™¯] â‰¼â‚â‚ â‰¼â‚â‚‚ âŸ¨â†’âŸ© mono[âŸ‘â™¯] â‰¼â‚‚â‚ â‰¼â‚‚â‚‚
  mono[âŸ‘â™¯] âŸ¨ğ”¹âŸ© (_ âŸ¨â†’âŸ© _) | Inr âŸ¨ğ”¹âŸ© | Inr [âŸ¨â†’âŸ©] = None
  mono[âŸ‘â™¯] (_ âŸ¨â†’âŸ© _) âŸ¨ğ”¹âŸ© | Inr [âŸ¨â†’âŸ©] | Inr âŸ¨ğ”¹âŸ© = None

not[âŠ¤][Î·] : âˆ€ Ï„ â†’ not[âŠ¤] (Î·áµ— Ï„)
not[âŠ¤][Î·] Any = Any
not[âŠ¤][Î·] None = None
not[âŠ¤][Î·] âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ©
not[âŠ¤][Î·] (_ âŸ¨â†’âŸ© _) = [âŸ¨â†’âŸ©]

mutual
  correct[âŸ‡â™¯] : âˆ€ Ï„â‚ Ï„â‚‚ â†’ Î·áµ— (Ï„â‚ âŸ‡ Ï„â‚‚) â‰¡ (Î·áµ— Ï„â‚ âŸ‡â™¯ Î·áµ— Ï„â‚‚)
  correct[âŸ‡â™¯] Any Ï„â‚‚ rewrite Ï€â‚ (zero[âŸ‡â™¯]/Â¬âŠ¤ (not[âŠ¤][Î·] Ï„â‚‚)) = â†¯
  correct[âŸ‡â™¯] Ï„â‚ Any rewrite Ï€â‚‚ (zero[âŸ‡] Ï„â‚) | Ï€â‚‚ (zero[âŸ‡â™¯]/Â¬âŠ¤ (not[âŠ¤][Î·] Ï„â‚)) = â†¯
  correct[âŸ‡â™¯] None Ï„â‚‚ rewrite Ï€â‚ (unit[âŸ‡] Ï„â‚‚) | Ï€â‚ (unit[âŸ‡â™¯] (Î·áµ— Ï„â‚‚)) = â†¯
  correct[âŸ‡â™¯] Ï„â‚ None rewrite Ï€â‚‚ (unit[âŸ‡] Ï„â‚) | Ï€â‚‚ (unit[âŸ‡â™¯] (Î·áµ— Ï„â‚)) = â†¯
  correct[âŸ‡â™¯] âŸ¨ğ”¹âŸ© âŸ¨ğ”¹âŸ© = â†¯
  correct[âŸ‡â™¯] (Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚) (Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚‚) rewrite correct[âŸ‘â™¯] Ï„â‚â‚ Ï„â‚â‚‚ | correct[âŸ‡â™¯] Ï„â‚‚â‚ Ï„â‚‚â‚‚ = â†¯
  correct[âŸ‡â™¯] âŸ¨ğ”¹âŸ© (_ âŸ¨â†’âŸ© _) = â†¯
  correct[âŸ‡â™¯] (_ âŸ¨â†’âŸ© _) âŸ¨ğ”¹âŸ© = â†¯

  correct[âŸ‘â™¯] : âˆ€ Ï„â‚ Ï„â‚‚ â†’ Î·áµ— (Ï„â‚ âŸ‘ Ï„â‚‚) â‰¡ (Î·áµ— Ï„â‚ âŸ‘â™¯ Î·áµ— Ï„â‚‚)
  correct[âŸ‘â™¯] Any Ï„â‚‚ rewrite Ï€â‚ (unit[âŸ‘â™¯] (Î·áµ— Ï„â‚‚)) = â†¯
  correct[âŸ‘â™¯] Ï„â‚ Any rewrite Ï€â‚‚ (unit[âŸ‘] Ï„â‚) | Ï€â‚‚ (unit[âŸ‘â™¯] (Î·áµ— Ï„â‚)) = â†¯
  correct[âŸ‘â™¯] None Ï„â‚‚ rewrite Ï€â‚ (zero[âŸ‘] Ï„â‚‚) | Ï€â‚ (zero[âŸ‘â™¯]/Â¬âŠ¤ (not[âŠ¤][Î·] Ï„â‚‚)) = â†¯
  correct[âŸ‘â™¯] Ï„â‚ None rewrite Ï€â‚‚ (zero[âŸ‘] Ï„â‚) | Ï€â‚‚ (zero[âŸ‘â™¯]/Â¬âŠ¤ (not[âŠ¤][Î·] Ï„â‚)) = â†¯
  correct[âŸ‘â™¯] âŸ¨ğ”¹âŸ© âŸ¨ğ”¹âŸ© = â†¯
  correct[âŸ‘â™¯] (Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚) (Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚‚) rewrite correct[âŸ‡â™¯] Ï„â‚â‚ Ï„â‚â‚‚ | correct[âŸ‘â™¯] Ï„â‚‚â‚ Ï„â‚‚â‚‚ = â†¯
  correct[âŸ‘â™¯] âŸ¨ğ”¹âŸ© (_ âŸ¨â†’âŸ© _) = â†¯
  correct[âŸ‘â™¯] (_ âŸ¨â†’âŸ© _) âŸ¨ğ”¹âŸ© = â†¯

mutual
  weaken[â‹–â™¯][_] : âˆ€ {Ï„â‚ Ï„â‚‚} Ï„â‚ƒ â†’ Ï„â‚ â‹–â™¯ Ï„â‚‚ â†’ Ï„â‚ â‹–â™¯ (Ï„â‚‚ âŸ‡â™¯ Ï„â‚ƒ) âˆ§ Ï„â‚ â‹–â™¯ (Ï„â‚ƒ âŸ‡â™¯ Ï„â‚‚)
  weaken[â‹–â™¯][ _ ] âŠ¤RÏ„ = âŠ¤RÏ„ , âŠ¤RÏ„
  weaken[â‹–â™¯][ Ï„â‚ƒ ] Ï„RâŠ¤ rewrite Ï€â‚‚ (zero[âŸ‡â™¯]/âŠ¤ Ï„â‚ƒ) = Ï„RâŠ¤ , Ï„RâŠ¤
  weaken[â‹–â™¯][ Ï„â‚ƒ ] (Any _) with dec[âŠ¤] Ï„â‚ƒ
  weaken[â‹–â™¯][ .âŠ¤ ] (Any _) | Inl âŠ¤ = Ï„RâŠ¤ , Ï„RâŠ¤
  weaken[â‹–â™¯][ _ ] (Any _) | Inr not[âŠ¤]â‚ƒ rewrite Ï€â‚ (zero[âŸ‡â™¯]/Â¬âŠ¤ not[âŠ¤]â‚ƒ) | Ï€â‚‚ (zero[âŸ‡â™¯]/Â¬âŠ¤ not[âŠ¤]â‚ƒ) = â‹–â™¯Any , â‹–â™¯Any
  weaken[â‹–â™¯][ _ ] (None _) = â‹–â™¯None , â‹–â™¯None
  weaken[â‹–â™¯][ Any ] âŸ¨ğ”¹âŸ© = Any âŸ¨ğ”¹âŸ© , Any âŸ¨ğ”¹âŸ©
  weaken[â‹–â™¯][ None ] âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ© , âŸ¨ğ”¹âŸ©
  weaken[â‹–â™¯][ âŸ¨ğ”¹âŸ© ] âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ© , âŸ¨ğ”¹âŸ©
  weaken[â‹–â™¯][ _ âŸ¨â†’âŸ© _ ] âŸ¨ğ”¹âŸ© = Any âŸ¨ğ”¹âŸ© , Any âŸ¨ğ”¹âŸ©
  weaken[â‹–â™¯][ Any ] (_ âŸ¨â†’âŸ© _) = Any [âŸ¨â†’âŸ©] , Any [âŸ¨â†’âŸ©]
  weaken[â‹–â™¯][ None ] (â‹–â‚ âŸ¨â†’âŸ© â‹–â‚‚) = â‹–â‚ âŸ¨â†’âŸ© â‹–â‚‚ , â‹–â‚ âŸ¨â†’âŸ© â‹–â‚‚
  weaken[â‹–â™¯][ âŸ¨ğ”¹âŸ© ] (_ âŸ¨â†’âŸ© _) = Any [âŸ¨â†’âŸ©] , Any [âŸ¨â†’âŸ©]
  weaken[â‹–â™¯][ Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚ ] (â‹–â‚ âŸ¨â†’âŸ© â‹–â‚‚) = Ï€â‚ (strengthen[â‹–â™¯][ Ï„â‚ ] â‹–â‚) âŸ¨â†’âŸ© Ï€â‚ (weaken[â‹–â™¯][ Ï„â‚‚ ] â‹–â‚‚) , Ï€â‚‚ (strengthen[â‹–â™¯][ Ï„â‚ ] â‹–â‚) âŸ¨â†’âŸ© Ï€â‚‚ (weaken[â‹–â™¯][ Ï„â‚‚ ] â‹–â‚‚)
  weaken[â‹–â™¯][_] {_} {Ï„â‚‚} âŠ¤ _ rewrite Ï€â‚‚ (zero[âŸ‡â™¯]/âŠ¤ Ï„â‚‚) = Ï„RâŠ¤ , Ï„RâŠ¤

  strengthen[â‹–â™¯][_] : âˆ€ {Ï„â‚ Ï„â‚‚} Ï„â‚ƒ â†’ Ï„â‚ â‹–â™¯ Ï„â‚‚ â†’ (Ï„â‚ âŸ‘â™¯ Ï„â‚ƒ) â‹–â™¯ Ï„â‚‚ âˆ§ (Ï„â‚ƒ âŸ‘â™¯ Ï„â‚) â‹–â™¯ Ï„â‚‚
  strengthen[â‹–â™¯][ Ï„â‚ƒ ] âŠ¤RÏ„ rewrite Ï€â‚‚ (zero[âŸ‘â™¯]/âŠ¤ Ï„â‚ƒ) = âŠ¤RÏ„ , âŠ¤RÏ„
  strengthen[â‹–â™¯][ _ ] Ï„RâŠ¤ = Ï„RâŠ¤ , Ï„RâŠ¤
  strengthen[â‹–â™¯][ Ï„â‚ƒ ] (Any _) = â‹–â™¯Any , â‹–â™¯Any
  strengthen[â‹–â™¯][ Ï„â‚ƒ ] (None _) with dec[âŠ¤] Ï„â‚ƒ
  strengthen[â‹–â™¯][ .âŠ¤ ] (None _) | Inl âŠ¤ = âŠ¤RÏ„ , âŠ¤RÏ„
  strengthen[â‹–â™¯][ _ ] (None _) | Inr not[âŠ¤]â‚ƒ rewrite Ï€â‚ (zero[âŸ‘â™¯]/Â¬âŠ¤ not[âŠ¤]â‚ƒ) | Ï€â‚‚ (zero[âŸ‘â™¯]/Â¬âŠ¤ not[âŠ¤]â‚ƒ) = â‹–â™¯None , â‹–â™¯None
  strengthen[â‹–â™¯][ Any ] âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ© , âŸ¨ğ”¹âŸ©
  strengthen[â‹–â™¯][ None ] âŸ¨ğ”¹âŸ© = None âŸ¨ğ”¹âŸ© , None âŸ¨ğ”¹âŸ©
  strengthen[â‹–â™¯][ âŸ¨ğ”¹âŸ© ] âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ© , âŸ¨ğ”¹âŸ©
  strengthen[â‹–â™¯][ _ âŸ¨â†’âŸ© _ ] âŸ¨ğ”¹âŸ© = None âŸ¨ğ”¹âŸ© , None âŸ¨ğ”¹âŸ©
  strengthen[â‹–â™¯][ Any ] (â‹–â‚ âŸ¨â†’âŸ© â‹–â‚‚) = â‹–â‚ âŸ¨â†’âŸ© â‹–â‚‚ , â‹–â‚ âŸ¨â†’âŸ© â‹–â‚‚
  strengthen[â‹–â™¯][ None ] (_ âŸ¨â†’âŸ© _) = None [âŸ¨â†’âŸ©] , None [âŸ¨â†’âŸ©]
  strengthen[â‹–â™¯][ âŸ¨ğ”¹âŸ© ] (_ âŸ¨â†’âŸ© _) = None [âŸ¨â†’âŸ©] , None [âŸ¨â†’âŸ©]
  strengthen[â‹–â™¯][ Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚ ] (â‹–â‚€ âŸ¨â†’âŸ© â‹–â‚) = Ï€â‚ (weaken[â‹–â™¯][ Ï„â‚ ] â‹–â‚€) âŸ¨â†’âŸ© Ï€â‚ (strengthen[â‹–â™¯][ Ï„â‚‚ ] â‹–â‚) , Ï€â‚‚ (weaken[â‹–â™¯][ Ï„â‚ ] â‹–â‚€) âŸ¨â†’âŸ© Ï€â‚‚ (strengthen[â‹–â™¯][ Ï„â‚‚ ] â‹–â‚)
  strengthen[â‹–â™¯][_] {Ï„â‚} âŠ¤ _ rewrite Ï€â‚‚ (zero[âŸ‘â™¯]/âŠ¤ Ï„â‚) = âŠ¤RÏ„ , âŠ¤RÏ„

weaken[â‹–â™¯]/L[_] : âˆ€ {Ï„â‚ Ï„â‚‚} Ï„â‚ƒ â†’ Ï„â‚ â‹–â™¯ Ï„â‚‚ â†’ Ï„â‚ â‹–â™¯ (Ï„â‚‚ âŸ‡â™¯ Ï„â‚ƒ)
weaken[â‹–â™¯]/L[ Ï„ ] â‹–â‚€ = Ï€â‚ (weaken[â‹–â™¯][ Ï„ ] â‹–â‚€)

weaken[â‹–â™¯]/R[_] : âˆ€ {Ï„â‚ Ï„â‚‚} Ï„â‚ƒ â†’ Ï„â‚ â‹–â™¯ Ï„â‚‚ â†’ Ï„â‚ â‹–â™¯ (Ï„â‚ƒ âŸ‡â™¯ Ï„â‚‚)
weaken[â‹–â™¯]/R[ Ï„ ] â‹–â‚€ = Ï€â‚‚ (weaken[â‹–â™¯][ Ï„ ] â‹–â‚€)

strengthen[â‹–â™¯]/L[_] : âˆ€ {Ï„â‚ Ï„â‚‚} Ï„â‚ƒ â†’ Ï„â‚ â‹–â™¯ Ï„â‚‚ â†’ (Ï„â‚ âŸ‘â™¯ Ï„â‚ƒ) â‹–â™¯ Ï„â‚‚
strengthen[â‹–â™¯]/L[ Ï„ ] â‹–â‚€ = Ï€â‚ (strengthen[â‹–â™¯][ Ï„ ] â‹–â‚€)

strengthen[â‹–â™¯]/R[_] : âˆ€ {Ï„â‚ Ï„â‚‚} Ï„â‚ƒ â†’ Ï„â‚ â‹–â™¯ Ï„â‚‚ â†’ (Ï„â‚ƒ âŸ‘â™¯ Ï„â‚) â‹–â™¯ Ï„â‚‚
strengthen[â‹–â™¯]/R[ Ï„ ] â‹–â‚€ = Ï€â‚‚ (strengthen[â‹–â™¯][ Ï„ ] â‹–â‚€)

---------------
-- Interiors --
---------------

data âŸ¨_,_âŸ©âˆˆIâŸ¨_,_âŸ© : typeâ™¯ â†’ typeâ™¯ â†’ typeâ™¯ â†’ typeâ™¯ â†’ Set where
  âŠ¤ :
    âŸ¨ âŠ¤ , âŠ¤ âŸ©âˆˆIâŸ¨ âŠ¤ , âŠ¤ âŸ©
  Any,âŠ¤ :
    âŸ¨ Any , Any âŸ©âˆˆIâŸ¨ Any , âŠ¤ âŸ©
  Ï„,Any : âˆ€ {Ï„}
    â†’ âŸ¨ Ï„ , Any âŸ©âˆˆIâŸ¨ Ï„ , Any âŸ©
  None,Ï„ : âˆ€ {Ï„}
    â†’ âŸ¨ None , Ï„ âŸ©âˆˆIâŸ¨ None , Ï„ âŸ©
  âŠ¤,None :
    âŸ¨ None , None âŸ©âˆˆIâŸ¨ âŠ¤ , None âŸ©
  âŸ¨ğ”¹âŸ©,âŠ¤ :
    âŸ¨ âŸ¨ğ”¹âŸ© , âŸ¨ğ”¹âŸ© âŸ©âˆˆIâŸ¨ âŸ¨ğ”¹âŸ© , âŠ¤ âŸ©
  âŠ¤,âŸ¨ğ”¹âŸ© :
    âŸ¨ âŸ¨ğ”¹âŸ© , âŸ¨ğ”¹âŸ© âŸ©âˆˆIâŸ¨ âŠ¤ , âŸ¨ğ”¹âŸ© âŸ©
  âŸ¨ğ”¹âŸ© :
    âŸ¨ âŸ¨ğ”¹âŸ© , âŸ¨ğ”¹âŸ© âŸ©âˆˆIâŸ¨ âŸ¨ğ”¹âŸ© , âŸ¨ğ”¹âŸ© âŸ©
  _âŸ¨â†’âŸ©âŠ¤_ : âˆ€ {Ï„â‚â‚ Ï„â‚‚â‚ Ï„â‚â‚á´µ Ï„â‚‚â‚á´µ Ï„â‚â‚‚á´µ Ï„â‚‚â‚‚á´µ} 
    â†’ âŸ¨ Ï„â‚â‚‚á´µ , Ï„â‚â‚á´µ âŸ©âˆˆIâŸ¨ âŠ¤ , Ï„â‚â‚ âŸ©
    â†’ âŸ¨ Ï„â‚‚â‚á´µ , Ï„â‚‚â‚‚á´µ âŸ©âˆˆIâŸ¨ Ï„â‚‚â‚ , âŠ¤ âŸ©
    â†’ âŸ¨ Ï„â‚â‚á´µ âŸ¨â†’âŸ© Ï„â‚‚â‚á´µ , Ï„â‚â‚‚á´µ âŸ¨â†’âŸ© Ï„â‚‚â‚‚á´µ âŸ©âˆˆIâŸ¨ Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚ , âŠ¤ âŸ©
  _âŠ¤âŸ¨â†’âŸ©_ : âˆ€ {Ï„â‚â‚‚ Ï„â‚‚â‚‚ Ï„â‚â‚á´µ Ï„â‚‚â‚á´µ Ï„â‚â‚‚á´µ Ï„â‚‚â‚‚á´µ}
    â†’ âŸ¨ Ï„â‚â‚‚á´µ , Ï„â‚â‚á´µ âŸ©âˆˆIâŸ¨ Ï„â‚â‚‚ , âŠ¤ âŸ©
    â†’ âŸ¨ Ï„â‚‚â‚á´µ , Ï„â‚‚â‚‚á´µ âŸ©âˆˆIâŸ¨ âŠ¤ , Ï„â‚‚â‚‚ âŸ©
    â†’ âŸ¨ Ï„â‚â‚á´µ âŸ¨â†’âŸ© Ï„â‚‚â‚á´µ , Ï„â‚â‚‚á´µ âŸ¨â†’âŸ© Ï„â‚‚â‚‚á´µ âŸ©âˆˆIâŸ¨ âŠ¤ , Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚‚ âŸ©
  _âŸ¨â†’âŸ©_ : âˆ€ {Ï„â‚â‚ Ï„â‚‚â‚ Ï„â‚â‚‚ Ï„â‚‚â‚‚ Ï„â‚â‚á´µ Ï„â‚‚â‚á´µ Ï„â‚â‚‚á´µ Ï„â‚‚â‚‚á´µ}
    â†’ âŸ¨ Ï„â‚â‚‚á´µ , Ï„â‚â‚á´µ âŸ©âˆˆIâŸ¨ Ï„â‚â‚‚ , Ï„â‚â‚ âŸ©
    â†’ âŸ¨ Ï„â‚‚â‚á´µ , Ï„â‚‚â‚‚á´µ âŸ©âˆˆIâŸ¨ Ï„â‚‚â‚ , Ï„â‚‚â‚‚ âŸ©
    â†’ âŸ¨ Ï„â‚â‚á´µ âŸ¨â†’âŸ© Ï„â‚‚â‚á´µ , Ï„â‚â‚‚á´µ âŸ¨â†’âŸ© Ï„â‚‚â‚‚á´µ âŸ©âˆˆIâŸ¨ Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚ , Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚‚ âŸ©

data âˆƒIâŸ¨_,_âŸ© : typeâ™¯ â†’ typeâ™¯ â†’ Set where
  âˆƒI : âˆ€ {Ï„â‚ Ï„â‚‚ Ï„â‚á´µ Ï„â‚‚á´µ} â†’ âŸ¨ Ï„â‚á´µ , Ï„â‚‚á´µ âŸ©âˆˆIâŸ¨ Ï„â‚ , Ï„â‚‚ âŸ© â†’ âˆƒIâŸ¨ Ï„â‚ , Ï„â‚‚ âŸ©

correct[I] : âˆ€ {Ï„â‚ Ï„â‚‚} â†’ Ï„â‚ â‹–â™¯ Ï„â‚‚ â†” âˆƒIâŸ¨ Ï„â‚ , Ï„â‚‚ âŸ©
correct[I] = LHS , RHS
  where
    LHS : âˆ€ {Ï„â‚ Ï„â‚‚} â†’ Ï„â‚ â‹–â™¯ Ï„â‚‚ â†’ âˆƒIâŸ¨ Ï„â‚ , Ï„â‚‚ âŸ©
    LHS {âŠ¤} {âŠ¤} âŠ¤RÏ„ = âˆƒI âŠ¤
    LHS {âŠ¤} {Any} âŠ¤RÏ„ = âˆƒI Ï„,Any
    LHS {âŠ¤} {None} âŠ¤RÏ„ = âˆƒI âŠ¤,None
    LHS {âŠ¤} {âŸ¨ğ”¹âŸ©} âŠ¤RÏ„ = âˆƒI âŠ¤,âŸ¨ğ”¹âŸ©
    LHS {âŠ¤} {Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚} âŠ¤RÏ„ with LHS {Ï„â‚} {âŠ¤} Ï„RâŠ¤ | LHS {âŠ¤} {Ï„â‚‚} âŠ¤RÏ„
    ... | âˆƒI Iâ‚ | âˆƒI Iâ‚‚ = âˆƒI (Iâ‚ âŠ¤âŸ¨â†’âŸ© Iâ‚‚)
    LHS {âŠ¤} {âŠ¤} Ï„RâŠ¤ = âˆƒI âŠ¤
    LHS {Any} {âŠ¤} Ï„RâŠ¤ = âˆƒI Any,âŠ¤
    LHS {None} {âŠ¤} Ï„RâŠ¤ = âˆƒI None,Ï„
    LHS {âŸ¨ğ”¹âŸ©} {âŠ¤} Ï„RâŠ¤ = âˆƒI âŸ¨ğ”¹âŸ©,âŠ¤
    LHS {Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚} {âŠ¤} Ï„RâŠ¤ with LHS {âŠ¤} {Ï„â‚} âŠ¤RÏ„ | LHS {Ï„â‚‚} {âŠ¤} Ï„RâŠ¤
    ... | âˆƒI Iâ‚ | âˆƒI Iâ‚‚ = âˆƒI (Iâ‚ âŸ¨â†’âŸ©âŠ¤ Iâ‚‚)
    LHS {Ï„â‚} {Any} (Any _) = âˆƒI Ï„,Any
    LHS {None} {Ï„â‚‚} (None _) = âˆƒI None,Ï„
    LHS âŸ¨ğ”¹âŸ© = âˆƒI âŸ¨ğ”¹âŸ©
    LHS (â‹–â™¯â‚ âŸ¨â†’âŸ© â‹–â™¯â‚‚) with LHS â‹–â™¯â‚ | LHS â‹–â™¯â‚‚
    ... | âˆƒI Iâ‚ | âˆƒI Iâ‚‚ = âˆƒI (Iâ‚ âŸ¨â†’âŸ© Iâ‚‚)

    RHS : âˆ€ {Ï„â‚ Ï„â‚‚} â†’ âˆƒIâŸ¨ Ï„â‚ , Ï„â‚‚ âŸ© â†’ Ï„â‚ â‹–â™¯ Ï„â‚‚
    RHS (âˆƒI âŠ¤) = âŠ¤RÏ„
    RHS (âˆƒI Any,âŠ¤) = Ï„RâŠ¤
    RHS (âˆƒI Ï„,Any) = â‹–â™¯Any
    RHS (âˆƒI None,Ï„) = â‹–â™¯None
    RHS (âˆƒI âŠ¤,None) = âŠ¤RÏ„
    RHS (âˆƒI âŸ¨ğ”¹âŸ©,âŠ¤) = Ï„RâŠ¤
    RHS (âˆƒI âŠ¤,âŸ¨ğ”¹âŸ©) = âŠ¤RÏ„
    RHS (âˆƒI âŸ¨ğ”¹âŸ©) = âŸ¨ğ”¹âŸ©
    RHS (âˆƒI (Iâ‚ âŸ¨â†’âŸ©âŠ¤ Iâ‚‚)) = Ï„RâŠ¤
    RHS (âˆƒI (Iâ‚ âŠ¤âŸ¨â†’âŸ© Iâ‚‚)) = âŠ¤RÏ„
    RHS (âˆƒI (Iâ‚ âŸ¨â†’âŸ© Iâ‚‚)) = RHS (âˆƒI Iâ‚) âŸ¨â†’âŸ© RHS (âˆƒI Iâ‚‚)

Â¬âŠ¤âˆƒ : âˆ€ {Ï„â™¯} â†’ not[âŠ¤] Ï„â™¯ â†’ âˆƒ Ï„ ğ‘ ğ‘¡ not (Î·áµ— Ï„ â‰¼ Ï„â™¯)
Â¬âŠ¤âˆƒ Any = âˆƒ None ,, Î» ()
Â¬âŠ¤âˆƒ None = âˆƒ âŸ¨ğ”¹âŸ© ,, Î» ()
Â¬âŠ¤âˆƒ âŸ¨ğ”¹âŸ© = âˆƒ None ,, Î» ()
Â¬âŠ¤âˆƒ [âŸ¨â†’âŸ©] = âˆƒ None ,, Î» ()

-----------
-- Terms --
-----------

data contextâ™¯ : Set where
  [] : contextâ™¯
  _âˆ·_ : typeâ™¯ â†’ contextâ™¯ â†’ contextâ™¯

data _â‹³â™¯_ : typeâ™¯ â†’ contextâ™¯ â†’ Set where
  Zero : âˆ€ {Î“ Ï„} â†’ Ï„ â‹³â™¯ (Ï„ âˆ· Î“)
  Succ : âˆ€ {Î“ Ï„â‚ Ï„â‚‚} â†’ Ï„â‚ â‹³â™¯ Î“ â†’ Ï„â‚ â‹³â™¯ (Ï„â‚‚ âˆ· Î“)

mutual
  data _âŠ¢â™¯_ : contextâ™¯ â†’ typeâ™¯ â†’ Set where
    âŸ¨ğ”¹âŸ© : âˆ€ {Î“} â†’ ğ”¹ â†’ Î“ âŠ¢â™¯ âŸ¨ğ”¹âŸ©
    âŸ¨ifâŸ©_âŸ¨thenâŸ©_âŸ¨elseâŸ©_ : âˆ€ {Î“ Ï„â‚‚ Ï„â‚ƒ}
      â†’ Î“ âŠ¢â¦‚â™¯ âŸ¨ğ”¹âŸ©
      â†’ Î“ âŠ¢â¦‚â™¯ Ï„â‚‚
      â†’ Î“ âŠ¢â¦‚â™¯ Ï„â‚ƒ
      â†’ Î“ âŠ¢â™¯ Ï„â‚‚ âŸ‡â™¯ Ï„â‚ƒ
    Var : âˆ€ {Î“ Ï„}
      â†’ Ï„ â‹³â™¯ Î“
      â†’ Î“ âŠ¢â™¯ Ï„
    âŸ¨Î»âŸ© : âˆ€ {Î“ Ï„â‚ Ï„â‚‚}
      â†’ Ï„â‚ âˆ· Î“ âŠ¢â™¯ Ï„â‚‚
      â†’ Î“ âŠ¢â™¯ Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚
    _âŸ¨â‹…âŸ©_ : âˆ€ {Î“ Ï„â‚ Ï„â‚‚}
      â†’ Î“ âŠ¢â¦‚â™¯ Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚
      â†’ Î“ âŠ¢â¦‚â™¯ Ï„â‚
      â†’ Î“ âŠ¢â™¯ Ï„â‚‚
    âŸª_âŸ« : âˆ€ {Î“ Ï„}
      â†’ Î“ âŠ¢â¦‚â™¯ Ï„
      â†’ Î“ âŠ¢â™¯ Ï„
  data _âŠ¢â¦‚â™¯_ : contextâ™¯ â†’ typeâ™¯ â†’ Set where
    _â¦‚â¦‚_ : âˆ€ {Î“ Ï„â‚ Ï„â‚‚}
      â†’ Î“ âŠ¢â™¯ Ï„â‚
      â†’ Ï„â‚ â‹–â™¯ Ï„â‚‚
      â†’ Î“ âŠ¢â¦‚â™¯ Ï„â‚‚

--------------
-- Renaming --
--------------

data _âŠ²â™¯_ : contextâ™¯ â†’ contextâ™¯ â†’ Set where
  [] : âˆ€ {Î“} â†’ [] âŠ²â™¯ Î“ 
  _âˆ·_ : âˆ€ {Î“â‚ Î“â‚‚ Ï„} â†’ Ï„ â‹³â™¯ Î“â‚‚ â†’ Î“â‚ âŠ²â™¯ Î“â‚‚ â†’ Ï„ âˆ· Î“â‚ âŠ²â™¯ Î“â‚‚

rename[â‹³â™¯][_] : âˆ€ {Î“â‚ Î“â‚‚ Ï„} â†’ Î“â‚ âŠ²â™¯ Î“â‚‚ â†’ Ï„ â‹³â™¯ Î“â‚ â†’ Ï„ â‹³â™¯ Î“â‚‚
rename[â‹³â™¯][ x âˆ· Ï† ] Zero = x
rename[â‹³â™¯][ xâ‚‚ âˆ· Ï† ] (Succ xâ‚) = rename[â‹³â™¯][ Ï† ] xâ‚

_âŠšâ¸¢âŠ²â™¯â¸£_ : transitive _âŠ²â™¯_
Ï†â‚‚ âŠšâ¸¢âŠ²â™¯â¸£ [] = []
Ï†â‚‚ âŠšâ¸¢âŠ²â™¯â¸£ (x âˆ· Ï†â‚) = rename[â‹³â™¯][ Ï†â‚‚ ] x âˆ· (Ï†â‚‚ âŠšâ¸¢âŠ²â™¯â¸£ Ï†â‚)

weaken[âŠ²â™¯] : âˆ€ {Î“â‚ Î“â‚‚ Ï„} â†’ Î“â‚ âŠ²â™¯ Î“â‚‚ â†’ Î“â‚ âŠ²â™¯ Ï„ âˆ· Î“â‚‚
weaken[âŠ²â™¯] [] = []
weaken[âŠ²â™¯] (x âˆ· Ï†) = Succ x âˆ· weaken[âŠ²â™¯] Ï†

lift[âŠ²â™¯] : âˆ€ {Î“â‚ Î“â‚‚ Ï„} â†’ Î“â‚ âŠ²â™¯ Î“â‚‚ â†’ Ï„ âˆ· Î“â‚ âŠ²â™¯ Ï„ âˆ· Î“â‚‚
lift[âŠ²â™¯] Ï† = Zero âˆ· weaken[âŠ²â™¯] Ï†

xRxâ¸¢âŠ²â™¯â¸£ : reflexive _âŠ²â™¯_
xRxâ¸¢âŠ²â™¯â¸£ {[]} = []
xRxâ¸¢âŠ²â™¯â¸£ {Ï„ âˆ· Î“} = lift[âŠ²â™¯] xRxâ¸¢âŠ²â™¯â¸£

instance
  Reflexive[âŠ²â™¯] : Reflexive _âŠ²â™¯_
  Reflexive[âŠ²â™¯] = record { xRx = xRxâ¸¢âŠ²â™¯â¸£ }
  Transitive[âŠ²â™¯] : Transitive _âŠ²â™¯_
  Transitive[âŠ²â™¯] = record { _âŠš_ = _âŠšâ¸¢âŠ²â™¯â¸£_ }

intro[âŠ²â™¯] : âˆ€ {Î“ Ï„} â†’ Î“ âŠ²â™¯ Ï„ âˆ· Î“
intro[âŠ²â™¯] = weaken[âŠ²â™¯] xRx

swap[âŠ²â™¯] : âˆ€ {Î“ Ï„â‚ Ï„â‚‚} â†’ Ï„â‚ âˆ· (Ï„â‚‚ âˆ· Î“) âŠ²â™¯ Ï„â‚‚ âˆ· (Ï„â‚ âˆ· Î“)
swap[âŠ²â™¯] = Succ Zero âˆ· lift[âŠ²â™¯] intro[âŠ²â™¯]

mutual
  rename[âŠ¢â™¯][_] : âˆ€ {Ï„ Î“â‚ Î“â‚‚} â†’ Î“â‚ âŠ²â™¯ Î“â‚‚ â†’ Î“â‚ âŠ¢â™¯ Ï„ â†’ Î“â‚‚ âŠ¢â™¯ Ï„
  rename[âŠ¢â™¯][ Ï† ] (âŸ¨ğ”¹âŸ© b) = âŸ¨ğ”¹âŸ© b
  rename[âŠ¢â™¯][ Ï† ] (âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ) = âŸ¨ifâŸ© rename[âŠ¢â¦‚â™¯][ Ï† ] eâ‚ âŸ¨thenâŸ© rename[âŠ¢â¦‚â™¯][ Ï† ] eâ‚‚ âŸ¨elseâŸ© rename[âŠ¢â¦‚â™¯][ Ï† ] eâ‚ƒ
  rename[âŠ¢â™¯][ Ï† ] (Var x) = Var (rename[â‹³â™¯][ Ï† ] x)
  rename[âŠ¢â™¯][ Ï† ] (âŸ¨Î»âŸ© e) = âŸ¨Î»âŸ© (rename[âŠ¢â™¯][ lift[âŠ²â™¯] Ï† ] e)
  rename[âŠ¢â™¯][ Ï† ] (eâ‚ âŸ¨â‹…âŸ© eâ‚‚) = rename[âŠ¢â¦‚â™¯][ Ï† ] eâ‚ âŸ¨â‹…âŸ© rename[âŠ¢â¦‚â™¯][ Ï† ] eâ‚‚
  rename[âŠ¢â™¯][ Ï† ] (âŸª e âŸ«) = âŸª rename[âŠ¢â¦‚â™¯][ Ï† ] e âŸ«

  rename[âŠ¢â¦‚â™¯][_] : âˆ€ {Ï„ Î“â‚ Î“â‚‚} â†’ Î“â‚ âŠ²â™¯ Î“â‚‚ â†’ Î“â‚ âŠ¢â¦‚â™¯ Ï„ â†’ Î“â‚‚ âŠ¢â¦‚â™¯ Ï„
  rename[âŠ¢â¦‚â™¯][ Ï† ] (e â¦‚â¦‚ Îµ) = rename[âŠ¢â™¯][ Ï† ] e â¦‚â¦‚ Îµ

---------
-- Cut --
---------

cut[â‹³â™¯][_] : âˆ€ {Î“â‚ Î“â‚‚ Ï„â‚ Ï„â‚‚} â†’ Î“â‚ âŠ²â™¯ Ï„â‚ âˆ· Î“â‚‚ â†’ Ï„â‚‚ â‹³â™¯ Î“â‚ â†’ Î“â‚‚ âŠ¢â™¯ Ï„â‚ â†’ Î“â‚‚ âŠ¢â™¯ Ï„â‚‚
cut[â‹³â™¯][ Zero âˆ· Ï† ] Zero e = e
cut[â‹³â™¯][ Succ x âˆ· Ï† ] Zero e = Var x
cut[â‹³â™¯][ xâ‚‚ âˆ· Ï† ] (Succ xâ‚) e = cut[â‹³â™¯][ Ï† ] xâ‚ e

mutual
  cut[âŠ¢â™¯][_] : âˆ€ {Î“â‚ Î“â‚‚ Ï„â‚ Ï„â‚‚} â†’ Î“â‚ âŠ²â™¯ Ï„â‚ âˆ· Î“â‚‚ â†’ Î“â‚ âŠ¢â™¯ Ï„â‚‚ â†’ Î“â‚‚ âŠ¢â™¯ Ï„â‚ â†’ Î“â‚‚ âŠ¢â™¯ Ï„â‚‚
  cut[âŠ¢â™¯][ Ï† ] (âŸ¨ğ”¹âŸ© b) eâ‚‚ = âŸ¨ğ”¹âŸ© b
  cut[âŠ¢â™¯][ Ï† ] (âŸ¨ifâŸ© eâ‚â‚ âŸ¨thenâŸ© eâ‚‚â‚ âŸ¨elseâŸ© eâ‚ƒâ‚) eâ‚‚ = âŸ¨ifâŸ© cut[âŠ¢â¦‚â™¯][ Ï† ] eâ‚â‚ eâ‚‚ âŸ¨thenâŸ© cut[âŠ¢â¦‚â™¯][ Ï† ] eâ‚‚â‚ eâ‚‚ âŸ¨elseâŸ© cut[âŠ¢â¦‚â™¯][ Ï† ] eâ‚ƒâ‚ eâ‚‚
  cut[âŠ¢â™¯][ Ï† ] (Var x) eâ‚‚ = cut[â‹³â™¯][ Ï† ] x eâ‚‚
  cut[âŠ¢â™¯][ Ï† ] (âŸ¨Î»âŸ© eâ‚) eâ‚‚ = âŸ¨Î»âŸ© (cut[âŠ¢â™¯][ swap[âŠ²â™¯] âŠš lift[âŠ²â™¯] Ï† ] eâ‚ (rename[âŠ¢â™¯][ intro[âŠ²â™¯] ] eâ‚‚))
  cut[âŠ¢â™¯][ Ï† ] (eâ‚â‚ âŸ¨â‹…âŸ© eâ‚‚â‚) eâ‚‚ = cut[âŠ¢â¦‚â™¯][ Ï† ] eâ‚â‚ eâ‚‚ âŸ¨â‹…âŸ© cut[âŠ¢â¦‚â™¯][ Ï† ] eâ‚‚â‚ eâ‚‚
  cut[âŠ¢â™¯][ Ï† ] (âŸª eâ‚ âŸ«) eâ‚‚ = âŸª cut[âŠ¢â¦‚â™¯][ Ï† ] eâ‚ eâ‚‚ âŸ«

  cut[âŠ¢â¦‚â™¯][_] : âˆ€ {Î“â‚ Î“â‚‚ Ï„â‚ Ï„â‚‚} â†’ Î“â‚ âŠ²â™¯ Ï„â‚ âˆ· Î“â‚‚ â†’ Î“â‚ âŠ¢â¦‚â™¯ Ï„â‚‚ â†’ Î“â‚‚ âŠ¢â™¯ Ï„â‚ â†’ Î“â‚‚ âŠ¢â¦‚â™¯ Ï„â‚‚
  cut[âŠ¢â¦‚â™¯][ Ï† ] (eâ‚ â¦‚â¦‚ Îµ) eâ‚‚ = cut[âŠ¢â™¯][ Ï† ] eâ‚ eâ‚‚ â¦‚â¦‚ Îµ

cut[âŠ¢â™¯] : âˆ€ {Î“ Ï„â‚ Ï„â‚‚} â†’ Ï„â‚ âˆ· Î“ âŠ¢â™¯ Ï„â‚‚ â†’ Î“ âŠ¢â™¯ Ï„â‚ â†’ Î“ âŠ¢â™¯ Ï„â‚‚
cut[âŠ¢â™¯] = cut[âŠ¢â™¯][ xRx ]

---------------
-- Reduction --
---------------

-- data _â†¦â™¯_ {Î“} : âˆ€ {Ï„} â†’ relation 0á´¸ (Î“ âŠ¢â™¯ Ï„) where
--   If/T :
--     âˆ€ {Ï„â‚‚â‚ Ï„â‚‚â‚‚ Ï„â‚ƒâ‚ Ï„â‚ƒâ‚‚} {eâ‚‚ : Î“ âŠ¢â™¯ Ï„â‚‚â‚} {Îµâ‚‚ : Ï„â‚‚â‚ â‹–â™¯ Ï„â‚‚â‚‚} {eâ‚ƒ : Î“ âŠ¢â™¯ Ï„â‚ƒâ‚} {Îµâ‚ƒ : Ï„â‚ƒâ‚ â‹–â™¯ Ï„â‚ƒâ‚‚}
--     â†’ (âŸ¨ifâŸ© âŸ¨ğ”¹âŸ© True â¦‚â¦‚ âŸ¨ğ”¹âŸ© âŸ¨thenâŸ© eâ‚‚ â¦‚â¦‚ Îµâ‚‚ âŸ¨elseâŸ© eâ‚ƒ â¦‚â¦‚ Îµâ‚ƒ) â†¦â™¯ âŸª eâ‚‚ â¦‚â¦‚ weaken[â‹–â™¯]/L[ Ï„â‚ƒâ‚‚ ] Îµâ‚‚ âŸ«
--   If/F :
--     âˆ€ {Ï„â‚‚â‚ Ï„â‚‚â‚‚ Ï„â‚ƒâ‚ Ï„â‚ƒâ‚‚} {eâ‚‚ : Î“ âŠ¢â™¯ Ï„â‚‚â‚} {Îµâ‚‚ : Ï„â‚‚â‚ â‹–â™¯ Ï„â‚‚â‚‚} {eâ‚ƒ : Î“ âŠ¢â™¯ Ï„â‚ƒâ‚} {Îµâ‚ƒ : Ï„â‚ƒâ‚ â‹–â™¯ Ï„â‚ƒâ‚‚}
--     â†’ (âŸ¨ifâŸ© âŸ¨ğ”¹âŸ© False â¦‚â¦‚ âŸ¨ğ”¹âŸ© âŸ¨thenâŸ© eâ‚‚ â¦‚â¦‚ Îµâ‚‚ âŸ¨elseâŸ© eâ‚ƒ â¦‚â¦‚ Îµâ‚ƒ) â†¦â™¯ âŸª eâ‚ƒ â¦‚â¦‚ weaken[â‹–â™¯]/R[ Ï„â‚‚â‚‚ ] Îµâ‚ƒ âŸ«
--   App :
--     âˆ€ {Ï„â‚â‚ Ï„â‚‚â‚ Ï„â‚â‚‚ Ï„â‚‚â‚‚ Ï„â‚‚} {eâ‚ : (Ï„â‚â‚ âˆ· Î“) âŠ¢â™¯ Ï„â‚‚â‚} {Îµâ‚ : Ï„â‚â‚‚ â‹–â™¯ Ï„â‚â‚} {Îµâ‚‚ : Ï„â‚‚â‚ â‹–â™¯ Ï„â‚‚â‚‚} {eâ‚‚ : Î“ âŠ¢â™¯ Ï„â‚‚} {Îµâ‚ƒ : Ï„â‚‚ â‹–â™¯ Ï„â‚â‚‚}
--     â†’ (âŸ¨Î»âŸ© eâ‚ â¦‚â¦‚ (Îµâ‚ âŸ¨â†’âŸ© Îµâ‚‚) âŸ¨â‹…âŸ© eâ‚‚ â¦‚â¦‚ Îµâ‚ƒ) â†¦â™¯ âŸª cut[âŠ¢â™¯] eâ‚ âŸª eâ‚‚ â¦‚â¦‚ {!!} âŸ« â¦‚â¦‚ Îµâ‚‚ âŸ«
-- 
-- mutual
--   data _â‡°â™¯_ {Î“} : âˆ€ {Ï„} â†’ relation 0á´¸ (Î“ âŠ¢â™¯ Ï„) where
--     Axiom :
--       âˆ€ {Ï„} {e e' : Î“ âŠ¢â™¯ Ï„}
--       â†’ e â†¦â™¯ e'
--       â†’ e â‡°â™¯ e'
--     If/eâ‚ :
--       âˆ€ {Ï„â‚‚ Ï„â‚ƒ} {eâ‚ eâ‚' : Î“ âŠ¢â¦‚â™¯ âŸ¨ğ”¹âŸ©} {eâ‚‚ : Î“ âŠ¢â¦‚â™¯ Ï„â‚‚} {eâ‚ƒ : Î“ âŠ¢â¦‚â™¯ Ï„â‚ƒ}
--       â†’ eâ‚ â‡°â¦‚â™¯ eâ‚'
--       â†’ âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ â‡°â™¯ âŸ¨ifâŸ© eâ‚' âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ
--     If/eâ‚‚ :
--       âˆ€ {Ï„â‚‚ Ï„â‚ƒ} {eâ‚ : Î“ âŠ¢â¦‚â™¯ âŸ¨ğ”¹âŸ©} {eâ‚‚ eâ‚‚' : Î“ âŠ¢â¦‚â™¯ Ï„â‚‚} {eâ‚ƒ : Î“ âŠ¢â¦‚â™¯ Ï„â‚ƒ}
--       â†’ eâ‚‚ â‡°â¦‚â™¯ eâ‚‚'
--       â†’ âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ â‡°â™¯ âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚' âŸ¨elseâŸ© eâ‚ƒ
--     If/eâ‚ƒ :
--       âˆ€ {Ï„â‚‚ Ï„â‚ƒ} {eâ‚ : Î“ âŠ¢â¦‚â™¯ âŸ¨ğ”¹âŸ©} {eâ‚‚ : Î“ âŠ¢â¦‚â™¯ Ï„â‚‚} {eâ‚ƒ eâ‚ƒ' : Î“ âŠ¢â¦‚â™¯ Ï„â‚ƒ}
--       â†’ eâ‚ƒ â‡°â¦‚â™¯ eâ‚ƒ'
--       â†’ âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ â‡°â™¯ âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ'
--     Lam :
--       âˆ€ {Ï„â‚ Ï„â‚‚} {e e' : (Ï„â‚ âˆ· Î“) âŠ¢â™¯ Ï„â‚‚}
--       â†’ e â‡°â™¯ e'
--       â†’ âŸ¨Î»âŸ© e â‡°â™¯ âŸ¨Î»âŸ© e'
--     App/eâ‚ :
--       âˆ€ {Ï„â‚ Ï„â‚‚} {eâ‚ eâ‚' : Î“ âŠ¢â¦‚â™¯ (Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚)} {eâ‚‚ : Î“ âŠ¢â¦‚â™¯ Ï„â‚}
--       â†’ eâ‚ â‡°â¦‚â™¯ eâ‚'
--       â†’ eâ‚ âŸ¨â‹…âŸ© eâ‚‚ â‡°â™¯ eâ‚' âŸ¨â‹…âŸ© eâ‚‚
--     App/eâ‚‚ :
--       âˆ€ {Ï„â‚ Ï„â‚‚} {eâ‚ : Î“ âŠ¢â¦‚â™¯ (Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚)} {eâ‚‚ eâ‚‚' : Î“ âŠ¢â¦‚â™¯ Ï„â‚}
--       â†’ eâ‚‚ â‡°â¦‚â™¯ eâ‚‚'
--       â†’ eâ‚ âŸ¨â‹…âŸ© eâ‚‚ â‡°â™¯ eâ‚ âŸ¨â‹…âŸ© eâ‚‚'
--     Cast : âˆ€ {Ï„} {e e' : Î“ âŠ¢â¦‚â™¯ Ï„}
--       â†’ e â‡°â¦‚â™¯ e'
--       â†’ âŸª e âŸ« â‡°â™¯ âŸª e' âŸ«
-- 
--   data _â‡°â¦‚â™¯_ {Î“} : âˆ€ {Ï„} â†’ relation 0á´¸ (Î“ âŠ¢â¦‚â™¯ Ï„) where
--     Cast/e :
--       âˆ€ {Ï„â‚ Ï„â‚‚} {e e' : Î“ âŠ¢â™¯ Ï„â‚} {Îµ : Ï„â‚ â‹–â™¯ Ï„â‚‚}
--       â†’ e â‡°â™¯ e'
--       â†’ e â¦‚â¦‚ Îµ â‡°â¦‚â™¯ e' â¦‚â¦‚ Îµ
--     Cast/Îµ : âˆ€ {Ï„â‚ Ï„â‚‚ Ï„â‚ƒ} {e : Î“ âŠ¢â™¯ Ï„â‚} {Îµâ‚ : Ï„â‚ â‹–â™¯ Ï„â‚‚} {Îµâ‚‚ : Ï„â‚‚ â‹–â™¯ Ï„â‚ƒ}
--       â†’ âŸª e â¦‚â¦‚ Îµâ‚ âŸ« â¦‚â¦‚ Îµâ‚‚ â‡°â¦‚â™¯ e â¦‚â¦‚ {!!}
