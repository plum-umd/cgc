module AGT.Precise where

open import Prelude

infix  14 _âŠ²_
infix  14 _â‹–_
infix  14 _â‹³_
infix  14 _âŠ¢_
infix  14 _âŠ¢â¦‚_
infix  14 _â†¦_
infix  14 _â‡°_
infix  14 _â‡°â¦‚_
infix  14 _âŠ¢_â‡“_
infix  14 _âŠ¢_â‡“â¦‚_

infixr 15 _âŸ¨â†’âŸ©_
infixr 16 âŸ¨ifâŸ©_âŸ¨thenâŸ©_âŸ¨elseâŸ©_
infixl 17 _âŸ¨â‹…âŸ©_
infixl 18 _â¦‚â¦‚_

infixr 22 _âŸ‡_
infixr 24 _âŸ‘_

infixr 30 _âŠšâ¸¢â‹–â¸£_

infixr 40 _âˆ·_

-------------------
-- Type Language --
-------------------

data type : Set where
  Any : type
  None : type
  âŸ¨ğ”¹âŸ© : type
  _âŸ¨â†’âŸ©_ : type â†’ type â†’ type

instance
  PreOrder[type] : PreOrder 0á´¸ type
  PreOrder[type] = PreOrder[â‰¡]

---------------
-- Subtyping --
---------------

data _â‹–_ : type â†’ type â†’ Set where
  Any : âˆ€ {Ï„} â†’ Ï„ â‹– Any
  None : âˆ€ {Ï„} â†’ None â‹– Ï„
  âŸ¨ğ”¹âŸ© : âŸ¨ğ”¹âŸ© â‹– âŸ¨ğ”¹âŸ©
  _âŸ¨â†’âŸ©_ : âˆ€ {Ï„â‚â‚ Ï„â‚‚â‚ Ï„â‚â‚‚ Ï„â‚‚â‚‚}
    â†’ Ï„â‚‚â‚ â‹– Ï„â‚â‚
    â†’ Ï„â‚â‚‚ â‹– Ï„â‚‚â‚‚
    â†’ Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚â‚‚ â‹– Ï„â‚‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚‚

xRxâ¸¢â‹–â¸£ : âˆ€ {Ï„} â†’ Ï„ â‹– Ï„
xRxâ¸¢â‹–â¸£ {Any} = Any
xRxâ¸¢â‹–â¸£ {None} = None
xRxâ¸¢â‹–â¸£ {âŸ¨ğ”¹âŸ©} = âŸ¨ğ”¹âŸ©
xRxâ¸¢â‹–â¸£ {Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚} = xRxâ¸¢â‹–â¸£ âŸ¨â†’âŸ© xRxâ¸¢â‹–â¸£

_âŠšâ¸¢â‹–â¸£_ : âˆ€ {Ï„â‚ Ï„â‚‚ Ï„â‚ƒ} â†’ Ï„â‚‚ â‹– Ï„â‚ƒ â†’ Ï„â‚ â‹– Ï„â‚‚ â†’ Ï„â‚ â‹– Ï„â‚ƒ
Any âŠšâ¸¢â‹–â¸£ _ = Any
_ âŠšâ¸¢â‹–â¸£ None = None
âŸ¨ğ”¹âŸ© âŠšâ¸¢â‹–â¸£ âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ©
(Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚) âŠšâ¸¢â‹–â¸£ (Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚‚) = Ï„â‚â‚‚ âŠšâ¸¢â‹–â¸£ Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚ âŠšâ¸¢â‹–â¸£ Ï„â‚‚â‚‚

instance
  Reflexive[â‹–] : Reflexive _â‹–_
  Reflexive[â‹–] = record { xRx = xRxâ¸¢â‹–â¸£ }
  Transitive[â‹–] : Transitive _â‹–_
  Transitive[â‹–] = record { _âŠš_ = _âŠšâ¸¢â‹–â¸£_ }

---------------------------
-- Subtype Join and Meet --
---------------------------

mutual
  _âŸ‡_ : type â†’ type â†’ type
  Any âŸ‡ _ = Any
  _ âŸ‡ Any = Any
  None âŸ‡ Ï„ = Ï„
  Ï„ âŸ‡ None = Ï„
  âŸ¨ğ”¹âŸ© âŸ‡ âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ©
  (Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚) âŸ‡ (Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚‚) = Ï„â‚â‚ âŸ‘ Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚ âŸ‡ Ï„â‚‚â‚‚
  âŸ¨ğ”¹âŸ© âŸ‡ (_ âŸ¨â†’âŸ© _) = Any
  (_ âŸ¨â†’âŸ© _) âŸ‡ âŸ¨ğ”¹âŸ© = Any

  _âŸ‘_ : type â†’ type â†’ type
  Any âŸ‘ Ï„ = Ï„
  Ï„ âŸ‘ Any = Ï„
  None âŸ‘ _ = None
  _ âŸ‘ None = None
  âŸ¨ğ”¹âŸ© âŸ‘ âŸ¨ğ”¹âŸ© = âŸ¨ğ”¹âŸ©
  (Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚) âŸ‘ (Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚‚) = Ï„â‚â‚ âŸ‡ Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚ âŸ‘ Ï„â‚‚â‚‚
  âŸ¨ğ”¹âŸ© âŸ‘ (y âŸ¨â†’âŸ© yâ‚) = None
  (x âŸ¨â†’âŸ© xâ‚) âŸ‘ âŸ¨ğ”¹âŸ© = None

unit[âŸ‡] : âˆ€ Ï„ â†’ None âŸ‡ Ï„ â‰¡ Ï„ âˆ§ Ï„ âŸ‡ None â‰¡ Ï„
unit[âŸ‡] Any = â†¯ , â†¯
unit[âŸ‡] None = â†¯ , â†¯
unit[âŸ‡] âŸ¨ğ”¹âŸ© = â†¯ , â†¯
unit[âŸ‡] (_ âŸ¨â†’âŸ© _) = â†¯ , â†¯

zero[âŸ‡] : âˆ€ Ï„ â†’ Any âŸ‡ Ï„ â‰¡ Any âˆ§ Ï„ âŸ‡ Any â‰¡ Any
zero[âŸ‡] Any = â†¯ , â†¯
zero[âŸ‡] None = â†¯ , â†¯
zero[âŸ‡] âŸ¨ğ”¹âŸ© = â†¯ , â†¯
zero[âŸ‡] (_ âŸ¨â†’âŸ© _) = â†¯ , â†¯

unit[âŸ‘] : âˆ€ Ï„ â†’ Any âŸ‘ Ï„ â‰¡ Ï„ âˆ§ Ï„ âŸ‘ Any â‰¡ Ï„
unit[âŸ‘] Any = â†¯ , â†¯
unit[âŸ‘] None = â†¯ , â†¯
unit[âŸ‘] âŸ¨ğ”¹âŸ© = â†¯ , â†¯
unit[âŸ‘] (_ âŸ¨â†’âŸ© _) = â†¯ , â†¯

zero[âŸ‘] : âˆ€ Ï„ â†’ None âŸ‘ Ï„ â‰¡ None âˆ§ Ï„ âŸ‘ None â‰¡ None
zero[âŸ‘] Any = â†¯ , â†¯
zero[âŸ‘] None = â†¯ , â†¯
zero[âŸ‘] âŸ¨ğ”¹âŸ© = â†¯ , â†¯
zero[âŸ‘] (_ âŸ¨â†’âŸ© _) = â†¯ , â†¯

mutual
  â‹–âŸ‡ : âˆ€ {Ï„â‚ Ï„â‚‚} â†’ Ï„â‚ â‹– Ï„â‚ âŸ‡ Ï„â‚‚ âˆ§ Ï„â‚‚ â‹– Ï„â‚ âŸ‡ Ï„â‚‚
  â‹–âŸ‡ {Any} {_} = Any , Any
  â‹–âŸ‡ {Ï„â‚} {Any} rewrite Ï€â‚‚ (zero[âŸ‡] Ï„â‚) = Any , Any
  â‹–âŸ‡ {None} {Ï„â‚‚} rewrite Ï€â‚ (unit[âŸ‡] Ï„â‚‚) = None , xRx
  â‹–âŸ‡ {Ï„â‚} {None} rewrite Ï€â‚‚ (unit[âŸ‡] Ï„â‚) = xRx , None
  â‹–âŸ‡ {âŸ¨ğ”¹âŸ©} {âŸ¨ğ”¹âŸ©} = âŸ¨ğ”¹âŸ© , âŸ¨ğ”¹âŸ©
  â‹–âŸ‡ {Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚} {Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚‚} with â‹–âŸ‘ {Ï„â‚â‚} {Ï„â‚â‚‚} | â‹–âŸ‡ {Ï„â‚‚â‚} {Ï„â‚‚â‚‚}
  ... | <âŸ‘â‚ , <âŸ‘â‚‚ | <âŸ‡â‚ , <âŸ‡â‚‚ = (<âŸ‘â‚ âŸ¨â†’âŸ© <âŸ‡â‚) , (<âŸ‘â‚‚ âŸ¨â†’âŸ© <âŸ‡â‚‚)
  â‹–âŸ‡ {âŸ¨ğ”¹âŸ©} {_ âŸ¨â†’âŸ© _} = Any , Any
  â‹–âŸ‡ {_ âŸ¨â†’âŸ© _} {âŸ¨ğ”¹âŸ©} = Any , Any

  â‹–âŸ‘ : âˆ€ {Ï„â‚ Ï„â‚‚} â†’ Ï„â‚ âŸ‘ Ï„â‚‚ â‹– Ï„â‚ âˆ§ Ï„â‚ âŸ‘ Ï„â‚‚ â‹– Ï„â‚‚
  â‹–âŸ‘ {Any} {_} = Any , xRx
  â‹–âŸ‘ {Ï„â‚} {Any} rewrite Ï€â‚‚ (unit[âŸ‘] Ï„â‚) = xRx , Any
  â‹–âŸ‘ {None} {Ï„â‚‚} rewrite Ï€â‚ (zero[âŸ‘] Ï„â‚‚) = None , None
  â‹–âŸ‘ {Ï„â‚} {None} rewrite Ï€â‚‚ (zero[âŸ‘] Ï„â‚) = None , None
  â‹–âŸ‘ {âŸ¨ğ”¹âŸ©} {âŸ¨ğ”¹âŸ©} = âŸ¨ğ”¹âŸ© , âŸ¨ğ”¹âŸ©
  â‹–âŸ‘ {Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚} {Ï„â‚â‚‚ âŸ¨â†’âŸ© Ï„â‚‚â‚‚} with â‹–âŸ‡ {Ï„â‚â‚} {Ï„â‚â‚‚} | â‹–âŸ‘ {Ï„â‚‚â‚} {Ï„â‚‚â‚‚}
  ... | <âŸ‡â‚ , <âŸ‡â‚‚ | <âŸ‘â‚ , <âŸ‘â‚‚ = <âŸ‡â‚ âŸ¨â†’âŸ© <âŸ‘â‚ , <âŸ‡â‚‚ âŸ¨â†’âŸ© <âŸ‘â‚‚
  â‹–âŸ‘ {âŸ¨ğ”¹âŸ©} {_ âŸ¨â†’âŸ© _} = None , None
  â‹–âŸ‘ {_ âŸ¨â†’âŸ© _} {âŸ¨ğ”¹âŸ©} = None , None

â‹–âŸ‡/L : âˆ€ {Ï„â‚} Ï„â‚‚ â†’ Ï„â‚ â‹– Ï„â‚ âŸ‡ Ï„â‚‚
â‹–âŸ‡/L Ï„â‚‚ = Ï€â‚ (â‹–âŸ‡ {_} {Ï„â‚‚})

â‹–âŸ‡/R : âˆ€ Ï„â‚ {Ï„â‚‚} â†’ Ï„â‚‚ â‹– Ï„â‚ âŸ‡ Ï„â‚‚
â‹–âŸ‡/R Ï„â‚ = Ï€â‚‚ (â‹–âŸ‡ {Ï„â‚})

â‹–âŸ‘/L : âˆ€ {Ï„â‚} Ï„â‚‚ â†’ Ï„â‚ âŸ‘ Ï„â‚‚ â‹– Ï„â‚
â‹–âŸ‘/L Ï„â‚‚ = Ï€â‚ (â‹–âŸ‘ {_} {Ï„â‚‚})

â‹–âŸ‘/R : âˆ€ Ï„â‚ {Ï„â‚‚} â†’ Ï„â‚ âŸ‘ Ï„â‚‚ â‹– Ï„â‚‚
â‹–âŸ‘/R Ï„â‚ = Ï€â‚‚ (â‹–âŸ‘ {Ï„â‚})

-------------------
-- Term Language --
-------------------

data context : Set where
  [] : context
  _âˆ·_ : type â†’ context â†’ context

data _â‹³_ : type â†’ context â†’ Set where
  Zero : âˆ€ {Î“ Ï„} â†’ Ï„ â‹³ Ï„ âˆ· Î“
  Succ : âˆ€ {Î“ Ï„â‚ Ï„â‚‚} â†’ Ï„â‚ â‹³ Î“ â†’ Ï„â‚ â‹³ Ï„â‚‚ âˆ· Î“

mutual
  data _âŠ¢_ : context â†’ type â†’ Set where
    âŸ¨ğ”¹âŸ© : âˆ€ {Î“}
      â†’ ğ”¹ â†’ Î“ âŠ¢ âŸ¨ğ”¹âŸ©
    âŸ¨ifâŸ©_âŸ¨thenâŸ©_âŸ¨elseâŸ©_ : âˆ€ {Î“ Ï„â‚‚ Ï„â‚ƒ}
      â†’ Î“ âŠ¢â¦‚ âŸ¨ğ”¹âŸ©
      â†’ Î“ âŠ¢â¦‚ Ï„â‚‚
      â†’ Î“ âŠ¢â¦‚ Ï„â‚ƒ
      â†’ Î“ âŠ¢ Ï„â‚‚ âŸ‡ Ï„â‚ƒ
    Var : âˆ€ {Î“ Ï„}
      â†’ Ï„ â‹³ Î“
      â†’ Î“ âŠ¢ Ï„
    âŸ¨Î»âŸ© : âˆ€ {Î“ Ï„â‚ Ï„â‚‚}
      â†’ Ï„â‚ âˆ· Î“ âŠ¢ Ï„â‚‚
      â†’ Î“ âŠ¢ Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚
    _âŸ¨â‹…âŸ©_ : âˆ€ {Î“ Ï„â‚ Ï„â‚‚}
      â†’ Î“ âŠ¢â¦‚ Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚
      â†’ Î“ âŠ¢â¦‚ Ï„â‚
      â†’ Î“ âŠ¢ Ï„â‚‚
    âŸª_âŸ« : âˆ€ {Î“ Ï„}
      â†’ Î“ âŠ¢â¦‚ Ï„
      â†’ Î“ âŠ¢ Ï„

  data _âŠ¢â¦‚_ : context â†’ type â†’ Set where
    _â¦‚â¦‚_ : âˆ€ {Î“ Ï„â‚ Ï„â‚‚}
      â†’ Î“ âŠ¢ Ï„â‚
      â†’ Ï„â‚ â‹– Ï„â‚‚
      â†’ Î“ âŠ¢â¦‚ Ï„â‚‚

--------------
-- Renaming --
--------------

data _âŠ²_ : context â†’ context â†’ Set where
  [] : âˆ€ {Î“} â†’ [] âŠ² Î“
  _âˆ·_ : âˆ€ {Î“â‚ Î“â‚‚ Ï„} â†’ Ï„ â‹³ Î“â‚‚ â†’ Î“â‚ âŠ² Î“â‚‚ â†’ Ï„ âˆ· Î“â‚ âŠ² Î“â‚‚

rename[â‹³] : âˆ€ {Î“â‚ Î“â‚‚ Ï„} â†’ Î“â‚ âŠ² Î“â‚‚ â†’ Ï„ â‹³ Î“â‚ â†’ Ï„ â‹³ Î“â‚‚
rename[â‹³] (x âˆ· Ï†) Zero = x
rename[â‹³] (xâ‚‚ âˆ· Ï†) (Succ xâ‚) = rename[â‹³] Ï† xâ‚

_âŠšâ¸¢âŠ²â¸£_ : âˆ€ {Î“â‚ Î“â‚‚ Î“â‚ƒ} â†’ Î“â‚‚ âŠ² Î“â‚ƒ â†’ Î“â‚ âŠ² Î“â‚‚ â†’ Î“â‚ âŠ² Î“â‚ƒ
Ï† âŠšâ¸¢âŠ²â¸£ [] = []
Ï†â‚‚ âŠšâ¸¢âŠ²â¸£ (x âˆ· Ï†â‚) = rename[â‹³] Ï†â‚‚ x âˆ· (Ï†â‚‚ âŠšâ¸¢âŠ²â¸£ Ï†â‚)

weaken[âŠ²] : âˆ€ {Î“â‚ Î“â‚‚ Ï„} â†’ Î“â‚ âŠ² Î“â‚‚ â†’ Î“â‚ âŠ² Ï„ âˆ· Î“â‚‚
weaken[âŠ²] [] = []
weaken[âŠ²] (x âˆ· Ï†) = Succ x âˆ· weaken[âŠ²] Ï†

lift[âŠ²] : âˆ€ {Î“â‚ Î“â‚‚ Ï„} â†’ Î“â‚ âŠ² Î“â‚‚ â†’ Ï„ âˆ· Î“â‚ âŠ² Ï„ âˆ· Î“â‚‚
lift[âŠ²] Ï† = Zero âˆ· weaken[âŠ²] Ï†

xRxâ¸¢âŠ²â¸£ : âˆ€ {Î“} â†’ Î“ âŠ² Î“
xRxâ¸¢âŠ²â¸£ {[]} = []
xRxâ¸¢âŠ²â¸£ {x âˆ· Î“} = lift[âŠ²] xRxâ¸¢âŠ²â¸£

instance
  Reflexive[âŠ´Ê³] : Reflexive _âŠ²_
  Reflexive[âŠ´Ê³] = record { xRx = xRxâ¸¢âŠ²â¸£ }
  Transitive[âŠ´Ê³] : Transitive _âŠ²_
  Transitive[âŠ´Ê³] = record { _âŠš_ = _âŠšâ¸¢âŠ²â¸£_ }

intro[âŠ²] : âˆ€ {Î“ Ï„} â†’ Î“ âŠ² Ï„ âˆ· Î“
intro[âŠ²] = weaken[âŠ²] xRx

swap[âŠ²] : âˆ€ {Î“ Ï„â‚ Ï„â‚‚} â†’ Ï„â‚ âˆ· Ï„â‚‚ âˆ· Î“ âŠ² Ï„â‚‚ âˆ· Ï„â‚ âˆ· Î“
swap[âŠ²] = Succ Zero âˆ· lift[âŠ²] intro[âŠ²]

mutual
  rename[âŠ¢][_] : âˆ€ {Î“â‚ Î“â‚‚ Ï„} â†’ Î“â‚ âŠ² Î“â‚‚ â†’ Î“â‚ âŠ¢ Ï„ â†’ Î“â‚‚ âŠ¢ Ï„
  rename[âŠ¢][ Ï† ] (âŸ¨ğ”¹âŸ© b) = âŸ¨ğ”¹âŸ© b
  rename[âŠ¢][ Ï† ] (âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ) = âŸ¨ifâŸ© rename[âŠ¢â¦‚][ Ï† ] eâ‚ âŸ¨thenâŸ© rename[âŠ¢â¦‚][ Ï† ] eâ‚‚ âŸ¨elseâŸ© rename[âŠ¢â¦‚][ Ï† ] eâ‚ƒ
  rename[âŠ¢][ Ï† ] (Var x) = Var (rename[â‹³] Ï† x)
  rename[âŠ¢][ Ï† ] (âŸ¨Î»âŸ© e) = âŸ¨Î»âŸ© (rename[âŠ¢][ lift[âŠ²] Ï† ] e)
  rename[âŠ¢][ Ï† ] (eâ‚ âŸ¨â‹…âŸ© eâ‚‚) = rename[âŠ¢â¦‚][ Ï† ] eâ‚ âŸ¨â‹…âŸ© rename[âŠ¢â¦‚][ Ï† ] eâ‚‚
  rename[âŠ¢][ Ï† ] âŸª e âŸ« = âŸª rename[âŠ¢â¦‚][ Ï† ] e âŸ«
  
  rename[âŠ¢â¦‚][_] : âˆ€ {Î“â‚ Î“â‚‚ Ï„} â†’ Î“â‚ âŠ² Î“â‚‚ â†’ Î“â‚ âŠ¢â¦‚ Ï„ â†’ Î“â‚‚ âŠ¢â¦‚ Ï„
  rename[âŠ¢â¦‚][ Ï† ] (e â¦‚â¦‚ Îµ) = rename[âŠ¢][ Ï† ] e â¦‚â¦‚ Îµ

---------
-- Cut --
---------

cut[â‹³][_] : âˆ€ {Î“â‚ Î“â‚‚ Ï„â‚ Ï„â‚‚} â†’ Î“â‚ âŠ² Ï„â‚ âˆ· Î“â‚‚ â†’ Ï„â‚‚ â‹³ Î“â‚ â†’ Î“â‚‚ âŠ¢ Ï„â‚ â†’ Î“â‚‚ âŠ¢ Ï„â‚‚
cut[â‹³][ Zero âˆ· Ï† ] Zero e = e
cut[â‹³][ Succ x âˆ· Ï† ] Zero e = Var x
cut[â‹³][ xâ‚‚ âˆ· Ï† ] (Succ xâ‚) e = cut[â‹³][ Ï† ] xâ‚ e

mutual
  cut[âŠ¢][_] : âˆ€ {Î“â‚ Î“â‚‚ Ï„â‚ Ï„â‚‚} â†’ Î“â‚ âŠ² Ï„â‚ âˆ· Î“â‚‚ â†’ Î“â‚ âŠ¢ Ï„â‚‚ â†’ Î“â‚‚ âŠ¢ Ï„â‚ â†’ Î“â‚‚ âŠ¢ Ï„â‚‚
  cut[âŠ¢][ Ï† ] (âŸ¨ğ”¹âŸ© b) e = âŸ¨ğ”¹âŸ© b
  cut[âŠ¢][ Ï† ] (âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ) e = âŸ¨ifâŸ© cut[âŠ¢â¦‚][ Ï† ] eâ‚ e âŸ¨thenâŸ© cut[âŠ¢â¦‚][ Ï† ] eâ‚‚ e âŸ¨elseâŸ© cut[âŠ¢â¦‚][ Ï† ] eâ‚ƒ e
  cut[âŠ¢][ Ï† ] (Var x) e = cut[â‹³][ Ï† ] x e
  cut[âŠ¢][ Ï† ] (âŸ¨Î»âŸ© eâ‚) e = âŸ¨Î»âŸ© (cut[âŠ¢][ swap[âŠ²] âŠš lift[âŠ²] Ï† ] eâ‚ (rename[âŠ¢][ intro[âŠ²] ] e))
  cut[âŠ¢][ Ï† ] (eâ‚ âŸ¨â‹…âŸ© eâ‚‚) e = cut[âŠ¢â¦‚][ Ï† ] eâ‚ e âŸ¨â‹…âŸ© cut[âŠ¢â¦‚][ Ï† ] eâ‚‚ e
  cut[âŠ¢][ Ï† ] âŸª eâ‚ âŸ« e = âŸª cut[âŠ¢â¦‚][ Ï† ] eâ‚ e âŸ«

  cut[âŠ¢â¦‚][_] : âˆ€ {Î“â‚ Î“â‚‚ Ï„â‚ Ï„â‚‚} â†’ Î“â‚ âŠ² Ï„â‚ âˆ· Î“â‚‚ â†’ Î“â‚ âŠ¢â¦‚ Ï„â‚‚ â†’ Î“â‚‚ âŠ¢ Ï„â‚ â†’ Î“â‚‚ âŠ¢â¦‚ Ï„â‚‚
  cut[âŠ¢â¦‚][ Ï† ] (eâ‚ â¦‚â¦‚ Îµ) e = cut[âŠ¢][ Ï† ] eâ‚ e â¦‚â¦‚ Îµ

cut[âŠ¢] : âˆ€ {Î“ Ï„â‚ Ï„â‚‚} â†’ Ï„â‚ âˆ· Î“ âŠ¢ Ï„â‚‚ â†’ Î“ âŠ¢ Ï„â‚ â†’ Î“ âŠ¢ Ï„â‚‚
cut[âŠ¢] = cut[âŠ¢][ xRx ]

---------------
-- Reduction --
---------------

data _â†¦_ {Î“} : âˆ€ {Ï„} â†’ relation 0á´¸ (Î“ âŠ¢ Ï„) where
  If/T : âˆ€ {Ï„â‚‚â‚ Ï„â‚‚â‚‚ Ï„â‚ƒâ‚ Ï„â‚ƒâ‚‚} {eâ‚‚ : Î“ âŠ¢ Ï„â‚‚â‚} {Îµâ‚‚ : Ï„â‚‚â‚ â‹– Ï„â‚‚â‚‚} {eâ‚ƒ : Î“ âŠ¢ Ï„â‚ƒâ‚} {Îµâ‚ƒ : Ï„â‚ƒâ‚ â‹– Ï„â‚ƒâ‚‚}
    â†’ âŸ¨ifâŸ© âŸ¨ğ”¹âŸ© True â¦‚â¦‚ âŸ¨ğ”¹âŸ© âŸ¨thenâŸ© eâ‚‚ â¦‚â¦‚ Îµâ‚‚ âŸ¨elseâŸ© eâ‚ƒ â¦‚â¦‚ Îµâ‚ƒ â†¦ âŸª eâ‚‚ â¦‚â¦‚ â‹–âŸ‡/L Ï„â‚ƒâ‚‚ âŠš Îµâ‚‚ âŸ«
  If/F : âˆ€ {Ï„â‚‚â‚ Ï„â‚‚â‚‚ Ï„â‚ƒâ‚ Ï„â‚ƒâ‚‚} {eâ‚‚ : Î“ âŠ¢ Ï„â‚‚â‚} {Îµâ‚‚ : Ï„â‚‚â‚ â‹– Ï„â‚‚â‚‚} {eâ‚ƒ : Î“ âŠ¢ Ï„â‚ƒâ‚} {Îµâ‚ƒ : Ï„â‚ƒâ‚ â‹– Ï„â‚ƒâ‚‚}
    â†’ âŸ¨ifâŸ© âŸ¨ğ”¹âŸ© False â¦‚â¦‚ âŸ¨ğ”¹âŸ© âŸ¨thenâŸ© eâ‚‚ â¦‚â¦‚ Îµâ‚‚ âŸ¨elseâŸ© eâ‚ƒ â¦‚â¦‚ Îµâ‚ƒ â†¦ âŸª eâ‚ƒ â¦‚â¦‚ â‹–âŸ‡/R Ï„â‚‚â‚‚ âŠš Îµâ‚ƒ âŸ«
  App : âˆ€ {Ï„â‚â‚ Ï„â‚â‚‚ Ï„â‚â‚ƒ Ï„â‚‚â‚ Ï„â‚‚â‚‚} {eâ‚ : Ï„â‚â‚‚ âˆ· Î“ âŠ¢ Ï„â‚‚â‚} {Îµâ‚â‚ : Ï„â‚â‚ â‹– Ï„â‚â‚‚} {Îµâ‚‚â‚ : Ï„â‚‚â‚ â‹– Ï„â‚‚â‚‚} {eâ‚‚ : Î“ âŠ¢ Ï„â‚â‚ƒ} {Îµâ‚‚ : Ï„â‚â‚ƒ â‹– Ï„â‚â‚}
    â†’ âŸ¨Î»âŸ© eâ‚ â¦‚â¦‚ (Îµâ‚â‚ âŸ¨â†’âŸ© Îµâ‚‚â‚) âŸ¨â‹…âŸ© eâ‚‚ â¦‚â¦‚ Îµâ‚‚ â†¦ âŸª cut[âŠ¢] eâ‚ âŸª eâ‚‚ â¦‚â¦‚ Îµâ‚â‚ âŠš Îµâ‚‚ âŸ« â¦‚â¦‚ Îµâ‚‚â‚ âŸ«

mutual
  data _â‡°_ {Î“} : âˆ€ {Ï„} â†’ relation 0á´¸ (Î“ âŠ¢ Ï„) where
    Axiom : âˆ€ {Ï„} {e e' : Î“ âŠ¢ Ï„}
      â†’ e â†¦ e'
      â†’ e â‡° e'
    If/eâ‚ : âˆ€ {Ï„â‚‚ Ï„â‚ƒ} {eâ‚ eâ‚' : Î“ âŠ¢â¦‚ âŸ¨ğ”¹âŸ©} {eâ‚‚ : Î“ âŠ¢â¦‚ Ï„â‚‚} {eâ‚ƒ : Î“ âŠ¢â¦‚ Ï„â‚ƒ}
      â†’ eâ‚ â‡°â¦‚ eâ‚'
      â†’ âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ â‡° âŸ¨ifâŸ© eâ‚' âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ
    If/eâ‚‚ : âˆ€ {Ï„â‚‚ Ï„â‚ƒ} {eâ‚ : Î“ âŠ¢â¦‚ âŸ¨ğ”¹âŸ©} {eâ‚‚ eâ‚‚' : Î“ âŠ¢â¦‚ Ï„â‚‚} {eâ‚ƒ : Î“ âŠ¢â¦‚ Ï„â‚ƒ}
      â†’ eâ‚‚ â‡°â¦‚ eâ‚‚'
      â†’ âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ â‡° âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚' âŸ¨elseâŸ© eâ‚ƒ
    If/eâ‚ƒ : âˆ€ {Ï„â‚‚ Ï„â‚ƒ} {eâ‚ : Î“ âŠ¢â¦‚ âŸ¨ğ”¹âŸ©} {eâ‚‚ : Î“ âŠ¢â¦‚ Ï„â‚‚} {eâ‚ƒ eâ‚ƒ' : Î“ âŠ¢â¦‚ Ï„â‚ƒ}
      â†’ eâ‚ƒ â‡°â¦‚ eâ‚ƒ'
      â†’ âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ â‡° âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ'
    Lam : âˆ€ {Ï„â‚ Ï„â‚‚} {e e' : Ï„â‚ âˆ· Î“ âŠ¢ Ï„â‚‚}
      â†’ e â‡° e'
      â†’ âŸ¨Î»âŸ© e â‡° âŸ¨Î»âŸ© e'
    App/eâ‚ : âˆ€ {Ï„â‚ Ï„â‚‚} {eâ‚ eâ‚' : Î“ âŠ¢â¦‚ Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚} {eâ‚‚ : Î“ âŠ¢â¦‚ Ï„â‚}
      â†’ eâ‚ â‡°â¦‚ eâ‚'
      â†’ eâ‚ âŸ¨â‹…âŸ© eâ‚‚ â‡° eâ‚' âŸ¨â‹…âŸ© eâ‚‚
    App/eâ‚‚ : âˆ€ {Ï„â‚ Ï„â‚‚} {eâ‚ : Î“ âŠ¢â¦‚ Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚} {eâ‚‚ eâ‚‚' : Î“ âŠ¢â¦‚ Ï„â‚}
      â†’ eâ‚‚ â‡°â¦‚ eâ‚‚'
      â†’ eâ‚ âŸ¨â‹…âŸ© eâ‚‚ â‡° eâ‚ âŸ¨â‹…âŸ© eâ‚‚'
    Cast : âˆ€ {Ï„} {e e' : Î“ âŠ¢â¦‚ Ï„}
      â†’ e â‡°â¦‚ e'
      â†’ âŸª e âŸ« â‡° âŸª e' âŸ«

  data _â‡°â¦‚_ {Î“} : âˆ€ {Ï„} â†’ relation 0á´¸ (Î“ âŠ¢â¦‚ Ï„) where
    Cast/e : âˆ€ {Ï„â‚ Ï„â‚‚} {e e' : Î“ âŠ¢ Ï„â‚} {Îµ : Ï„â‚ â‹– Ï„â‚‚}
      â†’ e â‡° e'
      â†’ e â¦‚â¦‚ Îµ â‡°â¦‚ e' â¦‚â¦‚ Îµ
    Cast/Îµ : âˆ€ {Ï„â‚ Ï„â‚‚ Ï„â‚ƒ} {e : Î“ âŠ¢ Ï„â‚} {Îµâ‚ : Ï„â‚ â‹– Ï„â‚‚} {Îµâ‚‚ : Ï„â‚‚ â‹– Ï„â‚ƒ}
      â†’ âŸª e â¦‚â¦‚ Îµâ‚ âŸ« â¦‚â¦‚ Îµâ‚‚ â‡°â¦‚ e â¦‚â¦‚ Îµâ‚‚ âŠš Îµâ‚

mutual
  data is-val : âˆ€ {Î“ Ï„} â†’ Î“ âŠ¢ Ï„ â†’ Set where
    âŸ¨ğ”¹âŸ© : âˆ€ {Î“} b â†’ is-val (âŸ¨ğ”¹âŸ© b ğ‘ğ‘¡ Î“ âŠ¢ âŸ¨ğ”¹âŸ©)
    âŸ¨Î»âŸ© : âˆ€ {Î“ Ï„â‚ Ï„â‚‚} (e : Ï„â‚ âˆ· Î“ âŠ¢ Ï„â‚‚) â†’ is-val (âŸ¨Î»âŸ© e)
  data is-val<> : âˆ€ {Î“ Ï„} â†’ Î“ âŠ¢ Ï„ â†’ Set where
    Val : âˆ€ {Î“ Ï„} {e : Î“ âŠ¢ Ï„} â†’ is-val e â†’ is-val<> e
    Val<> : âˆ€ {Î“ Ï„} {e : Î“ âŠ¢â¦‚ Ï„} â†’ is-valâ¦‚ e â†’ is-val<> âŸª e âŸ«
  data is-valâ¦‚ : âˆ€ {Î“ Ï„} â†’ Î“ âŠ¢â¦‚ Ï„ â†’ Set where
    Valâ¦‚ : âˆ€ {Î“ Ï„â‚ Ï„â‚‚} {e : Î“ âŠ¢ Ï„â‚} {Îµ : Ï„â‚ â‹– Ï„â‚‚} â†’ is-val e â†’ is-valâ¦‚ (e â¦‚â¦‚ Îµ)


----------------
-- Metatheory --
----------------

mutual
  progress : âˆ€ {Ï„} (e : [] âŠ¢ Ï„) â†’ is-val e âˆ¨ (âˆ€ {Ï„'} (Îµ : Ï„ â‹– Ï„') â†’ (âˆƒ e' ğ‘ ğ‘¡ e â¦‚â¦‚ Îµ â‡°â¦‚ e'))
  progress (âŸ¨ğ”¹âŸ© b) = Inl (âŸ¨ğ”¹âŸ© b)
  progress (âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ) with progressâ¦‚ eâ‚
  progress (âŸ¨ifâŸ© .(âŸ¨Î»âŸ© eâ‚) â¦‚â¦‚ () âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ) | Inl (Valâ¦‚ (âŸ¨Î»âŸ© eâ‚))
  progress (âŸ¨ifâŸ© .(âŸ¨ğ”¹âŸ© True) â¦‚â¦‚ âŸ¨ğ”¹âŸ© âŸ¨thenâŸ© eâ‚‚ â¦‚â¦‚ Îµâ‚‚ âŸ¨elseâŸ© _â¦‚â¦‚_ {Ï„â‚‚ = Ï„â‚ƒ} eâ‚ƒ Îµâ‚ƒ) | Inl (Valâ¦‚ (âŸ¨ğ”¹âŸ© True)) = Inr (Î» Îµ' â†’ âˆƒ âŸª eâ‚‚ â¦‚â¦‚ â‹–âŸ‡/L Ï„â‚ƒ âŠš Îµâ‚‚ âŸ« â¦‚â¦‚ Îµ' ,, Cast/e (Axiom If/T))
  progress (âŸ¨ifâŸ© .(âŸ¨ğ”¹âŸ© False) â¦‚â¦‚ âŸ¨ğ”¹âŸ© âŸ¨thenâŸ© _â¦‚â¦‚_ {Ï„â‚‚ = Ï„â‚‚} eâ‚‚ Îµâ‚‚ âŸ¨elseâŸ© eâ‚ƒ â¦‚â¦‚ Îµâ‚ƒ) | Inl (Valâ¦‚ (âŸ¨ğ”¹âŸ© False)) = Inr (Î» Îµ' â†’ âˆƒ âŸª eâ‚ƒ â¦‚â¦‚ â‹–âŸ‡/R Ï„â‚‚ âŠš Îµâ‚ƒ âŸ« â¦‚â¦‚ Îµ'  ,, Cast/e (Axiom If/F))
  progress (âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ) | Inr (âˆƒ eâ‚' ,, â‡°â‚) = Inr (Î» Îµ â†’ âˆƒ (âŸ¨ifâŸ© eâ‚' âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ) â¦‚â¦‚ Îµ ,, Cast/e (If/eâ‚ â‡°â‚))
  progress (Var ())
  progress (âŸ¨Î»âŸ© e) = Inl (âŸ¨Î»âŸ© e)
  progress (eâ‚ âŸ¨â‹…âŸ© eâ‚‚) with progressâ¦‚ eâ‚
  progress ((.(âŸ¨ğ”¹âŸ© b) â¦‚â¦‚ ()) âŸ¨â‹…âŸ© eâ‚‚) | Inl (Valâ¦‚ (âŸ¨ğ”¹âŸ© b))
  progress ((.(âŸ¨Î»âŸ© eâ‚) â¦‚â¦‚ (Îµâ‚â‚ âŸ¨â†’âŸ© Îµâ‚‚â‚)) âŸ¨â‹…âŸ© (eâ‚‚ â¦‚â¦‚ Îµâ‚‚)) | Inl (Valâ¦‚ (âŸ¨Î»âŸ© eâ‚)) = Inr (Î» Îµ' â†’ âˆƒ  âŸª cut[âŠ¢] eâ‚ âŸª eâ‚‚ â¦‚â¦‚ Îµâ‚â‚ âŠš Îµâ‚‚ âŸ« â¦‚â¦‚ Îµâ‚‚â‚ âŸ« â¦‚â¦‚ Îµ' ,, Cast/e (Axiom App))
  progress (eâ‚ âŸ¨â‹…âŸ© eâ‚‚) | Inr (âˆƒ eâ‚' ,, â‡°â‚) = Inr (Î» Îµ â†’ âˆƒ (eâ‚' âŸ¨â‹…âŸ© eâ‚‚) â¦‚â¦‚ Îµ ,, Cast/e (App/eâ‚ â‡°â‚))
  progress âŸª e â¦‚â¦‚ Îµâ‚ âŸ« = Inr (Î» Îµâ‚‚ â†’ âˆƒ e â¦‚â¦‚ Îµâ‚‚ âŠš Îµâ‚ ,, Cast/Îµ)
  progressâ¦‚ : âˆ€ {Ï„} (e : [] âŠ¢â¦‚ Ï„) â†’ is-valâ¦‚ e âˆ¨ (âˆƒ e' ğ‘ ğ‘¡ e â‡°â¦‚ e')
  progressâ¦‚ (e â¦‚â¦‚ Îµ) with progress e
  progressâ¦‚ (e â¦‚â¦‚ Îµ) | Inl val[e] = Inl (Valâ¦‚ val[e])
  progressâ¦‚ (e â¦‚â¦‚ Îµ) | Inr â‡°â‚ = Inr (â‡°â‚ Îµ)

----------------
-- Evaluation --
----------------

mutual
  data val : type â†’ Set where
    âŸ¨ğ”¹âŸ© : ğ”¹ â†’ val âŸ¨ğ”¹âŸ©
    âŸ¨_,_âŸ© : âˆ€ {Î“ Ï„â‚ Ï„â‚‚} â†’ Ï„â‚ âˆ· Î“ âŠ¢ Ï„â‚‚ â†’ env Î“ â†’ val (Ï„â‚ âŸ¨â†’âŸ© Ï„â‚‚)
  data env : context â†’ Set where
    [] : env []
    _âˆ·_ : âˆ€ {Î“ Ï„} â†’ valâ¦‚ Ï„ â†’ env Î“ â†’ env (Ï„ âˆ· Î“)
  data valâ¦‚ : type â†’ Set where
    _â¦‚â¦‚_ : âˆ€ {Ï„â‚ Ï„â‚‚} â†’ val Ï„â‚ â†’ Ï„â‚ â‹– Ï„â‚‚ â†’ valâ¦‚ Ï„â‚‚

weaken[val][_] : âˆ€ {Ï„â‚ Ï„â‚‚} â†’ Ï„â‚ â‹– Ï„â‚‚ â†’ valâ¦‚ Ï„â‚ â†’ valâ¦‚ Ï„â‚‚
weaken[val][ Îµâ‚‚ ] (v â¦‚â¦‚ Îµâ‚) = v â¦‚â¦‚ Îµâ‚‚ âŠš Îµâ‚
  
_[_] : âˆ€ {Î“ Ï„} â†’ env Î“ â†’ Ï„ â‹³ Î“ â†’ valâ¦‚ Ï„
(v âˆ· Ï) [ Zero ] = v
(v âˆ· Ï) [ Succ x ] = Ï [ x ]

mutual
  data _âŠ¢_â‡“_ {Î“} (Ï : env Î“) : âˆ€ {Ï„} â†’ Î“ âŠ¢ Ï„ â†’ valâ¦‚ Ï„ â†’ Set where
    âŸ¨ğ”¹âŸ© : âˆ€ {b}
      â†’ Ï âŠ¢ âŸ¨ğ”¹âŸ© b â‡“ âŸ¨ğ”¹âŸ© b â¦‚â¦‚ xRx
    âŸ¨ifâŸ©_âŸ¨thenâŸ©_ : âˆ€ {Ï„â‚ Ï„â‚‚} {eâ‚} {eâ‚‚ : Î“ âŠ¢â¦‚ Ï„â‚} {eâ‚ƒ : Î“ âŠ¢â¦‚ Ï„â‚‚} {v : valâ¦‚ Ï„â‚}
      â†’ Ï âŠ¢ eâ‚ â‡“â¦‚ âŸ¨ğ”¹âŸ© True â¦‚â¦‚ âŸ¨ğ”¹âŸ©
      â†’ Ï âŠ¢ eâ‚‚ â‡“â¦‚ v
      â†’ Ï âŠ¢ âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ â‡“ weaken[val][ â‹–âŸ‡/L Ï„â‚‚ ] v
    âŸ¨ifâŸ©_âŸ¨elseâŸ©_ : âˆ€ {Ï„â‚ Ï„â‚‚} {eâ‚} {eâ‚‚ : Î“ âŠ¢â¦‚ Ï„â‚} {eâ‚ƒ : Î“ âŠ¢â¦‚ Ï„â‚‚} {v}
      â†’ Ï âŠ¢ eâ‚ â‡“â¦‚ âŸ¨ğ”¹âŸ© False â¦‚â¦‚ âŸ¨ğ”¹âŸ©
      â†’ Ï âŠ¢ eâ‚ƒ â‡“â¦‚ v
      â†’ Ï âŠ¢ âŸ¨ifâŸ© eâ‚ âŸ¨thenâŸ© eâ‚‚ âŸ¨elseâŸ© eâ‚ƒ â‡“ weaken[val][ â‹–âŸ‡/R Ï„â‚ ] v
    Var : âˆ€ {Ï„} {x : Ï„ â‹³ Î“}
      â†’ Ï âŠ¢ Var x â‡“ Ï [ x ]
    âŸ¨Î»âŸ© : âˆ€ {Ï„â‚ Ï„â‚‚} {e : Ï„â‚ âˆ· Î“ âŠ¢ Ï„â‚‚}
      â†’ Ï âŠ¢ âŸ¨Î»âŸ© e â‡“ âŸ¨ e , Ï âŸ© â¦‚â¦‚ xRx
    _âŸ¨â‹…âŸ©_ : âˆ€ {Î“'} {Ï„â‚â‚ Ï„â‚‚â‚ Ï„â‚â‚‚ Ï„â‚‚â‚‚}
        {eâ‚ : Î“ âŠ¢â¦‚ Ï„â‚â‚ âŸ¨â†’âŸ© Ï„â‚‚â‚} {eâ‚‚ : Î“ âŠ¢â¦‚ Ï„â‚â‚}
        {Ï' : env Î“'} {e' : Ï„â‚â‚‚ âˆ· Î“' âŠ¢ Ï„â‚‚â‚‚} {Îµâ‚ : Ï„â‚â‚ â‹– Ï„â‚â‚‚} {Îµâ‚‚ : Ï„â‚‚â‚‚ â‹– Ï„â‚‚â‚}
        {vâ‚ : valâ¦‚ Ï„â‚â‚} {vâ‚‚ : valâ¦‚ Ï„â‚‚â‚‚}
      â†’ Ï âŠ¢ eâ‚ â‡“â¦‚ âŸ¨ e' , Ï' âŸ© â¦‚â¦‚ (Îµâ‚ âŸ¨â†’âŸ© Îµâ‚‚)
      â†’ Ï âŠ¢ eâ‚‚ â‡“â¦‚ vâ‚
      â†’ weaken[val][ Îµâ‚ ] vâ‚ âˆ· Ï' âŠ¢ e' â‡“ vâ‚‚
      â†’ Ï âŠ¢ eâ‚ âŸ¨â‹…âŸ© eâ‚‚ â‡“ weaken[val][ Îµâ‚‚ ] vâ‚‚
  data _âŠ¢_â‡“â¦‚_ {Î“} (Ï : env Î“) : âˆ€ {Ï„} â†’ Î“ âŠ¢â¦‚ Ï„ â†’ valâ¦‚ Ï„ â†’ Set where
    â‡“â¦‚â¦‚ : âˆ€ {Ï„â‚ Ï„â‚‚ Ï„â‚ƒ} {e : Î“ âŠ¢ Ï„â‚‚} {Îµâ‚‚ : Ï„â‚‚ â‹– Ï„â‚ƒ} {v : val Ï„â‚} {Îµâ‚ : Ï„â‚ â‹– Ï„â‚‚}
      â†’ Ï âŠ¢ e â‡“ v â¦‚â¦‚ Îµâ‚
      â†’ Ï âŠ¢ e â¦‚â¦‚ Îµâ‚‚ â‡“â¦‚ v â¦‚â¦‚ Îµâ‚‚ âŠš Îµâ‚
