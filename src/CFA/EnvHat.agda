module CFA.EnvHat where

open import Prelude
open import POSet

open import CFA.Syntax
open import CFA.Semantics
open import CFA.ValueHat

-- data env^[_] Î“ : â„• â†’ Set where
--   []  : env^[ Î“ ] 0
--   _âˆ·_ : âˆ€ {n} â†’ list-set (value^ Î“) â†’ env^[ Î“ ] n â†’ env^[ Î“ ] (Suc n)
-- 
-- env^ : context â†’ Set
-- env^ Î“ = env^[ Î“ ] Î“
-- 
-- lookupâ¸¢env^â¸£ : âˆ€ {Î“ n} â†’ var n â†’ env^[ Î“ ] n â†’ list-set (value^ Î“)
-- lookupâ¸¢env^â¸£ Zero    (v âˆ· Ï) = v
-- lookupâ¸¢env^â¸£ (Suc x) (v âˆ· Ï) = lookupâ¸¢env^â¸£ x Ï
-- 
-- data [_,_]âˆˆâ¸¢env^â¸£_ {Î“} : âˆ€ {n} â†’ var n â†’ list-set (value^ Î“) â†’ env^[ Î“ ] n â†’ Set where
--   Zero : âˆ€ {n} {Ï : env^[ Î“ ] n} {vsâ‚ vsâ‚‚} â†’ vsâ‚ âŠ´ vsâ‚‚ â†’ [ Zero , vsâ‚ ]âˆˆâ¸¢env^â¸£ (vsâ‚‚ âˆ· Ï)
--   Suc : âˆ€ {n} {Ï : env^[ Î“ ] n} {x vsâ‚ vsâ‚‚} â†’ [ x , vsâ‚‚ ]âˆˆâ¸¢env^â¸£ Ï â†’ [ Suc x , vsâ‚‚ ]âˆˆâ¸¢env^â¸£ (vsâ‚ âˆ· Ï)
-- 
-- [x,lookup]âˆˆÏâ¸¢env^â¸£ : âˆ€ {Î“ n} (x : var n) (Ï^ : env^[ Î“ ] n) â†’ [ x , lookupâ¸¢env^â¸£ x Ï^ ]âˆˆâ¸¢env^â¸£ Ï^
-- [x,lookup]âˆˆÏâ¸¢env^â¸£ Zero    (v âˆ· Ï^) = Zero xRx
-- [x,lookup]âˆˆÏâ¸¢env^â¸£ (Suc x) (v âˆ· Ï^) = Suc ([x,lookup]âˆˆÏâ¸¢env^â¸£ x Ï^)
-- 
-- âˆˆâ†’âŠ´lookupâ¸¢env^â¸£ : âˆ€ {Î“ n} {x : var n} {vs^ : list-set (value^ Î“)} {Ï^ : env^[ Î“ ] n} â†’ [ x , vs^ ]âˆˆâ¸¢env^â¸£ Ï^ â†’ vs^ âŠ´ lookupâ¸¢env^â¸£ x Ï^
-- âˆˆâ†’âŠ´lookupâ¸¢env^â¸£ {x = Zero} (Zero vsâŠ´vs') = vsâŠ´vs'
-- âˆˆâ†’âŠ´lookupâ¸¢env^â¸£ {x = Suc x} (Suc [x,vs]âˆˆÏ) = âˆˆâ†’âŠ´lookupâ¸¢env^â¸£ [x,vs]âˆˆÏ
-- 
-- data _âŠ´â¸¢env^â¸£_ {Î“} : âˆ€ {n} â†’ relation zeroË¡ (env^[ Î“ ] n) where
--   [] : [] âŠ´â¸¢env^â¸£ []
--   _âˆ·_ : âˆ€ {n} {Ïâ‚ Ïâ‚‚ : env^[ Î“ ] n} {vsâ‚ vsâ‚‚} â†’ vsâ‚ âŠ´ vsâ‚‚ â†’ Ïâ‚ âŠ´â¸¢env^â¸£ Ïâ‚‚ â†’ (vsâ‚ âˆ· Ïâ‚) âŠ´â¸¢env^â¸£ (vsâ‚‚ âˆ· Ïâ‚‚)
-- 
-- ext[âŠ´â¸¢env^â¸£] : âˆ€ {Î“ n} {Ïâ‚ Ïâ‚‚ : env^[ Î“ ] n} â†’ Ïâ‚ âŠ´â¸¢env^â¸£ Ïâ‚‚ â†” (âˆ€ {x} â†’ lookupâ¸¢env^â¸£ x Ïâ‚ âŠ´ lookupâ¸¢env^â¸£ x Ïâ‚‚)
-- ext[âŠ´â¸¢env^â¸£] = LHS , RHS
--   where
--     LHS : âˆ€ {Î“ n} {Ïâ‚ Ïâ‚‚ : env^[ Î“ ] n} â†’ Ïâ‚ âŠ´â¸¢env^â¸£ Ïâ‚‚ â†’ âˆ€ {x} â†’ lookupâ¸¢env^â¸£ x Ïâ‚ âŠ´â¸¢list-setâ¸£ lookupâ¸¢env^â¸£ x Ïâ‚‚
--     LHS (vsâ‚âŠ´vsâ‚‚ âˆ· Ïâ‚âŠ´Ïâ‚‚) {Zero} = vsâ‚âŠ´vsâ‚‚
--     LHS (vsâ‚âŠ´vsâ‚‚ âˆ· Ïâ‚âŠ´Ïâ‚‚) {Suc x} = LHS Ïâ‚âŠ´Ïâ‚‚ {x}
--     RHS : âˆ€ {Î“ n} {Ïâ‚ Ïâ‚‚ : env^[ Î“ ] n} â†’ (âˆ€ {x} â†’ lookupâ¸¢env^â¸£ x Ïâ‚ âŠ´â¸¢list-setâ¸£ lookupâ¸¢env^â¸£ x Ïâ‚‚) â†’ Ïâ‚ âŠ´â¸¢env^â¸£ Ïâ‚‚
--     RHS {Ïâ‚ = []}      {Ïâ‚‚ = []}       âˆ€x:Ïâ‚[x]âŠ´Ïâ‚‚[x] = []
--     RHS {Ïâ‚ = vsâ‚ âˆ· Ïâ‚} {Ïâ‚‚ = vsâ‚‚ âˆ· Ïâ‚‚} âˆ€x:Ïâ‚[x]âŠ´Ïâ‚‚[x] = âˆ€x:Ïâ‚[x]âŠ´Ïâ‚‚[x] {Zero} âˆ· RHS (Î» {x} â†’ âˆ€x:Ïâ‚[x]âŠ´Ïâ‚‚[x] {Suc x})
-- 
-- ext[âŠ´â¸¢env^â¸£]-v : âˆ€ {Î“ n} {Ïâ‚ Ïâ‚‚ : env^[ Î“ ] n} â†’ Ïâ‚ âŠ´â¸¢env^â¸£ Ïâ‚‚ â†” (âˆ€ {x} {v} â†’ v âˆˆâ¸¢list-setâ¸£ lookupâ¸¢env^â¸£ x Ïâ‚ â†’ v âˆˆâ¸¢list-setâ¸£ lookupâ¸¢env^â¸£ x Ïâ‚‚)
-- ext[âŠ´â¸¢env^â¸£]-v = (Î» Ïâ‚âŠ´Ïâ‚‚ {x} â†’ Ï€â‚ ext[âŠ´â¸¢list-setâ¸£] (Ï€â‚ ext[âŠ´â¸¢env^â¸£] Ïâ‚âŠ´Ïâ‚‚ {x})) , (Î» âˆ€xv:Ïâ‚âŠ´Ïâ‚‚ â†’ Ï€â‚‚ ext[âŠ´â¸¢env^â¸£] (Î» {x} â†’ Ï€â‚‚ ext[âŠ´â¸¢list-setâ¸£] (âˆ€xv:Ïâ‚âŠ´Ïâ‚‚ {x})))
-- 
-- xRxâ¸¢âŠ´â¸¢env^â¸£â¸£ : âˆ€ {Î“ n} â†’ reflexive (_âŠ´â¸¢env^â¸£_ {Î“} {n})
-- xRxâ¸¢âŠ´â¸¢env^â¸£â¸£ = Ï€â‚‚ ext[âŠ´â¸¢env^â¸£] xRx
-- 
-- _âŒ¾â¸¢âŠ´â¸¢env^â¸£â¸£_ : âˆ€ {Î“ n} â†’ transitive (_âŠ´â¸¢env^â¸£_ {Î“} {n})
-- Ïâ‚‚âŠ´Ïâ‚ƒ âŒ¾â¸¢âŠ´â¸¢env^â¸£â¸£ Ïâ‚âŠ´Ïâ‚‚ = Ï€â‚‚ ext[âŠ´â¸¢env^â¸£] (Î» {x} â†’ Ï€â‚ ext[âŠ´â¸¢env^â¸£] Ïâ‚‚âŠ´Ïâ‚ƒ {x} âŒ¾ Ï€â‚ ext[âŠ´â¸¢env^â¸£] Ïâ‚âŠ´Ïâ‚‚ {x})
-- 
-- instance
--   Reflexiveâ¸¢âŠ´â¸¢env^â¸£â¸£ : âˆ€ {Î“ n} â†’ Reflexive (_âŠ´â¸¢env^â¸£_ {Î“} {n})
--   Reflexiveâ¸¢âŠ´â¸¢env^â¸£â¸£ = record { xRx = xRxâ¸¢âŠ´â¸¢env^â¸£â¸£ }
--   Transitiveâ¸¢âŠ´â¸¢env^â¸£â¸£ : âˆ€ {Î“ n} â†’ Transitive (_âŠ´â¸¢env^â¸£_ {Î“} {n})
--   Transitiveâ¸¢âŠ´â¸¢env^â¸£â¸£ = record { _âŒ¾_ = _âŒ¾â¸¢âŠ´â¸¢env^â¸£â¸£_ }
--   PreOrderâ¸¢env^â¸£ : âˆ€ {Î“ n} â†’ PreOrder zeroË¡ (env^[ Î“ ] n)
--   PreOrderâ¸¢env^â¸£ = record { _âŠ´_ = _âŠ´â¸¢env^â¸£_ }
-- 
-- buildâ¸¢env^â¸£-n : âˆ€ {Î“ n} â†’ n â‰¤â¸¢Î“â¸£ Î“ â†’ (var Î“ â†’ list-set (value^ Î“)) â†’ env^[ Î“ ] n
-- buildâ¸¢env^â¸£-n {n = Zero}  nâ‰¤â¸¢Î“â¸£Î“ f = []
-- buildâ¸¢env^â¸£-n {n = Suc n} nâ‰¤â¸¢Î“â¸£Î“ f = f (renameâ¸¢varâ¸£ nâ‰¤â¸¢Î“â¸£Î“ Zero) âˆ· buildâ¸¢env^â¸£-n (suc-â‰¤â¸¢Î“â¸£ nâ‰¤â¸¢Î“â¸£Î“) f
-- 
-- buildâ¸¢env^â¸£ : âˆ€ {Î“} â†’ (var Î“ â†’ list-set (value^ Î“)) â†’ env^ Î“
-- buildâ¸¢env^â¸£ = buildâ¸¢env^â¸£-n Zero
-- 
-- lookup-buildâ¸¢env^â¸£-â‰¡-n : âˆ€ {Î“ n} (Ï† : n â‰¤â¸¢Î“â¸£ Î“) (x : var n)  (f : var Î“ â†’ list-set (value^ Î“)) â†’ lookupâ¸¢env^â¸£ x (buildâ¸¢env^â¸£-n Ï† f) â‰¡ f (renameâ¸¢varâ¸£ Ï† x)
-- lookup-buildâ¸¢env^â¸£-â‰¡-n {Î“} {Suc n} Ï† Zero    f = â†¯
-- lookup-buildâ¸¢env^â¸£-â‰¡-n {Î“} {Suc n} Ï† (Suc x) f rewrite lookup-buildâ¸¢env^â¸£-â‰¡-n {Î“} {n} (suc-â‰¤â¸¢Î“â¸£ Ï†) x f | rename-sucâ¸¢varâ¸£-â‰¡ Ï† x = â†¯
-- 
-- lookup-buildâ¸¢env^â¸£-â‰¡ : âˆ€ {Î“} (x : var Î“) (f : var Î“ â†’ list-set (value^ Î“)) â†’ lookupâ¸¢env^â¸£ x (buildâ¸¢env^â¸£ f) â‰¡ f x
-- lookup-buildâ¸¢env^â¸£-â‰¡ = lookup-buildâ¸¢env^â¸£-â‰¡-n Zero
-- 
-- -- Reachable Values
-- 
-- mutual
--   Î±â¸¢envâŠ°valâ¸£ : âˆ€ {Î“} â†’ value Î“ â†’ list-set (env Î“)
--   Î±â¸¢envâŠ°valâ¸£ (FClo x k c Ï) = Ï âˆ· Î±â¸¢envâŠ°envâ¸£ Ï
--   Î±â¸¢envâŠ°valâ¸£ (KClo x c Ï) = Ï âˆ· Î±â¸¢envâŠ°envâ¸£ Ï
--   Î±â¸¢envâŠ°valâ¸£ Stop = []
--   Î±â¸¢envâŠ°valâ¸£ Undefined = []
-- 
--   Î±â¸¢envâŠ°envâ¸£ : âˆ€ {Î“ n} â†’ env[ Î“ ] n â†’ list-set (env Î“)
--   Î±â¸¢envâŠ°envâ¸£ [] = []
--   Î±â¸¢envâŠ°envâ¸£ (v âˆ· Ï) = Î±â¸¢envâŠ°valâ¸£ v âˆªâ¸¢list-setâ¸£ Î±â¸¢envâŠ°envâ¸£ Ï
-- 
-- Î±â¸¢âŠ°â¸¢envâ¸£â¸£ : âˆ€ {Î“} â†’ env Î“ â†’ list-set (env Î“)
-- Î±â¸¢âŠ°â¸¢envâ¸£â¸£ Ï = Ï âˆ· Î±â¸¢envâŠ°envâ¸£ Ï
-- 
-- monotonic[Î±â¸¢âŠ°â¸¢envâ¸£â¸£] : âˆ€ {Î“} {Ïâ‚ Ïâ‚‚ : env Î“} â†’ Ïâ‚ â‰¡ Ïâ‚‚ â†’ Î±â¸¢âŠ°â¸¢envâ¸£â¸£ Ïâ‚ âŠ´ Î±â¸¢âŠ°â¸¢envâ¸£â¸£ Ïâ‚‚
-- monotonic[Î±â¸¢âŠ°â¸¢envâ¸£â¸£] â†¯ = xRx
-- 
-- data _âˆˆâ¸¢env,valâ¸£_ {Î“} : env Î“ â†’ value Î“ â†’ Set where
--   FClo : âˆ€ {Ï x k c} â†’ Ï âˆˆâ¸¢env,valâ¸£ FClo x k c Ï
--   KClo : âˆ€ {Ï x c} â†’ Ï âˆˆâ¸¢env,valâ¸£ KClo x c Ï
-- 
-- mutual
--   data _âŠ°â¸¢env,valâ¸£_ {Î“} : env Î“ â†’ value Î“ â†’ Set where
--     Val : âˆ€ {Ï Ï' v} â†’ Ï' âŠ°â¸¢envâ¸£ Ï â†’ Ï âˆˆâ¸¢env,valâ¸£ v â†’ Ï' âŠ°â¸¢env,valâ¸£ v
--   data _âŠ°â¸¢envâ¸£-n_ {Î“} : âˆ€ {n} â†’ env Î“ â†’ env[ Î“ ] n â†’ Set where
--     Rec-v : âˆ€ {n} {Ï : env[ Î“ ] n} {Ï' : env Î“} {v} â†’ Ï' âŠ°â¸¢env,valâ¸£ v â†’ Ï' âŠ°â¸¢envâ¸£-n (v âˆ· Ï)
--     Rec-Ï : âˆ€ {n} {Ï : env[ Î“ ] n} {Ï' : env Î“} {v} â†’ Ï' âŠ°â¸¢envâ¸£-n Ï â†’ Ï' âŠ°â¸¢envâ¸£-n (v âˆ· Ï)
--   data _âŠ°â¸¢envâ¸£_ {Î“} : env Î“ â†’ env Î“ â†’ Set where
--     Refl : âˆ€ {Ï} â†’ Ï âŠ°â¸¢envâ¸£ Ï
--     Step : âˆ€ {Ï Ï'} â†’ Ï' âŠ°â¸¢envâ¸£-n Ï â†’ Ï' âŠ°â¸¢envâ¸£ Ï
-- 
-- Î³â¸¢âŠ°â¸¢envâ¸£â¸£ : âˆ€ {Î“} â†’ list-set (env Î“) â†’ env Î“ â†’ Set
-- Î³â¸¢âŠ°â¸¢envâ¸£â¸£ Ïs Ï = âˆ€ {Ï'} â†’ Ï' âŠ°â¸¢envâ¸£ Ï â†’ Ï' âˆˆâ¸¢list-setâ¸£ Ïs
-- 
-- monotonic[Î³â¸¢âŠ°â¸¢envâ¸£â¸£] : âˆ€ {Î“} {Ïsâ‚ Ïsâ‚‚ : list-set (env Î“)} â†’ Ïsâ‚ âŠ´ Ïsâ‚‚ â†’ âˆ€ {Ïâ‚ Ïâ‚‚ : env Î“} â†’ Ïâ‚‚ â‰¡ Ïâ‚ â†’ Î³â¸¢âŠ°â¸¢envâ¸£â¸£ Ïsâ‚ Ïâ‚ â†’ Î³â¸¢âŠ°â¸¢envâ¸£â¸£ Ïsâ‚‚ Ïâ‚‚
-- monotonic[Î³â¸¢âŠ°â¸¢envâ¸£â¸£] Ïsâ‚âŠ´Ïsâ‚‚ â†¯ ÏâˆˆÎ³[Ïsâ‚] Ï'âŠ°Ï = Ï€â‚ ext[âŠ´â¸¢list-setâ¸£] Ïsâ‚âŠ´Ïsâ‚‚ (ÏâˆˆÎ³[Ïsâ‚] Ï'âŠ°Ï)
-- 
-- mutual
--   Î±Î³-soundâ¸¢envâŠ°valâ¸£ : âˆ€ {Î“} {Ï : env Î“} {v} â†’ Ï âŠ°â¸¢env,valâ¸£ v â†’ Ï âˆˆâ¸¢list-setâ¸£ Î±â¸¢envâŠ°valâ¸£ v
--   Î±Î³-soundâ¸¢envâŠ°valâ¸£ {v = FClo x k c ._} (Val Refl FClo) = Zero
--   Î±Î³-soundâ¸¢envâŠ°valâ¸£ {v = FClo x k c Ïâ‚} (Val (Step Ï'<Ï) FClo) = Suc (Î±Î³-soundâ¸¢envâŠ°envâ¸£ Ï'<Ï)
--   Î±Î³-soundâ¸¢envâŠ°valâ¸£ {v = KClo x c ._} (Val Refl KClo) = Zero
--   Î±Î³-soundâ¸¢envâŠ°valâ¸£ {v = KClo x c Ïâ‚} (Val (Step Ï'<Ï) KClo) = Suc (Î±Î³-soundâ¸¢envâŠ°envâ¸£ Ï'<Ï) 
--   Î±Î³-soundâ¸¢envâŠ°valâ¸£ {v = Stop}          (Val Ï<Ï' ())
--   Î±Î³-soundâ¸¢envâŠ°valâ¸£ {v = Undefined}     (Val Ï<Ï' ())
--   
--   Î±Î³-soundâ¸¢envâŠ°envâ¸£ : âˆ€ {Î“ n} {Ï : env[ Î“ ] n} {Ï' : env Î“} â†’ Ï' âŠ°â¸¢envâ¸£-n Ï â†’ Ï' âˆˆâ¸¢list-setâ¸£ Î±â¸¢envâŠ°envâ¸£ Ï
--   Î±Î³-soundâ¸¢envâŠ°envâ¸£ (Rec-v Ï'<v) = xâˆˆxsâ¸¢list-setâ¸£ _ _ _ (Î±Î³-soundâ¸¢envâŠ°valâ¸£ Ï'<v)
--   Î±Î³-soundâ¸¢envâŠ°envâ¸£ (Rec-Ï {v = v} Ï'<Ï) = xâˆˆysâ¸¢list-setâ¸£ _ (Î±â¸¢envâŠ°valâ¸£ v) _ (Î±Î³-soundâ¸¢envâŠ°envâ¸£ Ï'<Ï)
--   
-- Î±Î³-soundâ¸¢âŠ°â¸¢envâ¸£â¸£ : âˆ€ {Î“} (Ï : env Î“) â†’ Î³â¸¢âŠ°â¸¢envâ¸£â¸£ (Î±â¸¢âŠ°â¸¢envâ¸£â¸£ Ï) Ï
-- Î±Î³-soundâ¸¢âŠ°â¸¢envâ¸£â¸£ Ï Refl = Zero
-- Î±Î³-soundâ¸¢âŠ°â¸¢envâ¸£â¸£ Ï (Step Ï'<Ï) = Suc (Î±Î³-soundâ¸¢envâŠ°envâ¸£ Ï'<Ï)
-- 
-- mutual
--   Î±Î³-completeâ¸¢envâŠ°valâ¸£ : âˆ€ {Î“} {Ï : env Î“} {v} â†’ Ï âˆˆâ¸¢list-setâ¸£ Î±â¸¢envâŠ°valâ¸£ v â†’ Ï âŠ°â¸¢env,valâ¸£ v
--   Î±Î³-completeâ¸¢envâŠ°valâ¸£ {v = FClo x k c ._} Zero = Val Refl FClo
--   Î±Î³-completeâ¸¢envâŠ°valâ¸£ {v = FClo x k c Ï'} (Suc Ïâˆˆeie[Ï']) = Val (Step (Î±Î³-completeâ¸¢envâŠ°envâ¸£ Ïâˆˆeie[Ï'])) FClo
--   Î±Î³-completeâ¸¢envâŠ°valâ¸£ {v = KClo x c ._}   Zero = Val Refl KClo
--   Î±Î³-completeâ¸¢envâŠ°valâ¸£ {v = KClo x c Ï'}   (Suc Ïâˆˆeie[Ï']) = Val (Step (Î±Î³-completeâ¸¢envâŠ°envâ¸£ Ïâˆˆeie[Ï'])) KClo
--   Î±Î³-completeâ¸¢envâŠ°valâ¸£ {v = Stop}          ()
--   Î±Î³-completeâ¸¢envâŠ°valâ¸£ {v = Undefined}     ()
-- 
--   Î±Î³-completeâ¸¢envâŠ°envâ¸£ : âˆ€ {Î“ n} {Ï : env[ Î“ ] n} {Ï' : env Î“} â†’ Ï' âˆˆâ¸¢list-setâ¸£ Î±â¸¢envâŠ°envâ¸£ Ï â†’ Ï' âŠ°â¸¢envâ¸£-n Ï
--   Î±Î³-completeâ¸¢envâŠ°envâ¸£ {Ï = []} ()
--   Î±Î³-completeâ¸¢envâŠ°envâ¸£ {Ï = v âˆ· Ï} Ï'âˆˆeie[vâˆ·Ï] with xâˆˆxsâˆªysâ†’â¨„â¸¢list-setâ¸£ _ (Î±â¸¢envâŠ°valâ¸£ v) (Î±â¸¢envâŠ°envâ¸£ Ï) Ï'âˆˆeie[vâˆ·Ï]
--   ... | Inl Ï'âˆˆeiv[v] = Rec-v (Î±Î³-completeâ¸¢envâŠ°valâ¸£ Ï'âˆˆeiv[v])
--   ... | Inr Ï'âˆˆeie[Ï] = Rec-Ï (Î±Î³-completeâ¸¢envâŠ°envâ¸£ Ï'âˆˆeie[Ï])
-- 
-- Î±Î³-completeâ¸¢âŠ°â¸¢envâ¸£â¸£-ext : âˆ€ {Î“} {Ï : env Î“} {Ïs : list-set (env Î“)} â†’ Î³â¸¢âŠ°â¸¢envâ¸£â¸£ Ïs Ï â†’ âˆ€ {Ï' : env Î“} â†’ Ï' âˆˆâ¸¢list-setâ¸£ Î±â¸¢âŠ°â¸¢envâ¸£â¸£ Ï â†’ Ï' âˆˆâ¸¢list-setâ¸£ Ïs
-- Î±Î³-completeâ¸¢âŠ°â¸¢envâ¸£â¸£-ext {Î“} {Ï} {Ïs} ÏâˆˆÎ³[Ïs] {.Ï} Zero            = ÏâˆˆÎ³[Ïs] Refl 
-- Î±Î³-completeâ¸¢âŠ°â¸¢envâ¸£â¸£-ext {Î“} {Ï} {Ïs} ÏâˆˆÎ³[Ïs] {Ï'} (Suc Ï'âˆˆeie[Ï]) = ÏâˆˆÎ³[Ïs] (Step (Î±Î³-completeâ¸¢envâŠ°envâ¸£ Ï'âˆˆeie[Ï]))
-- 
-- Î±Î³-completeâ¸¢âŠ°â¸¢envâ¸£â¸£ : âˆ€ {Î“} {Ï : env Î“} {Ïs} â†’ Î³â¸¢âŠ°â¸¢envâ¸£â¸£ Ïs Ï â†’ Î±â¸¢âŠ°â¸¢envâ¸£â¸£ Ï âŠ´â¸¢list-setâ¸£ Ïs
-- Î±Î³-completeâ¸¢âŠ°â¸¢envâ¸£â¸£ ÏâˆˆÎ³[Ïs] = Ï€â‚‚ ext[âŠ´â¸¢list-setâ¸£] (Î±Î³-completeâ¸¢âŠ°â¸¢envâ¸£â¸£-ext ÏâˆˆÎ³[Ïs])
-- 
-- Î±â¸¢collapseâ¸£ : âˆ€ {Î“} â†’ list-set (env Î“) â†’ env^ Î“
-- Î±â¸¢collapseâ¸£ Ïs = buildâ¸¢env^â¸£ (Î» x â†’ mapâ¸¢list-setâ¸£ (Î±â¸¢valâ¸£ âˆ˜ lookupâ¸¢envâ¸£ x) Ïs)
-- 
-- monotonic[Î±â¸¢collapseâ¸£]-ext :
--     âˆ€ {Î“} {Ïsâ‚ Ïsâ‚‚ : list-set (env Î“)} â†’ Ïsâ‚ âŠ´ Ïsâ‚‚
--   â†’ âˆ€ {x v^} â†’ v^ âˆˆâ¸¢list-setâ¸£ lookupâ¸¢env^â¸£ x (Î±â¸¢collapseâ¸£ Ïsâ‚) â†’ v^ âˆˆâ¸¢list-setâ¸£ lookupâ¸¢env^â¸£ x (Î±â¸¢collapseâ¸£ Ïsâ‚‚)
-- monotonic[Î±â¸¢collapseâ¸£]-ext {Î“} {Ïsâ‚} {Ïsâ‚‚} Ïsâ‚âŠ´Ïsâ‚‚ {x} {v^} v^âˆˆÎ±[Ïsâ‚][x]
--   rewrite
--     lookup-buildâ¸¢env^â¸£-â‰¡ x (Î» x â†’ mapâ¸¢list-setâ¸£ (Î±â¸¢valâ¸£ âˆ˜ lookupâ¸¢envâ¸£ x) Ïsâ‚)
--   | lookup-buildâ¸¢env^â¸£-â‰¡ x (Î» x â†’ mapâ¸¢list-setâ¸£ (Î±â¸¢valâ¸£ âˆ˜ lookupâ¸¢envâ¸£ x) Ïsâ‚‚)
--   with yâˆˆmapâ†’âˆƒxâ¸¢list-setâ¸£ v^âˆˆÎ±[Ïsâ‚][x]
-- ... | âˆƒ Ï ,, v^â‰¡Î±[Ï[x]] , ÏâˆˆÏs rewrite v^â‰¡Î±[Ï[x]] = homomorphic[âˆˆâ¸¢list-setâ¸£] (Ï€â‚ ext[âŠ´â¸¢list-setâ¸£] Ïsâ‚âŠ´Ïsâ‚‚ ÏâˆˆÏs)
-- 
-- monotonic[Î±â¸¢collapseâ¸£] : âˆ€ {Î“} {Ïsâ‚ Ïsâ‚‚ : list-set (env Î“)} â†’ Ïsâ‚ âŠ´ Ïsâ‚‚ â†’ Î±â¸¢collapseâ¸£ Ïsâ‚ âŠ´ Î±â¸¢collapseâ¸£ Ïsâ‚‚
-- monotonic[Î±â¸¢collapseâ¸£] Ïsâ‚âŠ´Ïsâ‚‚ = Ï€â‚‚ ext[âŠ´â¸¢env^â¸£]-v (Î» {x} â†’ monotonic[Î±â¸¢collapseâ¸£]-ext Ïsâ‚âŠ´Ïsâ‚‚ {x})
-- 
-- Î³â¸¢collapseâ¸£ : âˆ€ {Î“} â†’ env^ Î“ â†’ list-set (env Î“) â†’ Set
-- Î³â¸¢collapseâ¸£ Ï^ Ïs =
--   âˆ€ x 
--   â†’ âˆ€ Ï â†’ Ï âˆˆâ¸¢list-setâ¸£ Ïs
--   â†’ âˆ€ v â†’ [ x , v ]âˆˆâ¸¢envâ¸£ Ï
--   â†’ âˆƒ vs^ ğ‘ ğ‘¡ [ x , vs^ ]âˆˆâ¸¢env^â¸£ Ï^
--   Ã— (âˆƒ v^ ğ‘ ğ‘¡ v^ âˆˆâ¸¢list-setâ¸£ vs^ Ã— Î³â¸¢valâ¸£ v^ v)
-- 
-- injective[âˆ·][âŠ´â¸¢list-setâ¸£] : âˆ€ {Î“ n} {Ïâ‚^ Ïâ‚‚^ : env^[ Î“ ] n} {vsâ‚^ vsâ‚‚^ : list-set (value^ Î“)} â†’ (vsâ‚^ âˆ· Ïâ‚^) âŠ´â¸¢env^â¸£ (vsâ‚‚^ âˆ· Ïâ‚‚^) â†’ Ïâ‚^ âŠ´â¸¢env^â¸£ Ïâ‚‚^
-- injective[âˆ·][âŠ´â¸¢list-setâ¸£] {Î“} {n} {Ïâ‚^} {Ïâ‚‚^} {vsâ‚^} {vsâ‚‚^} Ïâ‚âŠ´Ïâ‚‚ = Ï€â‚‚ ext[âŠ´â¸¢env^â¸£] (Î» {x} â†’ Ï€â‚ ext[âŠ´â¸¢env^â¸£] Ïâ‚âŠ´Ïâ‚‚ {Suc x})
-- 
-- monotonic[âˆˆâ¸¢envâ¸£] : âˆ€ {Î“ n} {x : var n} {Ïâ‚^ Ïâ‚‚^ : env^[ Î“ ] n} {vs^ : list-set (value^ Î“)} â†’ Ïâ‚^ âŠ´ Ïâ‚‚^ â†’ [ x , vs^ ]âˆˆâ¸¢env^â¸£ Ïâ‚^ â†’ [ x , vs^ ]âˆˆâ¸¢env^â¸£ Ïâ‚‚^
-- monotonic[âˆˆâ¸¢envâ¸£] {x = Zero}  {Ïâ‚^ = vsâ‚^ âˆ· Ïâ‚^} {vsâ‚‚^ âˆ· Ïâ‚‚^} Ïâ‚âŠ´Ïâ‚‚ (Zero vsâ‚âŠ´vsâ‚') = Zero (Ï€â‚ ext[âŠ´â¸¢env^â¸£] Ïâ‚âŠ´Ïâ‚‚ {Zero} âŒ¾ vsâ‚âŠ´vsâ‚')
-- monotonic[âˆˆâ¸¢envâ¸£] {x = Suc x} {Ïâ‚^ = vsâ‚^ âˆ· Ïâ‚^} {vsâ‚‚^ âˆ· Ïâ‚‚^} Ïâ‚âŠ´Ïâ‚‚  (Suc [x,vs]âˆˆÏâ‚) = Suc (monotonic[âˆˆâ¸¢envâ¸£] (injective[âˆ·][âŠ´â¸¢list-setâ¸£] Ïâ‚âŠ´Ïâ‚‚) [x,vs]âˆˆÏâ‚)
-- 
-- monotonic[Î³â¸¢collapseâ¸£] : âˆ€ {Î“} {Ïâ‚^ Ïâ‚‚^ : env^ Î“} â†’ Ïâ‚^ âŠ´ Ïâ‚‚^ â†’ âˆ€ {Ïsâ‚ Ïsâ‚‚ : list-set (env Î“)} â†’ Ïsâ‚‚ âŠ´ Ïsâ‚ â†’ Î³â¸¢collapseâ¸£ Ïâ‚^ Ïsâ‚ â†’ Î³â¸¢collapseâ¸£ Ïâ‚‚^ Ïsâ‚‚
-- monotonic[Î³â¸¢collapseâ¸£] Ïâ‚^âŠ´Ïâ‚‚^ Ïsâ‚‚âŠ´Ïsâ‚ Ïsâ‚âˆˆÎ³[Ïâ‚^] x Ï ÏâˆˆÏsâ‚‚ v [x,v]âˆˆÏ with Ïsâ‚âˆˆÎ³[Ïâ‚^] x Ï (Ï€â‚ ext[âŠ´â¸¢list-setâ¸£] Ïsâ‚‚âŠ´Ïsâ‚ ÏâˆˆÏsâ‚‚) v [x,v]âˆˆÏ
-- ... | âˆƒ vs^ ,, [x,vs^]âˆˆÏâ‚^ , (âˆƒ v^ ,, v^âˆˆvs^ , vâˆˆÎ³[v^]) = âˆƒ vs^ ,, monotonic[âˆˆâ¸¢envâ¸£] Ïâ‚^âŠ´Ïâ‚‚^ [x,vs^]âˆˆÏâ‚^ , (âˆƒ v^ ,, v^âˆˆvs^ , vâˆˆÎ³[v^])
-- 
-- vâˆˆmapâˆ˜lookup : âˆ€ {Î“} {Ïs : list-set (env Î“)} {Ï} {x} {v} â†’ Ï âˆˆâ¸¢list-setâ¸£ Ïs â†’ [ x , v ]âˆˆâ¸¢envâ¸£ Ï â†’ v âˆˆâ¸¢list-setâ¸£ map (lookupâ¸¢envâ¸£ x) Ïs
-- vâˆˆmapâˆ˜lookup ÏâˆˆÏs [x,v]âˆˆÏ rewrite â—‡â¸¢â‰¡â¸£ $ âˆˆ-lookupâ¸¢envâ¸£-â‰¡ [x,v]âˆˆÏ = homomorphic[âˆˆâ¸¢list-setâ¸£] ÏâˆˆÏs
-- 
-- Î±Î³-soundâ¸¢collapseâ¸£-v^âˆˆÏ^ : âˆ€ {Î“} {Ïs : list-set (env Î“)} {Ï x v} â†’ Ï âˆˆâ¸¢list-setâ¸£ Ïs â†’ [ x , v ]âˆˆâ¸¢envâ¸£ Ï â†’ Î±â¸¢valâ¸£ v âˆˆâ¸¢list-setâ¸£ mapâ¸¢list-setâ¸£ (Î» xâ‚ â†’ Î±â¸¢valâ¸£ (lookupâ¸¢envâ¸£ x xâ‚)) Ïs
-- Î±Î³-soundâ¸¢collapseâ¸£-v^âˆˆÏ^ {Ïs = Ïs} {Ï} {x} {v} ÏâˆˆÏs [x,v]âˆˆÏ rewrite homomorphic[mapâ¸¢list-setâ¸£] Î±â¸¢valâ¸£ (lookupâ¸¢envâ¸£ x) Ïs = homomorphic[âˆˆâ¸¢list-setâ¸£] (vâˆˆmapâˆ˜lookup ÏâˆˆÏs [x,v]âˆˆÏ)
-- 
-- Î±Î³-soundâ¸¢collapseâ¸£-vs^âˆˆÏ^ : âˆ€ {Î“} (Ïs : list-set (env Î“)) x â†’ [ x , mapâ¸¢list-setâ¸£ (Î±â¸¢valâ¸£ âˆ˜ lookupâ¸¢envâ¸£ x) Ïs ]âˆˆâ¸¢env^â¸£ Î±â¸¢collapseâ¸£ Ïs
-- Î±Î³-soundâ¸¢collapseâ¸£-vs^âˆˆÏ^ Ïs x with [x,lookup]âˆˆÏâ¸¢env^â¸£ x (Î±â¸¢collapseâ¸£ Ïs)
-- ... | [x,vs]âˆˆÎ±[Ïs] rewrite lookup-buildâ¸¢env^â¸£-â‰¡ x (Î» x â†’ mapâ¸¢list-setâ¸£ (Î±â¸¢valâ¸£ âˆ˜ lookupâ¸¢envâ¸£ x) Ïs) = [x,vs]âˆˆÎ±[Ïs]
-- 
-- Î±Î³-soundâ¸¢collapseâ¸£ : âˆ€ {Î“} (Ïs : list-set (env Î“)) â†’ Î³â¸¢collapseâ¸£ (Î±â¸¢collapseâ¸£ Ïs) Ïs
-- Î±Î³-soundâ¸¢collapseâ¸£ Ïs x Ï ÏâˆˆÏs v [x,v]âˆˆÏ =
--   âˆƒ  mapâ¸¢list-setâ¸£ (Î±â¸¢valâ¸£ âˆ˜ lookupâ¸¢envâ¸£ x) Ïs
--   ,, Î±Î³-soundâ¸¢collapseâ¸£-vs^âˆˆÏ^ Ïs x
--   ,  (âˆƒ Î±â¸¢valâ¸£ v
--      ,, Î±Î³-soundâ¸¢collapseâ¸£-v^âˆˆÏ^ ÏâˆˆÏs [x,v]âˆˆÏ
--      ,  Î±Î³-soundâ¸¢valâ¸£ v
--      )
-- Î±Î³-completeâ¸¢collapseâ¸£-ext : âˆ€ {Î“} {Ïs : list-set (env Î“)} {Ï^ x v^} â†’ Î³â¸¢collapseâ¸£ Ï^ Ïs â†’ v^ âˆˆâ¸¢list-setâ¸£ lookupâ¸¢env^â¸£ x (Î±â¸¢collapseâ¸£ Ïs) â†’ v^ âˆˆâ¸¢list-setâ¸£ lookupâ¸¢env^â¸£ x Ï^
-- Î±Î³-completeâ¸¢collapseâ¸£-ext {Î“} {Ïs} {Ï^} {x} {v^} Ï^âˆˆÎ³[Ïs] vâˆˆÎ±[Ïs][x]
--   rewrite lookup-buildâ¸¢env^â¸£-â‰¡ x (Î» x â†’ mapâ¸¢list-setâ¸£ (Î±â¸¢valâ¸£ âˆ˜ lookupâ¸¢envâ¸£ x) Ïs)
--   with yâˆˆmapâ†’âˆƒxâ¸¢list-setâ¸£ vâˆˆÎ±[Ïs][x]
-- ... | âˆƒ Ï ,, v^â‰¡Î±[Ï[x]] , ÏâˆˆÏs rewrite v^â‰¡Î±[Ï[x]] with Ï^âˆˆÎ³[Ïs] x Ï ÏâˆˆÏs (lookupâ¸¢envâ¸£ x Ï) (âˆˆ-lookupâ¸¢envâ¸£ x Ï)
-- ... | âˆƒ vs^ ,, [x,vs^]âˆˆÏ^ , (âˆƒ v'^ ,, v'^âˆˆvs^ , vâˆˆÎ³[v'^]) rewrite Î±Î³-completeâ¸¢valâ¸£ vâˆˆÎ³[v'^] = Ï€â‚ ext[âŠ´â¸¢list-setâ¸£] (âˆˆâ†’âŠ´lookupâ¸¢env^â¸£ [x,vs^]âˆˆÏ^) v'^âˆˆvs^
-- 
-- 
-- Î±Î³-completeâ¸¢collapseâ¸£ : âˆ€ {Î“} {Ïs : list-set (env Î“)} {Ï^ : env^ Î“} â†’ Î³â¸¢collapseâ¸£ Ï^ Ïs â†’ Î±â¸¢collapseâ¸£ Ïs âŠ´â¸¢env^â¸£ Ï^
-- Î±Î³-completeâ¸¢collapseâ¸£ {Î“} {Ïs} {Ï^} ÏsâˆˆÎ³[Ï^] = Ï€â‚‚ ext[âŠ´â¸¢env^â¸£]-v (Î» {x} â†’ Î±Î³-completeâ¸¢collapseâ¸£-ext {x = x} ÏsâˆˆÎ³[Ï^])
-- 
-- â‡„[âŠ°â¸¢envâ¸£]â‡„ : âˆ€ {Î“} â†’ â‡§ (env Î“) Î·â‡„Î³ â‡§ (list-set (env Î“))
-- â‡„[âŠ°â¸¢envâ¸£]â‡„ {Î“} = mk[Î·â‡„Î³]â¸¢â†‘â¸£ $ record
--   { Î·â¸¢â†‘â¸£ = Î±â¸¢âŠ°â¸¢envâ¸£â¸£
--   ; monotonic[Î·â¸¢â†‘â¸£] = monotonic[Î±â¸¢âŠ°â¸¢envâ¸£â¸£]
--   ; Î³â¸¢â†‘â¸£ = Î³â¸¢âŠ°â¸¢envâ¸£â¸£
--   ; monotonic[Î³â¸¢â†‘â¸£] = monotonic[Î³â¸¢âŠ°â¸¢envâ¸£â¸£]
--   ; sound[Î·Î³]â¸¢â†‘â¸£ = Î» {x} â†’ Î±Î³-soundâ¸¢âŠ°â¸¢envâ¸£â¸£ x
--   ; complete[Î·Î³]â¸¢â†‘â¸£ = Î±Î³-completeâ¸¢âŠ°â¸¢envâ¸£â¸£
--   }
-- 
-- â‡„collapseâ‡„ : âˆ€ {Î“} â†’ â‡§ (list-set (env Î“)) Î·â‡„Î³ â‡§ (env^ Î“)
-- â‡„collapseâ‡„ {Î“} = mk[Î·â‡„Î³]â¸¢â†‘â¸£ $ record
--   { Î·â¸¢â†‘â¸£ = Î±â¸¢collapseâ¸£
--   ; monotonic[Î·â¸¢â†‘â¸£] = monotonic[Î±â¸¢collapseâ¸£]
--   ; Î³â¸¢â†‘â¸£ = Î³â¸¢collapseâ¸£
--   ; monotonic[Î³â¸¢â†‘â¸£] = monotonic[Î³â¸¢collapseâ¸£]
--   ; sound[Î·Î³]â¸¢â†‘â¸£ = Î» {x} â†’ Î±Î³-soundâ¸¢collapseâ¸£ x
--   ; complete[Î·Î³]â¸¢â†‘â¸£ = Î±Î³-completeâ¸¢collapseâ¸£
--   }
-- 
-- â‡„envâ‡„ : âˆ€ {Î“} â†’ â‡§ (env Î“) Î·â‡„Î³ â‡§ (env^ Î“)
-- â‡„envâ‡„ = â‡„collapseâ‡„ âŒ¾â¸¢Î·â‡„Î³â¸£ â‡„[âŠ°â¸¢envâ¸£]â‡„
-- 
-- -- Deciding things --
-- 
-- data isFClo {Î“} : value^ Î“ â†’ Set where
--   Is : âˆ€ {x' k c} â†’ isFClo (FClo x' k c)
-- 
-- mutual
--   decideFilterFClo : âˆ€ {Î“} (vs : list-set (value^ Î“)) â†’ âˆƒ vs' ğ‘ ğ‘¡ (âˆ€ {v} â†’ v âˆˆâ¸¢list-setâ¸£ vs Ã— isFClo v â†” v âˆˆâ¸¢list-setâ¸£ vs')
--   decideFilterFClo [] = âˆƒ [] ,, (Î»{ (() , _) }) , (Î» ())
--   decideFilterFClo (FClo x k c âˆ· vs) with decideFilterFClo vs
--   ... | âˆƒ vs' ,, vâˆˆvsÃ—vâ‰¡cloâ†”vâˆˆvs' = âˆƒ FClo x k c âˆ· vs' ,, LHS , RHS
--     where
--       LHS : âˆ€ {v} â†’ v âˆˆâ¸¢list-setâ¸£ (FClo x k c âˆ· vs) Ã— isFClo v â†’ v âˆˆâ¸¢list-setâ¸£ (FClo x k c âˆ· vs')
--       LHS (Zero , Is) = Zero
--       LHS (Suc vâˆˆvs , Is) = Suc $ Ï€â‚ vâˆˆvsÃ—vâ‰¡cloâ†”vâˆˆvs' $ vâˆˆvs , Is
--       RHS : âˆ€ {v} â†’ v âˆˆâ¸¢list-setâ¸£ (FClo x k c âˆ· vs') â†’ v âˆˆâ¸¢list-setâ¸£ (FClo x k c âˆ· vs) Ã— isFClo v
--       RHS Zero = Zero , Is
--       RHS (Suc vâˆˆvs') with Ï€â‚‚ vâˆˆvsÃ—vâ‰¡cloâ†”vâˆˆvs' vâˆˆvs'
--       ... | vâˆˆvs , Is = Suc vâˆˆvs , Is
--   decideFilterFClo (KClo x c âˆ· vs) = decideFilterFClo-not (KClo x c) (Î» ()) vs
--   decideFilterFClo (Stop âˆ· vs) = decideFilterFClo-not Stop (Î» ()) vs
--   decideFilterFClo (Undefined âˆ· vs) = decideFilterFClo-not Undefined (Î» ()) vs
-- 
--   decideFilterFClo-not : âˆ€ {Î“} (v : value^ Î“) (vâ‰¢clo : not (isFClo v)) (vs : list-set (value^ Î“)) â†’ âˆƒ vs' ğ‘ ğ‘¡ (âˆ€ {v'} â†’ v' âˆˆâ¸¢list-setâ¸£ (v âˆ· vs) Ã— isFClo v' â†” v' âˆˆâ¸¢list-setâ¸£ vs')
--   decideFilterFClo-not v vâ‰¢clo vs with decideFilterFClo vs
--   ... | âˆƒ vs' ,, vâˆˆvsÃ—vâ‰¡cloâ†”vâˆˆvs' = âˆƒ vs' ,, LHS , RHS
--     where
--       LHS : âˆ€ {v'} â†’ v' âˆˆâ¸¢list-setâ¸£ (v âˆ· vs) Ã— isFClo v' â†’ v' âˆˆâ¸¢list-setâ¸£ vs'
--       LHS (Zero , vâ‰¡clo) = exfalso $ vâ‰¢clo vâ‰¡clo
--       LHS (Suc vâˆˆvs , Is) = Ï€â‚ vâˆˆvsÃ—vâ‰¡cloâ†”vâˆˆvs' $ vâˆˆvs , Is
--       RHS : âˆ€ {v'} â†’ v' âˆˆâ¸¢list-setâ¸£ vs' â†’ v' âˆˆâ¸¢list-setâ¸£ (v âˆ· vs) Ã— isFClo v'
--       RHS vâˆˆvs' with Ï€â‚‚ vâˆˆvsÃ—vâ‰¡cloâ†”vâˆˆvs' vâˆˆvs'
--       ... | vâˆˆvs , Is = Suc vâˆˆvs , Is
-- 
-- decideLookupFClo : âˆ€ {Î“ n} (Ï : env^[ Î“ ] n) (x : var n) â†’ âˆƒ vs ğ‘ ğ‘¡ (âˆ€ {v} â†’ v âˆˆâ¸¢list-setâ¸£ lookupâ¸¢env^â¸£ x Ï Ã— isFClo v â†” v âˆˆâ¸¢list-setâ¸£ vs)
-- decideLookupFClo (vs âˆ· Ï) Zero = decideFilterFClo vs
-- decideLookupFClo (vs âˆ· Ï) (Suc x) = decideLookupFClo Ï x
-- 
-- -- decideDenoteFClo : âˆ€ {Î“ n} (fa : atom
-- 
-- -- decideLookupFClo (FClo x k c Ï' âˆ· Ï) Zero    = Yes â†¯
-- -- decideLookupFClo (KClo x c Ï' âˆ· Ï)   Zero    = No $ Î» ()
-- -- decideLookupFClo (Stop âˆ· Ï)          Zero    = No $ Î» ()
-- -- decideLookupFClo (Undefined âˆ· Ï)     Zero    = No $ Î» ()
-- -- decideLookupFClo (v âˆ· Ï)             (Suc x) with decideLookupFClo Ï x
-- -- ... | Yes Ï[x]â‰¡clo = Yes Ï[x]â‰¡clo
-- -- ... | No Ï[x]â‰¢clo = No Ï[x]â‰¢clo
-- -- 
-- -- decideLookupKClo : âˆ€ {Î“ n} (Ï : env[ Î“ ] n) (x : var n) â†’ DecideLookupKClo Ï x
-- -- decideLookupKClo (FClo x k c Ï' âˆ· Ï) Zero = No $ Î» ()
-- -- decideLookupKClo (KClo x c Ï' âˆ· Ï) Zero = Yes â†¯
-- -- decideLookupKClo (Stop âˆ· Ï) Zero = No $ Î» ()
-- -- decideLookupKClo (Undefined âˆ· Ï) Zero = No $ Î» ()
-- -- decideLookupKClo (v âˆ· Ï) (Suc x) with decideLookupKClo Ï x
-- -- ... | Yes Ï[x]â‰¡clo = Yes Ï[x]â‰¡clo
-- -- ... | No Ï[x]â‰¢clo = No Ï[x]â‰¢clo
-- -- 
-- -- data DecideDenoteFClo {Î“} (Ï : env Î“) (fa : atom Î“) : Set where
-- --   Yes : âˆ€ {x k c Ï'} â†’ âŸ¦ fa âŸ§ Ï â‰¡ FClo x k c Ï' â†’ DecideDenoteFClo Ï fa
-- --   No : (âˆ€ {x k c Ï'} â†’ âŸ¦ fa âŸ§ Ï â‰¢ FClo x k c Ï') â†’ DecideDenoteFClo Ï fa
-- -- 
-- -- data DecideDenoteKClo {Î“} (Ï : env Î“) (fa : atom Î“) : Set where
-- --   Yes : âˆ€ {x c Ï'} â†’ âŸ¦ fa âŸ§ Ï â‰¡ KClo x c Ï' â†’ DecideDenoteKClo Ï fa
-- --   No : (âˆ€ {x c Ï'} â†’ âŸ¦ fa âŸ§ Ï â‰¢ KClo x c Ï') â†’ DecideDenoteKClo Ï fa
-- -- 
-- -- decideDenoteFClo : âˆ€ {Î“} (Ï : env Î“) (fa : atom Î“) â†’ DecideDenoteFClo Ï fa
-- -- decideDenoteFClo Ï (Var x) with decideLookupFClo Ï x
-- -- ... | Yes Ï[x]â‰¡clo = Yes Ï[x]â‰¡clo
-- -- ... | No Ï[x]â‰¢clo  = No Ï[x]â‰¢clo
-- -- decideDenoteFClo Ï (FLam x k c) = Yes â†¯
-- -- decideDenoteFClo Ï (KLam x c) = No $ Î» ()
-- -- 
-- -- decideDenoteKClo : âˆ€ {Î“} (Ï : env Î“) (fa : atom Î“) â†’ DecideDenoteKClo Ï fa
-- -- decideDenoteKClo Ï (Var x) with decideLookupKClo Ï x
-- -- ... | Yes Ï[x]â‰¡clo = Yes Ï[x]â‰¡clo
-- -- ... | No Ï[x]â‰¢clo  = No Ï[x]â‰¢clo
-- -- decideDenoteKClo Ï (FLam x k c) = No $ Î» ()
-- -- decideDenoteKClo Ï (KLam x c) = Yes â†¯
